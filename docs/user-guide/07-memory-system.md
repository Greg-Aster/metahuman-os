## Memory System

### Types of Memory

#### Episodic Memory (`memory/episodic/YYYY/*.json`)
Your digital personality's journal. A timeline of:
- **Observations** - Things you capture manually
- **Reflections** - Autonomous thoughts generated by the reflector agent
- **Dreams** - Surreal narratives created during sleep hours
- **Inner Dialogue** - Private thoughts
- **Conversations** - Exchanges with the persona chat

Each memory is stored as JSON:
```json
{
  "id": "evt-20251019143000",
  "timestamp": "2025-10-19T14:30:00.000Z",
  "content": "Met with Sarah about ML project",
  "type": "observation",
  "tags": ["meeting", "work", "ml"],
  "entities": ["Sarah", "ML project"],
  "importance": 0.7,
  "metadata": {
    "processed": true,
    "processedAt": "2025-10-19T14:35:00.000Z",
    "model": "ollama:phi3:mini"
  }
}
```

#### Task Memory (`memory/tasks/`)
Structured to-do items with:
- Status: `todo`, `in_progress`, `blocked`, `done`, `cancelled`
- Priority: `P1` (urgent), `P2` (normal), `P3` (low)
- Dependencies, due dates, tags

```json
{
  "id": "task-20251019143000",
  "title": "Draft proposal",
  "status": "todo",
  "priority": "P2",
  "tags": ["writing", "work"],
  "created": "2025-10-19T14:30:00.000Z",
  "updated": "2025-10-19T14:30:00.000Z"
}
```

### Memory Browser (Web UI)

The web interface provides a powerful Memory browser with **7 specialized tabs** for organizing and viewing different types of memories. Each tab automatically filters memories based on their tags, links, and types.

#### Episodic Tab
- **Purpose**: View all captured observations and manually created events
- **Filtering**: Shows all memories without type-specific filters
- **Visual**: Standard white/dark background cards
- **Actions**: Expand/collapse, validate (mark correct), delete

#### Reflections Tab
- **Purpose**: View AI-generated reflections from the reflector agent
- **Filtering**: Memories with `type: "reflection"`
- **Content**: 1-3 sentence first-person thoughts connecting multiple memories
- **Visual**: Standard cards with reflection-specific metadata

#### Tasks Tab
- **Purpose**: View all task files from `memory/tasks/`
- **Filtering**: Task JSON files (active, completed, projects)
- **Content**: Task titles, status, priority, due dates
- **Visual**: Shows task metadata inline

#### Curated Tab
- **Purpose**: View hand-picked, high-quality memories from `memory/curated/`
- **Filtering**: Markdown files in the curated directory
- **Use Case**: Store important reference documents, key learnings, golden memories
- **Visual**: Shows file names and full content when expanded

#### AI Ingestor Tab ðŸ¤–
- **Purpose**: View memories automatically created by the ingestor agent
- **Filtering**: Memories with:
  - Tags: `ingested` or `ai`
  - Links: `type: "source"` (pointing to original file)
- **Visual**: **Purple left border** to distinguish from manual captures
- **Content**: Extracted insights from files placed in `memory/inbox/`
- **Metadata**: Shows tags, entities, and source file links

#### Audio Tab ðŸŽµ
- **Purpose**: View memories from transcribed audio recordings
- **Filtering**: Memories with tags: `audio` or `transcript`
- **Visual**: **Blue left border** to distinguish audio-sourced content
- **Content**: Key points extracted from audio transcripts
- **Workflow**: Audio files â†’ Transcriber â†’ Audio Organizer â†’ Episodic memories
- **Metadata**: Shows tags, entities, and links to original transcript files

#### Dreams Tab ðŸ’­
- **Purpose**: View surreal dream narratives generated by the dreamer agent
- **Filtering**: Memories with `type: "dream"`
- **Visual**: **Yellow left border** to distinguish dream content
- **Content**: Abstract, metaphorical narratives woven from memory fragments
- **Metadata**: Shows source memory IDs that inspired the dream
- **Generated**: During nightly sleep cycles (configurable in `etc/sleep.json`)

### Memory Validation

Each memory card in the web UI includes validation controls:
- **+ Button**: Mark memory as correct (useful for training data quality)
- **âˆ’ Button**: Delete memory immediately (fast cleanup)
- **Validation Status**: Shows "correct" or "incorrect" badge if validated

### Capturing Memories

The primary way to give your digital personality a new memory is with the **`capture`** command:

**CLI:**
```bash
./bin/mh capture "Had a productive meeting with the design team today and we decided on the new color palette."
```

**Web UI:**
Navigate to the Chat view and use the input box (memories are auto-captured from conversations).

**Automatic Capture (AI Ingestor):**
```bash
# Place files in the inbox
cp my-notes.txt memory/inbox/

# Run the ingestor agent
./bin/mh agent run ingestor

# View AI-extracted memories in the "AI Ingestor" tab
```

**Audio Capture:**
```bash
# Upload audio via Web UI (Audio view)
# OR place audio files in memory/audio/inbox/

# The transcriber and audio-organizer agents process automatically during sleep
# View transcribed memories in the "Audio" tab
```

### Searching Memory

**CLI:**
```bash
./bin/mh remember "design team"
```

This performs:
1. **Semantic search** (if vector index exists) - finds conceptually similar memories
2. **Keyword search** (fallback) - simple text matching

**Web UI:**
Use the Memory browser in the left sidebar to browse and search.

### Semantic Search (Vector Embeddings)

MetaHuman OS can build a semantic index of your memories for natural language search.

### Build the Index
```bash
./bin/mh index build
```

This:
1. Reads all episodic memories
2. Generates embeddings using Ollama (`nomic-embed-text` model)
3. Stores vectors in `memory/index/memory-index.json`

### Search Semantically
```bash
./bin/mh index query "when did I meet with Sarah?"
```

Returns memories ranked by semantic similarity (cosine similarity score).

**Note:** The `mh remember` command automatically uses semantic search if an index exists.

---

