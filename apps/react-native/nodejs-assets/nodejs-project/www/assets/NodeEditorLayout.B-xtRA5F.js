import{l as Be,S as Yt,i as Xt,s as Zt,n as He,d as u,a as B,b as d,c as l,e as w,f as M,j as x,o as Ws,Q as Us,R as Qt,L as Ke,r as Ge,u as rt,v as it,z as ct,x as ae,g as de,h as V,U as De,k as F,V as Te,p as me,q as oe,t as re,O as ot,E as es,F as ts,G as ss,H as os,N as Qe,I as rs,J as as,X as lt,M as We,P as is}from"./api-config.B-uR5Kyo.js";import{_ as Ve,n as Xs}from"./navigation.DpIJm6IG.js";import"./index.PToQ82vo.js";const Zs={input:{color:"#4ade80",bgColor:"#166534"},router:{color:"#fbbf24",bgColor:"#92400e"},context:{color:"#60a5fa",bgColor:"#1e3a8a"},operator:{color:"#a78bfa",bgColor:"#5b21b6"},chat:{color:"#f472b6",bgColor:"#9f1239"},model:{color:"#fb923c",bgColor:"#9a3412"},skill:{color:"#34d399",bgColor:"#065f46"},output:{color:"#ef4444",bgColor:"#991b1b"},control_flow:{color:"#818cf8",bgColor:"#4338ca"},memory:{color:"#c084fc",bgColor:"#7e22ce"},utility:{color:"#94a3b8",bgColor:"#475569"},agent:{color:"#22d3ee",bgColor:"#155e75"},config:{color:"#fde047",bgColor:"#854d0e"},persona:{color:"#e879f9",bgColor:"#86198f"},thought:{color:"#67e8f9",bgColor:"#0e7490"},dreamer:{color:"#d8b4fe",bgColor:"#6b21a8"},curiosity:{color:"#fcd34d",bgColor:"#a16207"},curator:{color:"#86efac",bgColor:"#14532d"},safety:{color:"#fca5a5",bgColor:"#7f1d1d"},emulation:{color:"#a5b4fc",bgColor:"#3730a3"},agency:{color:"#f59e0b",bgColor:"#78350f"},cognitive:{color:"#38bdf8",bgColor:"#0c4a6e"}};function E(o){const t=Zs[o.category];return{...o,color:o.color??t.color,bgColor:o.bgColor??t.bgColor}}const C=[E({id:"mic_input",name:"Mic Input",category:"input",inputs:[],outputs:[{name:"audioBuffer",type:"object",description:"Raw audio buffer from microphone"},{name:"audioFormat",type:"string",description:"Audio format (wav/webm/mp3)"},{name:"hasMicInput",type:"boolean",description:"Whether mic input is available"}],properties:{audioFormat:"wav"},description:"Captures audio input from microphone for speech recognition"}),E({id:"speech_to_text",name:"Speech to Text",category:"input",inputs:[{name:"audioBuffer",type:"object",description:"Audio buffer to transcribe"}],outputs:[{name:"text",type:"string",description:"Transcribed text from speech"},{name:"transcribed",type:"boolean",description:"Whether transcription succeeded"},{name:"audioFormat",type:"string",description:"Audio format used"}],properties:{audioFormat:"wav"},description:"Converts speech audio to text using Whisper STT"}),E({id:"text_input",name:"Text Input",category:"input",inputs:[],outputs:[{name:"text",type:"string",description:"Text from chat interface input"},{name:"hasTextInput",type:"boolean",description:"Whether text input is available"}],properties:{placeholder:"Enter text..."},description:"Gateway to chat interface text input"}),E({id:"user_input",name:"User Input",category:"input",inputs:[{name:"speech",type:"object",optional:!0,description:"Transcribed speech input"},{name:"text",type:"string",optional:!0,description:"Direct text input"}],outputs:[{name:"message",type:"string",description:"User message"},{name:"inputSource",type:"string",description:"Input source: text, speech, or chat"},{name:"sessionId",type:"string",description:"Session identifier"}],properties:{message:"",prioritizeChatInterface:!0},description:"Unified input node for text and speech"}),E({id:"session_context",name:"Session Context",category:"context",inputs:[{name:"sessionId",type:"string"}],outputs:[{name:"conversationHistory",type:"array",description:"Recent conversation messages"},{name:"user",type:"object",description:"Current user object"}],description:"Loads session and conversation history"}),E({id:"system_settings",name:"System Settings",category:"context",inputs:[],outputs:[{name:"cognitiveMode",type:"string",description:"Current cognitive mode"},{name:"trustLevel",type:"string",description:"Current trust level"},{name:"settings",type:"object",description:"System settings object"}],description:"Provides system configuration"}),E({id:"context_builder",name:"Context Builder",category:"context",inputs:[{name:"message",type:"string"},{name:"cognitiveMode",type:"string"},{name:"conversationHistory",type:"array",optional:!0}],outputs:[{name:"context",type:"object",description:"Complete context package"}],properties:{searchDepth:"normal",maxMemories:8,maxContextChars:8e3},propertySchemas:{searchDepth:{type:"select",default:"normal",label:"Search Depth",options:["shallow","normal","deep","exhaustive"]},maxMemories:{type:"slider",default:8,label:"Max Memories",min:1,max:20,step:1},maxContextChars:{type:"number",default:8e3,label:"Max Context Length",min:1e3,max:32e3,step:1e3}},size:[280,200],description:"Builds context package with memories"}),E({id:"semantic_search",name:"Semantic Search",category:"context",inputs:[{name:"query",type:"string"},{name:"similarityThreshold",type:"number",optional:!0}],outputs:[{name:"memories",type:"array",description:"Relevant memories"}],properties:{similarityThreshold:.6,maxResults:8},propertySchemas:{similarityThreshold:{type:"slider",default:.6,label:"Similarity Threshold",min:0,max:1,step:.05},maxResults:{type:"slider",default:8,label:"Max Results",min:1,max:20,step:1}},size:[260,160],description:"Searches memories using embeddings"}),E({id:"conversation_history",name:"Conversation History",category:"context",inputs:[{name:"sessionId",type:"string"},{name:"mode",type:"string",optional:!0}],outputs:[{name:"history",type:"array",description:"Conversation messages"}],properties:{mode:"conversation",maxMessages:20},description:"Loads conversation history"}),E({id:"cognitive_mode_router",name:"Cognitive Mode Router",category:"router",inputs:[{name:"cognitiveMode",type:"string"},{name:"message",type:"string"}],outputs:[{name:"useDual",type:"boolean",description:"Route to operator (dual mode)"},{name:"useAgent",type:"boolean",description:"Conditional routing (agent mode)"},{name:"useEmulation",type:"boolean",description:"Chat only (emulation mode)"}],description:"Routes based on cognitive mode"}),E({id:"auth_check",name:"Authentication Check",category:"router",inputs:[{name:"user",type:"object"}],outputs:[{name:"isAuthenticated",type:"boolean"},{name:"role",type:"string",description:"User role"}],description:"Checks user authentication status"}),E({id:"operator_eligibility",name:"Operator Eligibility",category:"router",inputs:[{name:"cognitiveMode",type:"string"},{name:"isAuthenticated",type:"boolean"},{name:"message",type:"string"}],outputs:[{name:"useOperator",type:"boolean",description:"Should use operator pipeline"}],description:"Determines if operator should be used"}),E({id:"smart_router",name:"Smart Router",category:"router",inputs:[{name:"orchestratorAnalysis",type:"object",description:"Analysis from orchestrator LLM"}],outputs:[{name:"complexPath",type:"object",description:"Output for complex queries"},{name:"simplePath",type:"object",description:"Output for simple queries"}],properties:{routeOnComplexity:!0,simpleThreshold:.3},description:"Routes queries based on complexity analysis"}),E({id:"persona_llm",name:"Persona LLM",category:"chat",inputs:[{name:"personaText",type:"object",description:"Formatted persona text"},{name:"conversationHistory",type:"array",description:"Chat history"},{name:"memories",type:"array",optional:!0,description:"Semantic search memories"},{name:"orchestratorData",type:"object",optional:!0,description:"Instructions from orchestrator"}],outputs:[{name:"response",type:"string"}],properties:{model:"fallback",temperature:.7},propertySchemas:{model:{type:"string",default:"fallback",label:"Model"},temperature:{type:"slider",default:.7,label:"Temperature",min:0,max:1,step:.1}},size:[240,200],description:"Generates response using persona"}),E({id:"orchestrator_llm",name:"Intent Orchestrator",category:"chat",inputs:[{name:"message",type:"string",description:"User message to analyze"},{name:"conversationHistory",type:"array",optional:!0,description:"Recent conversation for context awareness"},{name:"systemSettings",type:"object",optional:!0,description:"System settings for permission context"}],outputs:[{name:"needsMemory",type:"boolean",description:"Whether memory search is needed"},{name:"memoryTier",type:"string",description:"Memory tier to search"},{name:"memoryQuery",type:"string",description:"Optimized search query"},{name:"needsAction",type:"boolean",description:"Routes to Big Brother when true"},{name:"actionType",type:"string",description:"LLM-interpreted action type"},{name:"actionParams",type:"object",description:"Parameters for the action"},{name:"complexity",type:"number",description:"Task complexity 0-1"},{name:"responseStyle",type:"string",description:"Suggested response style"},{name:"responseLength",type:"string",description:"brief/medium/detailed"},{name:"isFollowUp",type:"boolean",description:"Is follow-up to previous"},{name:"emotionalTone",type:"string",description:"Detected emotional context"},{name:"instructions",type:"string",description:"Instructions for persona"}],properties:{temperature:.2},propertySchemas:{temperature:{type:"slider",default:.2,label:"Temperature",min:0,max:1,step:.1}},size:[260,280],description:"Enhanced intent analysis with action detection and conversation awareness (NO HARDCODING - LLM interprets intent)"}),E({id:"reflector_llm",name:"Reflector LLM",category:"chat",inputs:[{name:"prompt",type:"string",description:"Reflection prompt"}],outputs:[{name:"response",type:"string"}],properties:{role:"persona",temperature:.8,systemPrompt:""},description:"Generates reflections/summaries"}),E({id:"model_resolver",name:"Model Resolver",category:"model",inputs:[{name:"role",type:"string",description:"Model role"},{name:"cognitiveMode",type:"string",optional:!0}],outputs:[{name:"modelConfig",type:"object",description:"Resolved model configuration"}],description:"Resolves model based on role and mode"}),E({id:"model_router",name:"Model Router",category:"model",inputs:[{name:"role",type:"string"},{name:"messages",type:"array"},{name:"options",type:"object",optional:!0}],outputs:[{name:"response",type:"object"}],properties:{role:"persona",temperature:.7},description:"Routes LLM call based on role"}),E({id:"react_planner",name:"ReAct Planner",category:"operator",inputs:[{name:"goal",type:"string",description:"User goal/request"},{name:"context",type:"object"},{name:"scratchpad",type:"array",optional:!0}],outputs:[{name:"thought",type:"string",description:"Reasoning about next step"},{name:"action",type:"object",description:"Skill to execute"}],properties:{model:"default.coder",temperature:.2},propertySchemas:{model:{type:"string",default:"default.coder",label:"Model"},temperature:{type:"slider",default:.2,label:"Temperature",min:0,max:1,step:.1}},size:[240,180],description:"Plans next action in ReAct loop"}),E({id:"skill_executor",name:"Skill Executor",category:"operator",inputs:[{name:"skillName",type:"string"},{name:"arguments",type:"object"}],outputs:[{name:"result",type:"object",description:"Skill execution result"},{name:"success",type:"boolean"},{name:"error",type:"object",optional:!0}],description:"Executes a skill with arguments"}),E({id:"observation_formatter",name:"Observation Formatter",category:"operator",inputs:[{name:"result",type:"object"},{name:"mode",type:"string",optional:!0}],outputs:[{name:"observation",type:"string",description:"Formatted observation text"}],properties:{mode:"narrative"},propertySchemas:{mode:{type:"select",default:"narrative",label:"Format Mode",options:["narrative","structured","verbatim"]}},size:[240,140],description:"Formats skill results for LLM"}),E({id:"completion_checker",name:"Completion Checker",category:"operator",inputs:[{name:"goal",type:"string"},{name:"scratchpad",type:"array"}],outputs:[{name:"isComplete",type:"boolean"},{name:"reason",type:"string",optional:!0}],description:"Checks if goal is achieved"}),E({id:"response_synthesizer",name:"Response Synthesizer",category:"operator",inputs:[{name:"goal",type:"string"},{name:"scratchpad",type:"array"},{name:"context",type:"object"}],outputs:[{name:"response",type:"string",description:"Final natural language response"}],properties:{model:"persona",style:"default"},propertySchemas:{model:{type:"string",default:"persona",label:"Model"},style:{type:"select",default:"default",label:"Response Style",options:["default","strict","summary"]}},size:[260,180],description:"Synthesizes final response from scratchpad"}),E({id:"iteration_counter",name:"Iteration Counter",category:"operator",inputs:[{name:"scratchpad",type:"object",description:"Initial scratchpad"},{name:"loopBack",type:"object",optional:!0,description:"Loop-back data"}],outputs:[{name:"iterationData",type:"object",description:"Object with iteration, maxIterations, scratchpad"}],properties:{maxIterations:10},description:"Tracks iteration count in ReAct loop"}),E({id:"scratchpad_completion_checker",name:"Completion Checker",category:"operator",inputs:[{name:"scratchpad",type:"object",description:"Scratchpad with iteration data"}],outputs:[{name:"result",type:"object",description:"Object with isComplete, reason, scratchpad"}],description:"Checks if ReAct task is complete"}),E({id:"scratchpad_formatter",name:"Scratchpad Formatter",category:"operator",inputs:[{name:"scratchpad",type:"object",description:"Scratchpad to format"}],outputs:[{name:"formatted",type:"string",description:"Formatted scratchpad text"}],properties:{format:"text"},description:"Formats scratchpad for display"}),E({id:"plan_parser",name:"Plan Parser",category:"operator",inputs:[{name:"plan",type:"string",description:"ReAct-style planning text"}],outputs:[{name:"thought",type:"string"},{name:"action",type:"string"},{name:"actionInput",type:"string"},{name:"respond",type:"string",description:"Final answer if present"},{name:"parsed",type:"boolean"}],properties:{format:"react"},description:"Parses ReAct-style planning output"}),E({id:"scratchpad_manager",name:"Scratchpad Manager",category:"operator",inputs:[{name:"step",type:"object",optional:!0,description:"Step to append"}],outputs:[{name:"scratchpad",type:"array",description:"Current scratchpad state"},{name:"stepCount",type:"number"}],properties:{operation:"append",maxSteps:10},description:"Manages ReAct scratchpad state"}),E({id:"error_recovery",name:"Error Recovery",category:"operator",inputs:[{name:"error",type:"string"},{name:"skillId",type:"string",optional:!0}],outputs:[{name:"errorType",type:"string",description:"Categorized error type"},{name:"suggestions",type:"array",description:"Recovery suggestions"},{name:"shouldRetry",type:"boolean"}],properties:{maxRetries:3},description:"Provides smart retry suggestions"}),E({id:"stuck_detector",name:"Stuck Detector",category:"operator",inputs:[{name:"scratchpad",type:"array"}],outputs:[{name:"isStuck",type:"boolean"},{name:"consecutiveFailures",type:"number"},{name:"diagnosis",type:"string"},{name:"suggestion",type:"string"}],properties:{threshold:3},description:"Detects failure loops"}),E({id:"big_brother",name:"Big Brother",category:"operator",inputs:[{name:"goal",type:"string",description:"The goal the operator is trying to achieve"},{name:"scratchpad",type:"array",description:"Full scratchpad"},{name:"errorType",type:"string",optional:!0},{name:"context",type:"object",optional:!0}],outputs:[{name:"suggestions",type:"array",description:"Recovery suggestions"},{name:"reasoning",type:"string",description:"Root cause analysis"},{name:"alternativeApproach",type:"string",description:"Alternative strategy"},{name:"success",type:"boolean"}],properties:{provider:"claude-code",maxRetries:1,autoApplySuggestions:!1},description:"Escalates stuck states to Claude CLI"}),E({id:"big_brother_executor",name:"Big Brother Executor",category:"operator",inputs:[{name:"skillName",type:"string",description:"Skill to execute"},{name:"arguments",type:"object",description:"Skill arguments"}],outputs:[{name:"result",type:"object",description:"Skill execution result"},{name:"success",type:"boolean"},{name:"error",type:"object",optional:!0}],properties:{timeout:6e4,autoStartSession:!0},description:"Executes skills via Claude CLI"}),E({id:"claude_full_task",name:"Claude Full Task",category:"operator",inputs:[{name:"orchestratorAnalysis",type:"object",optional:!0},{name:"userMessage",type:"string",description:"User request"},{name:"contextPackage",type:"object",optional:!0}],outputs:[{name:"result",type:"object",description:"Execution result"}],properties:{timeout:12e4},description:"Delegates entire task to Claude Code"}),E({id:"cot_stripper",name:"Chain-of-Thought Stripper",category:"safety",inputs:[{name:"response",type:"string"}],outputs:[{name:"cleaned",type:"string",description:"Response with <think> blocks removed"},{name:"response",type:"string",description:"Alias for cleaned output",optional:!0}],description:"Removes internal reasoning blocks"}),E({id:"safety_validator",name:"Safety Validator",category:"safety",inputs:[{name:"response",type:"string"}],outputs:[{name:"response",type:"string"},{name:"isSafe",type:"boolean"},{name:"issues",type:"array",optional:!0},{name:"safetyResult",type:"object",optional:!0}],properties:{threshold:.7},description:"Validates response safety"}),E({id:"response_refiner",name:"Response Refiner",category:"safety",inputs:[{name:"response",type:"string"},{name:"safetyResult",type:"object",optional:!0}],outputs:[{name:"response",type:"string"},{name:"refined",type:"boolean",optional:!0}],description:"Refines response to address safety issues"}),E({id:"memory_capture",name:"Memory Capture",category:"output",inputs:[{name:"userMessage",type:"string"},{name:"assistantResponse",type:"string"},{name:"cognitiveMode",type:"string"},{name:"metadata",type:"object",optional:!0}],outputs:[{name:"eventPath",type:"string",description:"Path to saved event file"}],description:"Saves conversation to episodic memory"}),E({id:"inner_dialogue_capture",name:"Inner Dialogue Capture",category:"output",inputs:[{name:"text",type:"string",description:"Reflection or thought text"},{name:"metadata",type:"object",optional:!0}],outputs:[{name:"result",type:"object",description:"Save result with path"}],properties:{tags:["idle-thought","self-reflection","inner"]},description:"Saves inner dialogue to episodic memory"}),E({id:"audit_logger",name:"Audit Logger",category:"output",inputs:[{name:"eventType",type:"string"},{name:"details",type:"object"}],outputs:[{name:"logged",type:"boolean"}],description:"Logs to audit trail"}),E({id:"stream_writer",name:"Stream Writer",category:"output",inputs:[{name:"response",type:"string"}],outputs:[{name:"output",type:"string",description:"Output text"}],description:"Streams response to client"}),E({id:"chat_view",name:"Chat View",category:"output",inputs:[{name:"message",type:"string",optional:!0},{name:"trigger",type:"any",optional:!0}],outputs:[],properties:{mode:"direct",maxMessages:5},description:"Displays chat messages visually"}),E({id:"tts",name:"Text to Speech",category:"output",inputs:[{name:"text",type:"string",description:"Text to speak"}],outputs:[],properties:{provider:"",autoPlay:!0},description:"Converts text to speech"}),E({id:"thinking_stripper",name:"Thinking Stripper",category:"output",inputs:[{name:"response",type:"any",description:"LLM response that may contain <think> blocks"}],outputs:[{name:"response",type:"string",description:"Response with thinking stripped (alias for stripped)"},{name:"stripped",type:"string",description:"Response with <think> blocks removed"},{name:"thinking",type:"string",description:"Extracted thinking content (null if none)"},{name:"hadThinking",type:"boolean",description:"Whether response contained thinking"}],properties:{},description:"Extracts <think> blocks for UI display, provides stripped content for memory/TTS"}),E({id:"skill_fs_read",name:"Read File",category:"skill",inputs:[{name:"filePath",type:"string"}],outputs:[{name:"content",type:"string"},{name:"success",type:"boolean"}],description:"Reads file contents"}),E({id:"skill_fs_write",name:"Write File",category:"skill",inputs:[{name:"filePath",type:"string"},{name:"content",type:"string"}],outputs:[{name:"success",type:"boolean"}],description:"Writes file contents"}),E({id:"skill_fs_list",name:"List Files",category:"skill",inputs:[{name:"directory",type:"string"}],outputs:[{name:"files",type:"array"}],description:"Lists directory contents"}),E({id:"skill_task_create",name:"Create Task",category:"skill",inputs:[{name:"title",type:"string"},{name:"description",type:"string",optional:!0}],outputs:[{name:"taskId",type:"string"}],description:"Creates a new task"}),E({id:"skill_task_list",name:"List Tasks",category:"skill",inputs:[],outputs:[{name:"tasks",type:"array"}],description:"Lists active tasks"}),E({id:"skill_task_update",name:"Update Task",category:"skill",inputs:[{name:"taskId",type:"string"},{name:"status",type:"string"}],outputs:[{name:"success",type:"boolean"}],description:"Updates task status"}),E({id:"skill_search_index",name:"Search Index",category:"skill",inputs:[{name:"query",type:"string"},{name:"maxResults",type:"number",optional:!0}],outputs:[{name:"results",type:"array"}],description:"Semantic memory search"}),E({id:"skill_web_search",name:"Web Search",category:"skill",inputs:[{name:"query",type:"string"}],outputs:[{name:"results",type:"array"}],description:"Searches the web"}),E({id:"skill_conversational_response",name:"Conversational Response",category:"skill",inputs:[{name:"message",type:"string"},{name:"context",type:"object",optional:!0},{name:"style",type:"string",optional:!0}],outputs:[{name:"response",type:"string"}],properties:{style:"default"},propertySchemas:{style:{type:"select",default:"default",label:"Response Style",options:["default","strict","summary"]}},size:[260,160],description:"Generates conversational response"}),E({id:"loop_controller",name:"Loop Controller",category:"control_flow",inputs:[{name:"input",type:"any"}],outputs:[{name:"iterations",type:"array",description:"Array of iteration results"},{name:"finalOutput",type:"any",description:"Final output after loop completes"},{name:"completed",type:"boolean"}],properties:{maxIterations:10,completionCheck:"completed"},description:"Iterative execution with max iterations"}),E({id:"conditional_branch",name:"Conditional Branch",category:"control_flow",inputs:[{name:"input",type:"any"}],outputs:[{name:"conditionMet",type:"boolean"},{name:"trueOutput",type:"any"},{name:"falseOutput",type:"any"}],properties:{condition:"value",operator:"==",compareValue:null},description:"Routes execution based on a condition"}),E({id:"conditional_router",name:"Conditional Router",category:"control_flow",inputs:[{name:"condition",type:"any",description:"Condition data"},{name:"trueData",type:"any",description:"Data if condition is true"},{name:"falseData",type:"any",description:"Data if condition is false"}],outputs:[{name:"exitOutput",type:"any",description:"Output when condition is true"},{name:"loopOutput",type:"any",description:"Output when condition is false"}],properties:{conditionField:"isComplete"},description:"Routes data based on condition for loop control"}),E({id:"switch",name:"Switch",category:"control_flow",inputs:[{name:"input",type:"any"}],outputs:[{name:"switchValue",type:"any"},{name:"matchedCase",type:"string"},{name:"output",type:"any"}],properties:{switchField:"mode",cases:{},defaultCase:"default"},description:"Multi-way routing based on a value"}),E({id:"for_each",name:"For Each",category:"control_flow",inputs:[{name:"input",type:"object"}],outputs:[{name:"results",type:"array"},{name:"count",type:"number"}],properties:{arrayField:"items"},description:"Iterates over an array"}),E({id:"json_parser",name:"JSON Parser",category:"utility",inputs:[{name:"text",type:"string",description:"Text containing JSON"}],outputs:[{name:"data",type:"object",description:"Parsed JSON object"},{name:"success",type:"boolean"}],properties:{fallback:null},description:"Extracts JSON from text"}),E({id:"text_template",name:"Text Template",category:"utility",inputs:[{name:"variables",type:"object",description:"Variables for interpolation"}],outputs:[{name:"text",type:"string",description:"Interpolated text"}],properties:{template:""},description:"String interpolation with {{variable}} substitution"}),E({id:"data_transform",name:"Data Transform",category:"utility",inputs:[{name:"data",type:"array"}],outputs:[{name:"result",type:"any",description:"Transformed data"},{name:"count",type:"number"}],properties:{operation:"map",field:null,condition:null,reduceOperation:"count"},description:"Map/filter/reduce operations on arrays"}),E({id:"cache",name:"Cache",category:"utility",inputs:[{name:"value",type:"any"}],outputs:[{name:"value",type:"any"},{name:"hit",type:"boolean",description:"Whether cache was hit"}],properties:{key:"default",ttl:6e4,operation:"get"},propertySchemas:{key:{type:"string",default:"default",label:"Cache Key"},ttl:{type:"number",default:6e4,label:"TTL (ms)",min:1e3,max:36e5,step:1e3},operation:{type:"select",default:"get",label:"Operation",options:["get","set","clear","clear_all"]}},size:[240,200],description:"Stores intermediate results with TTL"}),E({id:"memory_loader",name:"Memory Loader",category:"agent",inputs:[],outputs:[{name:"memories",type:"array",description:"Loaded memory objects"},{name:"count",type:"number"},{name:"hasMore",type:"boolean"}],properties:{limit:10,onlyUnprocessed:!0},description:"Loads episodic memories from disk"}),E({id:"memory_saver",name:"Memory Saver",category:"agent",inputs:[{name:"memory",type:"object",description:"Memory object to save"}],outputs:[{name:"success",type:"boolean"},{name:"path",type:"string"},{name:"error",type:"string",optional:!0}],properties:{updateOnly:!0},description:"Saves enriched memory data"}),E({id:"llm_enricher",name:"LLM Enricher",category:"agent",inputs:[{name:"memory",type:"object",description:"Memory to enrich"}],outputs:[{name:"memory",type:"object",description:"Enriched memory with tags and entities"},{name:"success",type:"boolean"},{name:"error",type:"string",optional:!0}],description:"Uses LLM to extract tags and entities"}),E({id:"agent_timer",name:"Agent Timer",category:"agent",inputs:[],outputs:[{name:"currentTime",type:"number"},{name:"interval",type:"number"},{name:"nextRun",type:"number"}],properties:{intervalMs:6e4},description:"Provides timing for scheduled agent execution"}),E({id:"persona_loader",name:"Persona Loader",category:"persona",inputs:[],outputs:[{name:"persona",type:"object"},{name:"identity",type:"object"},{name:"values",type:"object"},{name:"goals",type:"object"},{name:"success",type:"boolean"}],description:"Loads persona core configuration"}),E({id:"persona_formatter",name:"Persona Formatter",category:"persona",inputs:[{name:"personaData",type:"object"}],outputs:[{name:"formatted",type:"object",description:"Formatted persona text"}],properties:{includePersonality:!0,includeValues:!0,includeGoals:!0},description:"Formats persona data into system prompt text"}),E({id:"persona_saver",name:"Persona Saver",category:"persona",inputs:[{name:"persona",type:"object"}],outputs:[{name:"success",type:"boolean"},{name:"timestamp",type:"string"}],description:"Saves persona core configuration"}),E({id:"trust_level_reader",name:"Trust Level Reader",category:"persona",inputs:[],outputs:[{name:"trustLevel",type:"string"},{name:"availableModes",type:"array"},{name:"description",type:"string"},{name:"success",type:"boolean"}],description:"Reads current trust level"}),E({id:"trust_level_writer",name:"Trust Level Writer",category:"persona",inputs:[{name:"trustLevel",type:"string"}],outputs:[{name:"success",type:"boolean"},{name:"trustLevel",type:"string"},{name:"timestamp",type:"string"}],description:"Sets trust level"}),E({id:"decision_rules_loader",name:"Decision Rules Loader",category:"persona",inputs:[],outputs:[{name:"rules",type:"object"},{name:"trustLevel",type:"string"},{name:"hardRules",type:"array"},{name:"softPreferences",type:"array"},{name:"success",type:"boolean"}],description:"Loads decision rules configuration"}),E({id:"decision_rules_saver",name:"Decision Rules Saver",category:"persona",inputs:[{name:"rules",type:"object"}],outputs:[{name:"success",type:"boolean"},{name:"timestamp",type:"string"}],description:"Saves decision rules configuration"}),E({id:"identity_extractor",name:"Identity Extractor",category:"persona",inputs:[{name:"persona",type:"object",optional:!0}],outputs:[{name:"value",type:"any",description:"Extracted field value"},{name:"success",type:"boolean"}],properties:{field:"all"},description:"Extracts specific identity fields"}),E({id:"value_manager",name:"Value Manager",category:"persona",inputs:[{name:"valueData",type:"object",optional:!0}],outputs:[{name:"values",type:"array"},{name:"success",type:"boolean"}],properties:{operation:"get"},description:"Manages core values (CRUD operations)"}),E({id:"goal_manager",name:"Goal Manager",category:"persona",inputs:[{name:"goalData",type:"object",optional:!0}],outputs:[{name:"goals",type:"array"},{name:"success",type:"boolean"}],properties:{operation:"get",scope:"shortTerm"},description:"Manages goals (CRUD operations)"}),E({id:"thought_generator",name:"Thought Generator",category:"thought",inputs:[{name:"context",type:"object"},{name:"seedMemory",type:"string",optional:!0}],outputs:[{name:"result",type:"object",description:"Generated thought with keywords and confidence"}],properties:{temperature:.75,extractKeywords:!0},description:"Generates a single reasoning step"}),E({id:"thought_evaluator",name:"Thought Evaluator",category:"thought",inputs:[{name:"thought",type:"object"},{name:"iteration",type:"object",optional:!0},{name:"history",type:"object",optional:!0}],outputs:[{name:"evaluation",type:"object",description:"Evaluation result"}],properties:{minConfidence:.4,maxIterations:7,repetitionThreshold:.8},description:"Decides if thought chain should continue"}),E({id:"thought_aggregator",name:"Thought Aggregator",category:"thought",inputs:[{name:"scratchpad",type:"object"}],outputs:[{name:"result",type:"object",description:"Consolidated chain, insight, summary"}],properties:{summaryStyle:"narrative",maxLength:200},description:"Combines all thoughts into a coherent chain"}),E({id:"agent_trigger",name:"Agent Trigger",category:"thought",inputs:[{name:"inputData",type:"object"}],outputs:[{name:"result",type:"object"}],properties:{agentName:"",waitForCompletion:!0,timeout:3e4},description:"Triggers another agent from within a graph"}),E({id:"loop_memory_search",name:"Loop Memory Search",category:"thought",inputs:[{name:"searchTerms",type:"array"},{name:"seenIds",type:"array",optional:!0}],outputs:[{name:"result",type:"object",description:"Found memories, memoryIds, searchTermsUsed"}],properties:{maxResults:3,excludeSeen:!0},description:"Searches for memories, avoiding already-seen ones"}),E({id:"dreamer_memory_curator",name:"Curate Dream Memories",category:"dreamer",inputs:[],outputs:[{name:"memories",type:"array"},{name:"count",type:"number"},{name:"avgAgeDays",type:"number"},{name:"oldestAgeDays",type:"number"},{name:"username",type:"string"}],properties:{sampleSize:15,decayDays:227},description:"Curates weighted sample of memories for dreams"}),E({id:"dreamer_dream_generator",name:"Generate Dream",category:"dreamer",inputs:[{name:"memories",type:"array"},{name:"personaPrompt",type:"string",optional:!0}],outputs:[{name:"dream",type:"string"},{name:"memoryCount",type:"number"},{name:"sourceIds",type:"array"},{name:"username",type:"string"}],properties:{temperature:1,role:"persona"},description:"Generates surreal dream narratives"}),E({id:"dreamer_dream_saver",name:"Save Dream",category:"dreamer",inputs:[{name:"dreamData",type:"object"},{name:"memoriesData",type:"object",optional:!0}],outputs:[{name:"saved",type:"boolean"},{name:"eventId",type:"string"},{name:"dream",type:"string"},{name:"sourceCount",type:"number"},{name:"username",type:"string"}],properties:{type:"dream"},description:"Saves generated dream to episodic memory"}),E({id:"dreamer_continuation_generator",name:"Generate Continuation Dreams",category:"dreamer",inputs:[{name:"previousDream",type:"object"}],outputs:[{name:"dreams",type:"array"},{name:"count",type:"number"},{name:"username",type:"string"}],properties:{temperature:1,continuationChance:.75,maxContinuations:4,delaySeconds:60},description:"Generates continuation dreams"}),E({id:"dreamer_learnings_extractor",name:"Extract Learnings",category:"dreamer",inputs:[{name:"memoriesData",type:"object"}],outputs:[{name:"preferences",type:"array"},{name:"heuristics",type:"array"},{name:"styleNotes",type:"array"},{name:"avoidances",type:"array"},{name:"memoryCount",type:"number"},{name:"username",type:"string"}],properties:{temperature:.3,role:"persona"},description:"Extracts learnings from memories"}),E({id:"dreamer_learnings_writer",name:"Write Overnight Learnings",category:"dreamer",inputs:[{name:"learningsData",type:"object"},{name:"memoriesData",type:"object",optional:!0}],outputs:[{name:"written",type:"boolean"},{name:"filepath",type:"string"},{name:"filename",type:"string"},{name:"date",type:"string"},{name:"username",type:"string"}],description:"Writes overnight learnings to procedural memory"}),E({id:"curiosity_weighted_sampler",name:"Curiosity Weighted Sampler",category:"curiosity",inputs:[],outputs:[{name:"memories",type:"array"},{name:"count",type:"number"},{name:"username",type:"string"},{name:"decayFactor",type:"number"}],properties:{sampleSize:5,decayFactor:14},description:"Samples memories with exponential decay"}),E({id:"curiosity_question_generator",name:"Curiosity Question Generator",category:"curiosity",inputs:[{name:"memories",type:"array"}],outputs:[{name:"question",type:"string"},{name:"rawQuestion",type:"string"},{name:"username",type:"string"},{name:"memoriesConsidered",type:"number"}],properties:{temperature:.6},description:"Generates natural curiosity questions"}),E({id:"curiosity_question_saver",name:"Curiosity Question Saver",category:"curiosity",inputs:[{name:"question",type:"string"},{name:"memories",type:"array",optional:!0}],outputs:[{name:"questionId",type:"string"},{name:"saved",type:"boolean"},{name:"username",type:"string"},{name:"askedAt",type:"string"}],description:"Saves question to audit log"}),E({id:"curiosity_activity_check",name:"Curiosity Activity Check",category:"curiosity",inputs:[],outputs:[{name:"canAsk",type:"boolean"},{name:"timeSinceLastQuestion",type:"number",optional:!0},{name:"questionInterval",type:"number"},{name:"username",type:"string"}],properties:{questionIntervalSeconds:1800},description:"Checks if enough time has passed since last question"}),E({id:"uncurated_memory_loader",name:"Load Uncurated Memories",category:"curator",inputs:[],outputs:[{name:"memories",type:"array",description:"Uncurated episodic memories"}],properties:{limit:5},description:"Loads uncurated episodic memories"}),E({id:"persona_summary_loader",name:"Load Persona Context",category:"curator",inputs:[],outputs:[{name:"personaSummary",type:"string",description:"Persona identity summary"}],description:"Loads persona identity summary"}),E({id:"curator_llm",name:"Curate Memories (LLM)",category:"curator",inputs:[{name:"memories",type:"array"},{name:"personaSummary",type:"string",optional:!0}],outputs:[{name:"curatedMemories",type:"array",description:"LLM-curated conversational exchanges"}],properties:{temperature:.3,timeout:3e5},description:"Uses LLM to transform memories into training data"}),E({id:"curated_memory_saver",name:"Save Curated Memories",category:"curator",inputs:[{name:"curatedMemories",type:"array"}],outputs:[{name:"savedCount",type:"number"}],description:"Saves curated memories to training data directory"}),E({id:"training_pair_generator",name:"Generate Training Pairs",category:"curator",inputs:[{name:"curatedMemories",type:"array"}],outputs:[{name:"trainingPairs",type:"array",description:"User/assistant message pairs"}],description:"Converts curated memories into training pairs"}),E({id:"training_pair_appender",name:"Append to JSONL",category:"curator",inputs:[{name:"trainingPairs",type:"array"}],outputs:[{name:"appendedCount",type:"number"}],description:"Appends training pairs to JSONL file"}),E({id:"memory_marker",name:"Mark as Curated",category:"curator",inputs:[{name:"curatedMemories",type:"array"}],outputs:[{name:"markedCount",type:"number"}],description:"Marks memories as curated"}),E({id:"reply_to_handler",name:"Reply-To Handler",category:"emulation",inputs:[{name:"conversationHistory",type:"array"},{name:"replyToId",type:"string",optional:!0}],outputs:[{name:"relevantHistory",type:"array"},{name:"targetMessage",type:"object",optional:!0}],description:"Handles reply-to threading in conversation"}),E({id:"buffer_manager",name:"Buffer Manager",category:"emulation",inputs:[{name:"conversationHistory",type:"array",optional:!0},{name:"response",type:"any",optional:!0}],outputs:[{name:"persisted",type:"boolean"},{name:"messageCount",type:"number"},{name:"bufferPath",type:"string"}],description:"Persists conversation buffer to disk"}),E({id:"scratchpad_initializer",name:"Scratchpad Initializer",category:"emulation",inputs:[],outputs:[{name:"scratchpad",type:"array"},{name:"iteration",type:"number"},{name:"maxIterations",type:"number"},{name:"isComplete",type:"boolean"}],description:"Creates or resets the scratchpad for ReAct iteration"}),E({id:"scratchpad_updater",name:"Scratchpad Updater",category:"emulation",inputs:[{name:"iterationState",type:"object"},{name:"observation",type:"any"},{name:"plan",type:"any"}],outputs:[{name:"scratchpad",type:"array"},{name:"iteration",type:"number"},{name:"maxIterations",type:"number"},{name:"isComplete",type:"boolean"}],description:"Appends new thought/action/observation to scratchpad"}),E({id:"weighted_sampler",name:"Weighted Sampler",category:"memory",inputs:[],outputs:[{name:"memoryPaths",type:"array",description:"Sampled memory file paths"},{name:"count",type:"number"}],properties:{decayFactor:14,sampleSize:5},description:"Samples memories using exponential decay weighting"}),E({id:"memory_router",name:"Memory Router",category:"memory",inputs:[{name:"orchestratorHints",type:"object",description:"Memory routing hints from orchestrator"},{name:"userMessage",type:"string",description:"User message as fallback query"}],outputs:[{name:"memories",type:"object",description:"Retrieved memories with searchPerformed flag"}],properties:{topK:8,threshold:.5},propertySchemas:{topK:{type:"slider",default:8,label:"Top K Results",min:1,max:20,step:1},threshold:{type:"slider",default:.5,label:"Similarity Threshold",min:0,max:1,step:.05}},size:[220,100],description:"AI-driven memory routing using orchestrator hints"}),E({id:"desire_memory_analyzer",name:"Analyze Memories for Desires",category:"agency",inputs:[],outputs:[{name:"memories",type:"array",description:"Array of unanalyzed memory objects"},{name:"count",type:"number",description:"Number of memories to analyze"},{name:"hasMore",type:"boolean",description:"Whether more unanalyzed memories exist"}],properties:{limit:20,daysBack:7,markAsAnalyzed:!0},propertySchemas:{limit:{type:"number",default:20,label:"Limit",description:"Maximum memories to load per run"},daysBack:{type:"number",default:7,label:"Days Back",description:"Only analyze memories from the last N days"},markAsAnalyzed:{type:"boolean",default:!0,label:"Mark as Analyzed",description:"Update generator scratchpad with analyzed memory IDs"}},description:"Loads recent unanalyzed memories for desire detection"}),E({id:"desire_detector",name:"Detect Desire",category:"agency",inputs:[{name:"userInput",type:"any",description:"User message to analyze"},{name:"context",type:"string",optional:!0,description:"Conversation context"}],outputs:[{name:"detected",type:"boolean",description:"Whether a desire was detected"},{name:"desire",type:"object",description:"Extracted or reinforced desire data"},{name:"confidence",type:"number",description:"Detection confidence (0-1)"},{name:"reasoning",type:"string",description:"LLM reasoning for detection"}],properties:{minConfidence:.7,detectExplicit:!0,detectImplicit:!1},propertySchemas:{minConfidence:{type:"slider",default:.7,min:.1,max:1,step:.1,label:"Minimum Confidence"},detectExplicit:{type:"boolean",default:!0,label:"Detect Explicit Desires"},detectImplicit:{type:"boolean",default:!1,label:"Detect Implicit Desires"}},description:"Uses LLM to identify and extract desires from user input"}),E({id:"desire_folder_creator",name:"Create Desire Folder",category:"agency",inputs:[{name:"desire",type:"object",description:"Desire data to create folder for"}],outputs:[{name:"desire",type:"object",description:"Desire with folderPath populated"},{name:"folderPath",type:"string",description:"Path to created folder"},{name:"success",type:"boolean",description:"Whether folder was created"}],properties:{createScratchpad:!0,createManifest:!0},propertySchemas:{createScratchpad:{type:"boolean",default:!0,label:"Create Scratchpad"},createManifest:{type:"boolean",default:!0,label:"Create Manifest"}},description:"Creates folder structure and initial scratchpad for a new desire"}),E({id:"desire_updater",name:"Update Desire",category:"agency",inputs:[{name:"desire",type:"object",description:"Desire to update"},{name:"newStatus",type:"string",optional:!0,description:"New status to set"},{name:"plan",type:"object",optional:!0,description:"Plan to attach"},{name:"review",type:"object",optional:!0,description:"Review to attach"}],outputs:[{name:"desire",type:"object",description:"Updated desire"},{name:"success",type:"boolean",description:"Whether update succeeded"}],description:"Updates a desire status and associated data"}),E({id:"conditional",name:"Conditional",category:"control_flow",inputs:[{name:"value",type:"any",description:"Value to evaluate"}],outputs:[{name:"ifTrue",type:"any",description:"Output when condition is true"},{name:"ifFalse",type:"any",description:"Output when condition is false"}],properties:{condition:"value === true"},propertySchemas:{condition:{type:"string",default:"value === true",label:"Condition",description:"JavaScript expression to evaluate"}},description:"Routes data based on a condition"}),E({id:"result_aggregator",name:"Result Aggregator",category:"output",inputs:[{name:"input",type:"any",description:"Input to aggregate"}],outputs:[{name:"result",type:"any",description:"Aggregated result"}],properties:{},description:"Aggregates and outputs results from the graph"})];function Ae(o){return C.find(t=>t.id===o)}let b,at;function eo(o,t){t.propertySchemas&&(console.log(`[addWidgetsFromSchema] Adding widgets for ${t.name}:`,Object.keys(t.propertySchemas)),o.properties||(o.properties={}),Object.entries(t.propertySchemas).forEach(([s,e])=>{o.properties[s]===void 0&&(o.properties[s]=e.default)}),Object.entries(t.propertySchemas).forEach(([s,e])=>{const r=e.label||s,n=o.properties[s];try{switch(e.type){case"string":typeof o.addWidget=="function"&&o.addWidget("text",r,n,i=>{if(e.validation){const c=e.validation(i);if(c!==!0){console.warn(`[${t.name}] Validation failed for ${s}:`,c);return}}o.properties[s]=i});break;case"text_multiline":if(typeof o.addWidget=="function"){const i=o.addWidget("text",r,n,c=>{o.properties[s]=c});i&&(i.multiline=!0,i.rows=e.rows||3)}break;case"number":typeof o.addWidget=="function"&&o.addWidget("number",r,n,i=>{let c=i;e.min!==void 0&&(c=Math.max(e.min,c)),e.max!==void 0&&(c=Math.min(e.max,c)),o.properties[s]=c},{min:e.min,max:e.max,step:e.step});break;case"boolean":typeof o.addWidget=="function"&&o.addWidget("toggle",r,n,i=>{o.properties[s]=i});break;case"select":if(typeof o.addWidget=="function"){let i;e.options&&e.options.length>0?typeof e.options[0]=="string"?i=e.options:i=e.options.map(c=>c.value):i=[],o.addWidget("combo",r,n,c=>{o.properties[s]=c},{values:i})}break;case"slider":typeof o.addWidget=="function"&&o.addWidget("slider",r,n,i=>{o.properties[s]=i},{min:e.min||0,max:e.max||1,step:e.step||.01});break;case"color":typeof o.addWidget=="function"&&o.addWidget("text",r,n,i=>{/^#[0-9A-Fa-f]{6}$/.test(i)?o.properties[s]=i:console.warn(`[${t.name}] Invalid color format for ${s}:`,i)});break;case"json":if(typeof o.addWidget=="function"){const i=typeof n=="string"?n:JSON.stringify(n,null,2);o.addWidget("text",r,i,c=>{try{const m=JSON.parse(c);o.properties[s]=m}catch(m){console.warn(`[${t.name}] Invalid JSON for ${s}:`,m)}})}break}}catch(i){console.error(`[addWidgetsFromSchema] Error adding widget for ${s}:`,i)}}),console.log(`[addWidgetsFromSchema] Widgets added successfully for ${t.name}`))}function to(o,t,s,e){if(!s.propertySchemas||o.flags.collapsed)return;const r={startY:e?.startY||60,fontSize:e?.fontSize,maxProperties:e?.maxProperties};t.save();let n=r.startY,i=0;const c=r.fontSize+6,m=8,g=Math.min(Object.keys(s.propertySchemas).length,r.maxProperties)*c+m*2;t.fillStyle="rgba(0, 0, 0, 0.15)",t.fillRect(m-2,n-m,o.size[0]-m*2+4,g),t.strokeStyle="rgba(255, 255, 255, 0.1)",t.lineWidth=1,t.strokeRect(m-2,n-m,o.size[0]-m*2+4,g),Object.entries(s.propertySchemas).forEach(([D,f])=>{if(i>=r.maxProperties)return;const v=f.label||D,p=o.properties[D];let y=p,R="#ffffff";if(typeof p=="boolean")y=p?"✓ Yes":"✗ No",R=p?"#4ade80":"#f87171";else if(typeof p=="number"){const k=f.step?Math.max(0,-Math.log10(f.step)):2;y=p.toFixed(k),R="#60a5fa"}else typeof p=="string"?(y=p.length>25?p.substring(0,22)+"...":p,R="#a78bfa"):typeof p=="object"&&(y="{...}",R="#fbbf24");t.font=`${r.fontSize}px system-ui, -apple-system, sans-serif`,t.fillStyle="rgba(255, 255, 255, 0.5)",t.fillText(v+":",m,n);const N=t.measureText(v+": ").width;t.font=`bold ${r.fontSize}px system-ui, -apple-system, sans-serif`,t.fillStyle=R;const z=o.size[0]-m*2-N;if(t.measureText(y).width>z){let k=y;for(;t.measureText(k+"...").width>z&&k.length>0;)k=k.substring(0,k.length-1);y=k+"..."}t.fillText(y,m+N,n),n+=c,i++}),t.restore()}let st=null;function so(){return st||(st=document.createElement("div"),st.id="node-help-tooltip",st.style.cssText=`
    position: fixed;
    z-index: 10000;
    max-width: 400px;
    max-height: 500px;
    overflow-y: auto;
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    border: 1px solid rgba(138, 180, 248, 0.3);
    border-radius: 12px;
    padding: 16px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.05);
    font-family: system-ui, -apple-system, sans-serif;
    font-size: 13px;
    color: #e0e0e0;
    display: none;
    backdrop-filter: blur(10px);
  `,document.body.appendChild(st),st)}function ns(o,t,s){const e=so();let r=`
    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px;">
      <div>
        <div style="font-size: 16px; font-weight: 600; color: #fff; margin-bottom: 4px;">
          ${o.name}
        </div>
        <div style="font-size: 11px; color: ${o.color||"#888"}; text-transform: uppercase; letter-spacing: 0.5px;">
          ${o.category}
        </div>
      </div>
      <button onclick="document.getElementById('node-help-tooltip').style.display='none'"
              style="background: rgba(255,255,255,0.1); border: none; color: #888; cursor: pointer; padding: 4px 8px; border-radius: 4px; font-size: 14px;">
        ✕
      </button>
    </div>
  `;o.description&&(r+=`
      <div style="margin-bottom: 16px; line-height: 1.5; color: #b0b0b0;">
        ${o.description}
      </div>
    `),o.inputs.length>0&&(r+=`
      <div style="margin-bottom: 12px;">
        <div style="font-size: 11px; font-weight: 600; color: #4ade80; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px;">
          ⬅ Inputs
        </div>
    `,o.inputs.forEach(g=>{r+=`
        <div style="display: flex; align-items: flex-start; margin-bottom: 6px; padding-left: 8px;">
          <span style="color: #8ab4f8; font-weight: 500; min-width: 80px;">${g.name}</span>
          <span style="color: #666; margin: 0 8px;">:</span>
          <span style="color: #888;">${g.type||"any"}</span>
          ${g.description?`<span style="color: #666; margin-left: 8px; font-style: italic;">- ${g.description}</span>`:""}
        </div>
      `}),r+="</div>"),o.outputs.length>0&&(r+=`
      <div style="margin-bottom: 12px;">
        <div style="font-size: 11px; font-weight: 600; color: #f87171; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px;">
          ➡ Outputs
        </div>
    `,o.outputs.forEach(g=>{r+=`
        <div style="display: flex; align-items: flex-start; margin-bottom: 6px; padding-left: 8px;">
          <span style="color: #fbbf24; font-weight: 500; min-width: 80px;">${g.name}</span>
          <span style="color: #666; margin: 0 8px;">:</span>
          <span style="color: #888;">${g.type||"any"}</span>
          ${g.description?`<span style="color: #666; margin-left: 8px; font-style: italic;">- ${g.description}</span>`:""}
        </div>
      `}),r+="</div>"),o.propertySchemas&&Object.keys(o.propertySchemas).length>0&&(r+=`
      <div style="margin-bottom: 8px;">
        <div style="font-size: 11px; font-weight: 600; color: #a78bfa; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px;">
          ⚙ Properties
        </div>
    `,Object.entries(o.propertySchemas).forEach(([g,D])=>{r+=`
        <div style="margin-bottom: 8px; padding-left: 8px; border-left: 2px solid rgba(167, 139, 250, 0.3);">
          <div style="display: flex; align-items: center;">
            <span style="color: #c4b5fd; font-weight: 500;">${D.label||g}</span>
            <span style="color: #555; margin-left: 8px; font-size: 11px;">(${D.type})</span>
          </div>
          ${D.description?`<div style="color: #666; font-size: 12px; margin-top: 2px;">${D.description}</div>`:""}
          ${D.default!==void 0?`<div style="color: #555; font-size: 11px; margin-top: 2px;">Default: <code style="background: rgba(0,0,0,0.3); padding: 1px 4px; border-radius: 3px;">${JSON.stringify(D.default)}</code></div>`:""}
        </div>
      `}),r+="</div>"),e.innerHTML=r,e.style.display="block";const n=e.getBoundingClientRect(),i=window.innerWidth,c=window.innerHeight;let m=t+20,h=s-20;m+n.width>i-20&&(m=t-n.width-20),h+n.height>c-20&&(h=c-n.height-20),h<20&&(h=20),e.style.left=m+"px",e.style.top=h+"px"}typeof document<"u"&&document.addEventListener("click",o=>{const t=document.getElementById("node-help-tooltip");t&&!t.contains(o.target)&&(t.style.display="none")});function oo(o){return class extends o{schema;muted=!1;_helpIconBounds=null;constructor(s){super(),this.schema=s,this.title=s.name,this.desc=s.description,this.color=s.color,this.bgcolor=s.bgColor,this.muted=!1,s.size&&(this.size=[...s.size]),s.inputs.forEach(e=>{this.addInput(e.name,e.type)}),s.outputs.forEach(e=>{this.addOutput(e.name,e.type)}),s.properties&&(this.properties={...s.properties}),s.propertySchemas&&eo(this,s)}onExecute(){if(this.inputs.length>0&&this.outputs.length>0){const s=this.getInputData(0);this.setOutputData(0,s)}}getExtraMenuOptions(s){const e=super.getExtraMenuOptions?super.getExtraMenuOptions(s):[];return e.push({content:this.muted?"🔊 Unmute Node":"🔇 Mute Node",callback:()=>{this.muted=!this.muted,this.graph?.canvas&&this.graph.canvas.setDirty(!0,!0)}}),e}getInputsData(){const s={};return this.schema.inputs.forEach((e,r)=>{s[e.name]=this.getInputData(r)}),s}setOutputsData(s){this.schema.outputs.forEach((e,r)=>{s[e.name]!==void 0&&this.setOutputData(r,s[e.name])})}serialize(){const s=super.serialize();return s.schema_id=this.schema.id,s.muted=this.muted,s}configure(s){super.configure(s),s.muted!==void 0&&(this.muted=s.muted)}getTitle(){return this.schema.name}onMouseDown(s,e,r){if(this._helpIconBounds){const{x:n,y:i,width:c,height:m}=this._helpIconBounds;if(e[0]>=n&&e[0]<=n+c&&e[1]>=i&&e[1]<=i+m){const h=r?.canvas||this.graph?.canvas?.canvas;if(h){const g=h.getBoundingClientRect(),D=r?.ds||this.graph?.canvas?.ds,f=D?.scale||1,v=D?.offset||[0,0],p=g.left+(this.pos[0]+e[0]+v[0])*f,y=g.top+(this.pos[1]+e[1]+v[1])*f;ns(this.schema,p,y)}else ns(this.schema,s.clientX,s.clientY);return!0}}return!1}onDrawForeground(s){const r=this.size[0]-18-5,n=-22;if(this._helpIconBounds={x:r,y:n,width:18,height:18},s.save(),s.beginPath(),s.arc(r+18/2,n+18/2,18/2,0,Math.PI*2),s.fillStyle="rgba(138, 180, 248, 0.15)",s.fill(),s.strokeStyle="rgba(138, 180, 248, 0.4)",s.lineWidth=1,s.stroke(),s.font="bold 12px system-ui, -apple-system, sans-serif",s.fillStyle="#8ab4f8",s.textAlign="center",s.textBaseline="middle",s.fillText("?",r+18/2,n+18/2+1),s.restore(),!this.schema.propertySchemas)return;const i=Object.keys(this.schema.propertySchemas).length,c=(this.widgets?.length||0)*30,m=(this.inputs?.length||0)*20,h=(this.outputs?.length||0)*20,g=Math.max(m,h,60),D=Math.min(i,8)*16+16,f=g+c+D+40;s.save(),s.font="bold 10px system-ui, -apple-system, sans-serif";let v=200;const p=s.measureText(this.title||this.schema.name).width+80;v=Math.max(v,p),this.schema.propertySchemas&&Object.entries(this.schema.propertySchemas).forEach(([N,z])=>{const I=z.label||N,k=this.properties?.[N]||z.default;let S=String(k);const O=s.measureText(I+": "+S).width+40;v=Math.max(v,O)}),s.restore();const y=Math.min(v,400);this.size[1]<f&&(this.size[1]=f),this.size[0]<y&&(this.size[0]=y);const R=g+c+10;to(this,s,this.schema,{startY:R,fontSize:10,color:this.schema.color||"#aaa",maxProperties:8}),this.muted&&(s.save(),s.font="20px Arial",s.fillStyle="#ff6b6b",s.textAlign="right",s.fillText("🔇",this.size[0]-5,20),s.fillStyle="rgba(0, 0, 0, 0.25)",s.fillRect(0,0,this.size[0],this.size[1]),s.restore())}onDrawBackground(s){if(this.flags.collapsed)return;s.save();const e=s.createLinearGradient(0,0,0,this.size[1]);e.addColorStop(0,"rgba(255, 255, 255, 0.02)"),e.addColorStop(1,"rgba(0, 0, 0, 0.02)"),s.fillStyle=e,s.fillRect(0,0,this.size[0],this.size[1]),s.restore()}}}function ro(o){class t extends o{static schema=C.find(a=>a.id==="mic_input");constructor(){super(t.schema)}onExecute(){this.setOutputData(0,null),this.setOutputData(1,!1)}}class s extends o{static schema=C.find(a=>a.id==="speech_to_text");constructor(){super(s.schema)}onExecute(){this.setOutputData(0,""),this.setOutputData(1,!1)}}class e extends o{static schema=C.find(a=>a.id==="text_input");constructor(){super(e.schema)}onExecute(){this.setOutputData(0,""),this.setOutputData(1,!0)}}class r extends o{static schema=C.find(a=>a.id==="user_input");constructor(){super(r.schema),typeof this.addWidget=="function"&&(this.addWidget("text","message",this.properties.message,a=>{this.properties.message=a}),this.addWidget("toggle","prioritizeChatInterface",this.properties.prioritizeChatInterface,a=>{this.properties.prioritizeChatInterface=a}))}onExecute(){let a="",L="chat";if(this.properties.prioritizeChatInterface)a=this.properties.message||"",L="chat";else{const P=this.getInputData(0),q=this.getInputData(1);P?.text&&P?.transcribed?(a=P.text,L="speech"):q?(a=q,L="text"):(a=this.properties.message||"",L="chat")}this.setOutputData(0,a),this.setOutputData(1,L),this.setOutputData(2,`session-${Date.now()}`)}}class n extends o{static schema=C.find(a=>a.id==="session_context");constructor(){super(n.schema)}onExecute(){this.getInputData(0),this.setOutputData(0,[]),this.setOutputData(1,{id:"user-1",username:"greggles",role:"owner"})}}class i extends o{static schema=C.find(a=>a.id==="system_settings");constructor(){super(i.schema)}onExecute(){this.setOutputData(0,"dual"),this.setOutputData(1,"supervised_auto"),this.setOutputData(2,{})}}class c extends o{static schema=C.find(a=>a.id==="cognitive_mode_router");constructor(){super(c.schema)}onExecute(){const a=this.getInputData(0);this.setOutputData(0,a==="dual"),this.setOutputData(1,a==="agent"),this.setOutputData(2,a==="emulation")}}class m extends o{static schema=C.find(a=>a.id==="auth_check");constructor(){super(m.schema)}onExecute(){const a=this.getInputData(0);this.setOutputData(0,a&&a.role!=="anonymous"),this.setOutputData(1,a?.role||"anonymous")}}class h extends o{static schema=C.find(a=>a.id==="operator_eligibility");constructor(){super(h.schema)}onExecute(){const a=this.getInputData(0),L=this.getInputData(1),P=this.getInputData(2);let q=!1;a==="dual"&&L?q=!0:a==="agent"&&L&&(q=["create","update","delete","search","find","list","show"].some(Z=>P?.toLowerCase().includes(Z))),this.setOutputData(0,q)}}class g extends o{static schema=C.find(a=>a.id==="smart_router");constructor(){super(g.schema)}onExecute(){const a=this.getInputData(0),L=a?.complexity||.5,P=a?.needsMemory||!1,q=this.properties.simpleThreshold||.3;L<q&&!P?(this.setOutputData(0,null),this.setOutputData(1,a)):(this.setOutputData(0,a),this.setOutputData(1,null))}}class D extends o{static schema=C.find(a=>a.id==="context_builder");constructor(){super(D.schema)}async onExecute(){const a=this.getInputsData(),L={query:a.message,mode:a.cognitiveMode,memories:[],conversationHistory:a.conversationHistory||[],shortTermState:{}};this.setOutputData(0,L)}}class f extends o{static schema=C.find(a=>a.id==="semantic_search");constructor(){super(f.schema)}async onExecute(){this.getInputData(0),this.getInputData(1)||this.properties.similarityThreshold;const a=[];this.setOutputData(0,a)}}class v extends o{static schema=C.find(a=>a.id==="buffer_manager");constructor(){super(v.schema)}async onExecute(){const L={persisted:!0,mode:"conversation",messageCount:this.getInputData(0)?.length||0};this.setOutputData(0,L)}}class p extends o{static schema=C.find(a=>a.id==="react_planner");constructor(){super(p.schema)}async onExecute(){const a=this.getInputData(0);this.getInputData(1),this.getInputData(2),this.setOutputData(0,`Thinking about: ${a}`),this.setOutputData(1,{skill:"conversational_response",args:{message:a}})}}class y extends o{static schema=C.find(a=>a.id==="skill_executor");constructor(){super(y.schema)}async onExecute(){const a=this.getInputData(0),L=this.getInputData(1);try{const{executeSkill:P}=await Ve(async()=>{const{executeSkill:Me}=await import("@metahuman/core/skills");return{executeSkill:Me}},[]),{loadDecisionRules:q}=await Ve(async()=>{const{loadDecisionRules:Me}=await import("@metahuman/core/identity");return{loadDecisionRules:Me}},[]),Z=q().trustLevel,ue=await P(a,L,Z);this.setOutputData(0,{success:ue.success,...ue.outputs,error:ue.error}),this.setOutputData(1,ue.success),ue.success||this.setOutputData(2,{message:ue.error})}catch(P){console.error(`[SkillExecutor] Error executing ${a}:`,P),this.setOutputData(1,!1),this.setOutputData(2,{message:P.message})}}}class R extends o{static schema=C.find(a=>a.id==="big_brother_router");constructor(){super(R.schema)}async onExecute(){const a=this.getInputData(0),L=this.getInputData(1);try{const{loadOperatorConfig:P}=await Ve(async()=>{const{loadOperatorConfig:$e}=await import("@metahuman/core/config");return{loadOperatorConfig:$e}},[]),{isClaudeSessionReady:q}=await Ve(async()=>{const{isClaudeSessionReady:$e}=await import("@metahuman/core/claude-session");return{isClaudeSessionReady:$e}},[]),Z=P().bigBrotherMode?.enabled||!1,ue=q(),Me={skillName:a,args:L};Z&&ue?(this.setOutputData(1,Me),console.log(`[BigBrotherRouter] Routing ${a} to Claude CLI`)):(this.setOutputData(0,Me),console.log(`[BigBrotherRouter] Routing ${a} to local executor`))}catch(P){console.error("[BigBrotherRouter] Error:",P),this.setOutputData(0,{skillName:a,args:L})}}}class N extends o{static schema=C.find(a=>a.id==="big_brother_executor");constructor(){super(N.schema)}async onExecute(){const a=this.getInputData(0),L=this.getInputData(1);try{const{audit:P}=await Ve(async()=>{const{audit:nt}=await import("@metahuman/core/audit");return{audit:nt}},[]),{isClaudeSessionReady:q,sendPrompt:K,startClaudeSession:Z}=await Ve(async()=>{const{isClaudeSessionReady:nt,sendPrompt:Qs,startClaudeSession:Ys}=await import("@metahuman/core/claude-session");return{isClaudeSessionReady:nt,sendPrompt:Qs,startClaudeSession:Ys}},[]);if(!q()&&(P({level:"warn",category:"action",event:"claude_session_not_ready_auto_start",details:{skillId:a},actor:"big-brother"}),!await Z()))throw new Error("Claude session not available");P({level:"info",category:"action",event:"big_brother_skill_delegation",details:{skillId:a,inputs:JSON.stringify(L).substring(0,200)},actor:"big-brother"});const ue=`I need you to execute a skill for me. This is part of an automated system where you're acting as the intelligent executor.

**Skill to Execute:** ${a}

**Skill Inputs:**
${JSON.stringify(L,null,2)}

Please execute this skill and return the result in the following JSON format:
{
  "success": true/false,
  "output": "the result or output from executing the skill",
  "error": "error message if failed (optional)"
}

Important:
- Execute the skill using the appropriate tools available to you
- Return ONLY the JSON result, no explanations
- Be precise and accurate`,Me=await K(ue,this.properties.timeout||6e4),$e=Me.match(/\{[\s\S]*\}/);let tt;$e?(tt=JSON.parse($e[0]),P({level:"info",category:"action",event:"claude_skill_executed",details:{skillId:a,success:tt.success},actor:"big-brother"})):(P({level:"warn",category:"action",event:"claude_skill_response_not_json",details:{skillId:a,responseLength:Me.length},actor:"big-brother"}),tt={success:!0,output:Me}),this.setOutputData(0,tt),this.setOutputData(1,tt.success),tt.success||this.setOutputData(2,{message:tt.error})}catch(P){console.error(`[BigBrotherExecutor] Error executing ${a}:`,P);const{audit:q}=await Ve(async()=>{const{audit:K}=await import("@metahuman/core/audit");return{audit:K}},[]);q({level:"error",category:"action",event:"claude_skill_execution_failed",details:{skillId:a,error:P.message},actor:"big-brother"}),this.setOutputData(1,!1),this.setOutputData(2,{message:P.message})}}}class z extends o{static schema=C.find(a=>a.id==="claude_full_task");constructor(){super(z.schema)}async onExecute(){await super.onExecute()}}class I extends o{static schema=C.find(a=>a.id==="persona_llm");constructor(){super(I.schema)}async onExecute(){this.getInputData(0),this.getInputData(1),this.getInputData(2),this.getInputData(3),this.setOutputData(0,"This is a mock persona response")}}class k extends o{static schema=C.find(a=>a.id==="orchestrator_llm");constructor(){super(k.schema)}async onExecute(){this.getInputData(0);const a={needsMemory:!1,responseStyle:"conversational",instructions:"Respond naturally to the greeting."};this.setOutputData(0,a)}}class S extends o{static schema=C.find(a=>a.id==="reflector_llm");constructor(){super(S.schema)}async onExecute(){this.getInputData(0),this.setOutputData(0,"This is a mock reflector response")}}class O extends o{static schema=C.find(a=>a.id==="inner_dialogue_capture");constructor(){super(O.schema)}async onExecute(){const a=this.getInputData(0);this.getInputData(1);const L={saved:!0,type:"inner_dialogue",eventPath:"memory/episodic/mock-path.json",textLength:a?.length||0};this.setOutputData(0,L)}}class T extends o{static schema=C.find(a=>a.id==="model_resolver");constructor(){super(T.schema)}onExecute(){const a=this.getInputData(0);this.getInputData(1);const L={model:"qwen3:14b",role:a,temperature:.7};this.setOutputData(0,L)}}class G extends o{static schema=C.find(a=>a.id==="memory_capture");constructor(){super(G.schema)}async onExecute(){this.getInputsData();const a=`memory/episodic/2025/2025-11-18-${Date.now()}.json`;this.setOutputData(0,a)}}class A extends o{static schema=C.find(a=>a.id==="stream_writer");constructor(){super(A.schema)}onExecute(){const a=this.getInputData(0);console.log("[StreamWriter]",a),this.setOutputData(0,a),this.boxcolor="#2d5"}}class J extends o{static schema=C.find(a=>a.id==="chat_view");constructor(){super(J.schema),typeof this.addWidget=="function"&&(this.addWidget("combo","mode",this.properties.mode,a=>{this.properties.mode=a},{values:["direct","trigger"]}),this.addWidget("number","maxMessages",this.properties.maxMessages,a=>{this.properties.maxMessages=a})),this.size=[300,200]}onExecute(){const a=this.properties.mode||"direct",L=this.getInputData(0),P=this.getInputData(1);a==="direct"&&L?this.displayMessage(L):a==="trigger"&&P&&this.displayMessage(`[Trigger received: ${typeof P}]`),this.boxcolor=a==="direct"&&L?"#2d5":"#555"}onDrawForeground(a){if(!this.flags.collapsed){const L=this.getInputData(0);if(L){a.save(),a.fillStyle="#ddd",a.font="12px monospace";const P=this.size[0]-20,q=this.wrapText(a,L,P),K=Math.min(q.length,this.properties.maxMessages||5);let Z=60;for(let ue=0;ue<K;ue++)a.fillText(q[ue],10,Z),Z+=16;q.length>K&&(a.fillStyle="#888",a.fillText(`... (${q.length-K} more lines)`,10,Z)),a.restore()}}}wrapText(a,L,P){const q=L.split(" "),K=[];let Z="";for(const ue of q){const Me=Z?`${Z} ${ue}`:ue;a.measureText(Me).width>P&&Z?(K.push(Z),Z=ue):Z=Me}return Z&&K.push(Z),K}displayMessage(a){this.title=`Chat View (${this.properties.mode})`,this.graph&&this.graph.canvas&&this.graph.canvas.setDirty(!0,!0)}getTitle(){return`Chat View (${this.properties.mode||"direct"})`}}class H extends o{static schema=C.find(a=>a.id==="tts");currentAudio=null;currentObjectUrl=null;isPlaying=!1;constructor(){super(H.schema),typeof this.addWidget=="function"&&(this.addWidget("text","provider",this.properties.provider||"",a=>{this.properties.provider=a}),this.addWidget("toggle","autoPlay",this.properties.autoPlay!==!1,a=>{this.properties.autoPlay=a}))}onExecute(){const a=this.getInputData(0);if(!a||typeof a!="string"){this.boxcolor="#555";return}this.properties.autoPlay!==!1&&this.speakText(a)}async speakText(a){this.stopAudio(),this.isPlaying=!0,this.boxcolor="#25d";try{const L={text:a};this.properties.provider&&this.properties.provider.trim()!==""&&(L.provider=this.properties.provider),console.log("[TTS Node] Fetching TTS from /api/tts...");const P=await Be("/api/tts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!P.ok){console.warn("[TTS Node] TTS request failed:",P.status),this.boxcolor="#d52",this.isPlaying=!1;return}const q=await P.blob(),K=URL.createObjectURL(q);this.currentObjectUrl=K;const Z=new Audio(K);this.currentAudio=Z;const ue=()=>{this.stopAudio(),this.isPlaying=!1,this.boxcolor="#2d5"};Z.onended=ue,Z.onerror=ue,this.boxcolor="#2d5",await Z.play().catch(Me=>{console.warn("[TTS Node] Audio playback failed:",Me),ue()})}catch(L){console.error("[TTS Node] Error:",L),this.boxcolor="#d52",this.isPlaying=!1}}stopAudio(){if(this.currentAudio){try{this.currentAudio.pause()}catch{}this.currentAudio=null}this.currentObjectUrl&&(URL.revokeObjectURL(this.currentObjectUrl),this.currentObjectUrl=null)}onRemoved(){this.stopAudio()}getTitle(){return this.isPlaying?"TTS (Playing...)":"Text to Speech"}}class Q extends o{static schema=C.find(a=>a.id==="thinking_stripper");constructor(){super(Q.schema)}onExecute(){const a=this.getInputData(0);let L="";typeof a=="string"?L=a:a?.response?typeof a.response=="string"?L=a.response:typeof a.response=="object"&&a.response?.response?L=a.response.response:typeof a.response=="object"&&a.response?.content&&(L=a.response.content):a?.content&&typeof a.content=="string"&&(L=a.content);const{thinking:P,stripped:q,hadThinking:K}=this.parseThinkingBlocks(L);this.setOutputData(0,q),this.setOutputData(1,q),this.setOutputData(2,P),this.setOutputData(3,K),this.boxcolor=K?"#9b59b6":"#2d5"}parseThinkingBlocks(a){if(!a)return{thinking:null,stripped:"",hadThinking:!1};const L=/<think>([\s\S]*?)<\/think>/gi,P=a.match(L);if(!P||P.length===0)return{thinking:null,stripped:a.trim(),hadThinking:!1};let q="";for(const Z of P){const ue=Z.replace(/<\/?think>/gi,"").trim();ue&&(q+=(q?`

`:"")+ue)}const K=a.replace(L,"").replace(/^\s*\n+/,"").trim();return{thinking:q||null,stripped:K,hadThinking:!0}}}class X extends o{static schema=C.find(a=>a.id==="skill_fs_read");constructor(){super(X.schema)}async onExecute(){const a=this.getInputData(0);try{this.setOutputData(0,`Contents of ${a}`),this.setOutputData(1,!0)}catch{this.setOutputData(0,""),this.setOutputData(1,!1)}}}class ge extends o{static schema=C.find(a=>a.id==="skill_task_list");constructor(){super(ge.schema)}async onExecute(){const a=[{id:"1",title:"Example task",status:"active"}];this.setOutputData(0,a)}}class Oe extends o{static schema=C.find(a=>a.id==="skill_conversational_response");constructor(){super(Oe.schema)}async onExecute(){const a=this.getInputData(0);this.getInputData(1),this.getInputData(2)||this.properties.style;const L=`Response to: ${a}`;this.setOutputData(0,L)}}class Ie extends o{static schema=Ae("conversation_history");constructor(){super(Ie.schema)}}class j extends o{static schema=Ae("observation_formatter");constructor(){super(j.schema)}}class W extends o{static schema=Ae("completion_checker");constructor(){super(W.schema)}}class U extends o{static schema=Ae("response_synthesizer");constructor(){super(U.schema)}}class ee extends o{static schema=C.find(a=>a.id==="iteration_counter");constructor(){super(ee.schema)}onExecute(){const a=this.getInputData(0),P=this.getInputData(1)||a||{},q=P.iteration||0,K=this.properties.maxIterations||10;this.setOutputData(0,{iteration:q,maxIterations:K,scratchpad:P.scratchpad||[]})}}class $ extends o{static schema=C.find(a=>a.id==="scratchpad_completion_checker");constructor(){super($.schema)}onExecute(){const a=this.getInputData(0)||{},L=a.scratchpad||[],P=a.iteration||0,q=a.maxIterations||10,K=L[L.length-1]||{},Z=`${K.thought||""} ${K.observation||""}`,ue=/Final Answer:|FINAL_ANSWER|Task Complete/i.test(Z),Me=P>=q,$e=ue||Me;this.setOutputData(0,{isComplete:$e,reason:ue?"Final answer detected":Me?"Max iterations reached":"Continue",scratchpad:a})}}class he extends o{static schema=C.find(a=>a.id==="scratchpad_formatter");constructor(){super(he.schema)}onExecute(){const L=(this.getInputData(0)||{}).scratchpad||[],P=this.properties.format||"text";let q="";P==="json"?q=JSON.stringify(L,null,2):P==="markdown"?q=L.map((K,Z)=>`### Iteration ${Z+1}

**Thought:** ${K.thought}

**Action:** ${K.action}

**Observation:** ${K.observation}
`).join(`
---

`):q=L.map(K=>`Thought: ${K.thought}
Action: ${K.action}
Observation: ${K.observation}`).join(`

`),this.setOutputData(0,q)}}class se extends o{static schema=Ae("cot_stripper");constructor(){super(se.schema)}}class _e extends o{static schema=Ae("safety_validator");constructor(){super(_e.schema)}}class ie extends o{static schema=Ae("response_refiner");constructor(){super(ie.schema)}}class le extends o{static schema=Ae("model_router");constructor(){super(le.schema)}}class ce extends o{static schema=Ae("audit_logger");constructor(){super(ce.schema)}}class ve extends o{static schema=Ae("skill_fs_write");constructor(){super(ve.schema)}}class Le extends o{static schema=Ae("skill_fs_list");constructor(){super(Le.schema)}}class Ce extends o{static schema=Ae("skill_task_create");constructor(){super(Ce.schema)}}class Se extends o{static schema=Ae("skill_task_update");constructor(){super(Se.schema)}}class be extends o{static schema=Ae("skill_search_index");constructor(){super(be.schema)}}class ze extends o{static schema=Ae("skill_web_search");constructor(){super(ze.schema)}}class Ue extends o{static schema=C.find(a=>a.id==="loop_controller");constructor(){super(Ue.schema)}}class ye extends o{static schema=C.find(a=>a.id==="conditional_branch");constructor(){super(ye.schema)}}class Ye extends o{static schema=C.find(a=>a.id==="conditional_router");constructor(){super(Ye.schema)}onExecute(){const a=this.getInputData(0),L=this.getInputData(1),P=this.getInputData(2),q=a?.isComplete||a?.isDone||a?.shouldContinue||!!a;this.setOutputData(0,q?L:null),this.setOutputData(1,q?null:P)}}class qe extends o{static schema=C.find(a=>a.id==="switch");constructor(){super(qe.schema)}}class je extends o{static schema=C.find(a=>a.id==="for_each");constructor(){super(je.schema)}}class ke extends o{static schema=C.find(a=>a.id==="weighted_sampler");constructor(){super(ke.schema)}}class et extends o{static schema=C.find(a=>a.id==="associative_chain");constructor(){super(et.schema)}}class Ne extends o{static schema=C.find(a=>a.id==="memory_filter");constructor(){super(Ne.schema)}}class we extends o{static schema=C.find(a=>a.id==="memory_router");constructor(){super(we.schema)}async onExecute(){const a=this.getInputData(0)||{},L=this.getInputData(1)||"",P=a.needsMemory||!1,q=a.memoryTier||"hot",K=a.memoryQuery||L,Z={memories:[],searchPerformed:P,tier:q,query:K};this.setOutputData(0,Z)}}class xe extends o{static schema=C.find(a=>a.id==="json_parser");constructor(){super(xe.schema)}}class Ee extends o{static schema=C.find(a=>a.id==="text_template");constructor(){super(Ee.schema)}}class Y extends o{static schema=C.find(a=>a.id==="data_transform");constructor(){super(Y.schema)}}class ne extends o{static schema=C.find(a=>a.id==="cache");constructor(){super(ne.schema)}}class Pe extends o{static schema=C.find(a=>a.id==="plan_parser");constructor(){super(Pe.schema)}}class Je extends o{static schema=C.find(a=>a.id==="scratchpad_manager");constructor(){super(Je.schema)}}class _ extends o{static schema=C.find(a=>a.id==="error_recovery");constructor(){super(_.schema)}}class te extends o{static schema=C.find(a=>a.id==="stuck_detector");constructor(){super(te.schema)}}class pe extends o{static schema=C.find(a=>a.id==="big_brother");constructor(){super(pe.schema)}async onExecute(){const a=this.getInputData(0),L=this.getInputData(1),P=this.getInputData(2),q=this.getInputData(3);if(!a||!L){this.setOutputData(0,[]),this.setOutputData(1,"Missing required inputs"),this.setOutputData(2,""),this.setOutputData(3,!1),this.boxcolor="#d52";return}try{this.boxcolor="#25d";const K=await Be("/api/big-brother-escalate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({goal:a,scratchpad:L,errorType:P,context:q,stuckReason:q?.reason||"Unknown",suggestions:q?.suggestions||[]})});if(!K.ok)throw new Error(`Big Brother escalation failed: ${K.statusText}`);const Z=await K.json();this.setOutputData(0,Z.suggestions||[]),this.setOutputData(1,Z.reasoning||""),this.setOutputData(2,Z.alternativeApproach||""),this.setOutputData(3,Z.success||!1),this.boxcolor=Z.success?"#2d5":"#d52"}catch(K){console.error("[BigBrotherNode] Error:",K),this.setOutputData(0,[]),this.setOutputData(1,K.message),this.setOutputData(2,""),this.setOutputData(3,!1),this.boxcolor="#d52"}}}class fe extends o{static schema=C.find(a=>a.id==="memory_loader");constructor(){super(fe.schema)}}class Fe extends o{static schema=C.find(a=>a.id==="memory_saver");constructor(){super(Fe.schema)}}class Re extends o{static schema=C.find(a=>a.id==="llm_enricher");constructor(){super(Re.schema)}}class Xe extends o{static schema=C.find(a=>a.id==="agent_timer");constructor(){super(Xe.schema)}}class Ze extends o{static schema=C.find(a=>a.id==="curiosity_weighted_sampler");constructor(){super(Ze.schema)}}class dt extends o{static schema=C.find(a=>a.id==="curiosity_question_generator");constructor(){super(dt.schema)}}class pt extends o{static schema=C.find(a=>a.id==="curiosity_question_saver");constructor(){super(pt.schema)}}class ut extends o{static schema=C.find(a=>a.id==="curiosity_activity_check");constructor(){super(ut.schema)}}class ht extends o{static schema=C.find(a=>a.id==="persona_loader");constructor(){super(ht.schema)}onExecute(){const a={persona:{personality:{traits:["curious","analytical","helpful"]}},identity:{name:"Greg",role:"AI Researcher",purpose:"To assist and learn"},values:{core:[{value:"transparency"},{value:"growth"},{value:"creativity"}]},goals:{shortTerm:[{goal:"Build amazing AI systems"}]},activeFacet:"default"};this.setOutputData(0,a)}}class mt extends o{static schema=C.find(a=>a.id==="persona_formatter");constructor(){super(mt.schema)}onExecute(){this.getInputData(0);const a={formatted:"You are Greg, an AI researcher and developer.",success:!0,characterCount:43};this.setOutputData(0,a)}}class gt extends o{static schema=C.find(a=>a.id==="persona_saver");constructor(){super(gt.schema)}}class ft extends o{static schema=C.find(a=>a.id==="trust_level_reader");constructor(){super(ft.schema)}}class yt extends o{static schema=C.find(a=>a.id==="trust_level_writer");constructor(){super(yt.schema)}}class vt extends o{static schema=C.find(a=>a.id==="decision_rules_loader");constructor(){super(vt.schema)}}class _t extends o{static schema=C.find(a=>a.id==="decision_rules_saver");constructor(){super(_t.schema)}}class bt extends o{static schema=C.find(a=>a.id==="identity_extractor");constructor(){super(bt.schema)}}class kt extends o{static schema=C.find(a=>a.id==="value_manager");constructor(){super(kt.schema)}}class wt extends o{static schema=C.find(a=>a.id==="goal_manager");constructor(){super(wt.schema)}}class xt extends o{static schema=C.find(a=>a.id==="scratchpad_initializer");constructor(){super(xt.schema)}onExecute(){const a=this.getInputData(0)||"",L=this.properties?.fields||["thoughts","keywords","seenMemoryIds"],P={seedMemory:a};L.forEach(q=>{P[q]=[]}),this.setOutputData(0,P)}}class Et extends o{static schema=C.find(a=>a.id==="scratchpad_updater");constructor(){super(Et.schema)}onExecute(){const a=this.getInputData(0)||{},L=this.getInputData(1)||"",P=this.getInputData(2)||{},q=a.iteration||0,K=a.maxIterations||10,Z=a.scratchpad||[],ue={thought:P.thought||"",action:P.action||"",observation:L},Me=[...Z,ue];this.setOutputData(0,{iteration:q+1,maxIterations:K,scratchpad:Me})}}class Dt extends o{static schema=C.find(a=>a.id==="thought_generator");constructor(){super(Dt.schema)}onExecute(){const a=this.getInputData(0)||{},L=this.getInputData(1)||a.seedMemory||"";this.setOutputData(0,{thought:"[Generated thought will appear here]",thoughts:a.thoughts||[],keywords:[],confidence:.5,seedMemory:L})}}class Tt extends o{static schema=C.find(a=>a.id==="thought_evaluator");constructor(){super(Tt.schema)}onExecute(){const a=this.getInputData(0)||{},L=a.thoughts||[],P=this.properties?.maxIterations||7;this.setOutputData(0,{isComplete:L.length>=P,reason:`Iteration ${L.length}/${P}`,nextSearchTerms:a.keywords||[],thoughts:L,seedMemory:a.seedMemory||""})}}class Nt extends o{static schema=C.find(a=>a.id==="thought_aggregator");constructor(){super(Nt.schema)}onExecute(){const L=(this.getInputData(0)||{}).thoughts||[];this.setOutputData(0,{consolidatedChain:L.join(`

`),insight:L[L.length-1]||"",summary:`Chain of ${L.length} thoughts`,thoughtCount:L.length})}}class It extends o{static schema=C.find(a=>a.id==="loop_memory_search");constructor(){super(It.schema)}onExecute(){const a=this.getInputData(0)||[];this.getInputData(1),this.setOutputData(0,{memories:[],memoryIds:[],searchTermsUsed:a})}}class St extends o{static schema=C.find(a=>a.id==="agent_trigger");constructor(){super(St.schema)}onExecute(){const a=this.getInputData(0)||{},L=this.properties?.agentName||"";this.setOutputData(0,{triggered:!!L,agentName:L,inputData:a})}}class Mt extends o{static schema=C.find(a=>a.id==="uncurated_memory_loader");constructor(){super(Mt.schema)}onExecute(){this.setOutputData(0,[])}}class Ct extends o{static schema=C.find(a=>a.id==="persona_summary_loader");constructor(){super(Ct.schema)}onExecute(){this.setOutputData(0,"Persona summary...")}}class Ot extends o{static schema=C.find(a=>a.id==="curator_llm");constructor(){super(Ot.schema)}async onExecute(){this.getInputData(0),this.getInputData(1),this.setOutputData(0,[])}}class Lt extends o{static schema=C.find(a=>a.id==="curated_memory_saver");constructor(){super(Lt.schema)}onExecute(){const a=this.getInputData(0)||[];this.setOutputData(0,a.length)}}class jt extends o{static schema=C.find(a=>a.id==="training_pair_generator");constructor(){super(jt.schema)}onExecute(){this.getInputData(0),this.setOutputData(0,[])}}class Rt extends o{static schema=C.find(a=>a.id==="training_pair_appender");constructor(){super(Rt.schema)}onExecute(){const a=this.getInputData(0)||[];this.setOutputData(0,a.length)}}class At extends o{static schema=C.find(a=>a.id==="memory_marker");constructor(){super(At.schema)}onExecute(){const a=this.getInputData(0)||[];this.setOutputData(0,a.length)}}class zt extends o{static schema=C.find(a=>a.id==="dreamer_memory_curator");constructor(){super(zt.schema)}onExecute(){this.setOutputData(0,[]),this.setOutputData(1,0),this.setOutputData(2,0),this.setOutputData(3,0),this.setOutputData(4,"unknown")}}class Gt extends o{static schema=C.find(a=>a.id==="dreamer_dream_generator");constructor(){super(Gt.schema)}async onExecute(){const a=this.getInputData(0)||[];this.getInputData(1),this.setOutputData(0,"A surreal dream..."),this.setOutputData(1,a.length),this.setOutputData(2,[]),this.setOutputData(3,"unknown")}}class Pt extends o{static schema=C.find(a=>a.id==="dreamer_dream_saver");constructor(){super(Pt.schema)}onExecute(){const a=this.getInputData(0)||{};this.getInputData(1),this.setOutputData(0,!0),this.setOutputData(1,"dream-"+Date.now()),this.setOutputData(2,a.dream||""),this.setOutputData(3,0),this.setOutputData(4,"unknown")}}class Vt extends o{static schema=C.find(a=>a.id==="dreamer_continuation_generator");constructor(){super(Vt.schema)}async onExecute(){this.getInputData(0),this.setOutputData(0,[]),this.setOutputData(1,0),this.setOutputData(2,"unknown")}}class Ft extends o{static schema=C.find(a=>a.id==="dreamer_learnings_extractor");constructor(){super(Ft.schema)}async onExecute(){this.getInputData(0),this.setOutputData(0,[]),this.setOutputData(1,[]),this.setOutputData(2,[]),this.setOutputData(3,[]),this.setOutputData(4,0),this.setOutputData(5,"unknown")}}class Ht extends o{static schema=C.find(a=>a.id==="dreamer_learnings_writer");constructor(){super(Ht.schema)}onExecute(){this.getInputData(0),this.getInputData(1);const a=new Date().toISOString().split("T")[0];this.setOutputData(0,!0),this.setOutputData(1,`/procedural/${a}.md`),this.setOutputData(2,`${a}.md`),this.setOutputData(3,a),this.setOutputData(4,"unknown")}}class Wt extends o{static schema=C.find(a=>a.id==="desire_memory_analyzer");constructor(){super(Wt.schema)}async onExecute(){this.setOutputData(0,[]),this.setOutputData(1,0),this.setOutputData(2,!1)}}class Ut extends o{static schema=C.find(a=>a.id==="desire_detector");constructor(){super(Ut.schema)}async onExecute(){this.getInputData(0),this.setOutputData(0,!1),this.setOutputData(1,null),this.setOutputData(2,0),this.setOutputData(3,"No input provided")}}class qt extends o{static schema=C.find(a=>a.id==="desire_folder_creator");constructor(){super(qt.schema)}async onExecute(){const a=this.getInputData(0);this.setOutputData(0,a),this.setOutputData(1,"/mock/path"),this.setOutputData(2,!0)}}class Jt extends o{static schema=C.find(a=>a.id==="desire_updater");constructor(){super(Jt.schema)}async onExecute(){const a=this.getInputData(0);this.setOutputData(0,a),this.setOutputData(1,!0)}}class Bt extends o{static schema=C.find(a=>a.id==="conditional");constructor(){super(Bt.schema)}onExecute(){const a=this.getInputData(0),L=this.properties.condition||"value === true";let P=!1;try{L==="value === true"||L==="detected === true"?P=a===!0||a?.detected===!0:L==="value === false"||L==="detected === false"?P=a===!1||a?.detected===!1:P=!!a}catch{P=!!a}this.setOutputData(0,P?a:null),this.setOutputData(1,P?null:a)}}class Kt extends o{static schema=C.find(a=>a.id==="result_aggregator");constructor(){super(Kt.schema)}onExecute(){const a=this.getInputData(0);this.setOutputData(0,a)}}return{MicInputNodeImpl:t,SpeechToTextNodeImpl:s,TextInputNodeImpl:e,UserInputNodeImpl:r,SessionContextNodeImpl:n,SystemSettingsNodeImpl:i,CognitiveModeRouterNodeImpl:c,AuthCheckNodeImpl:m,OperatorEligibilityNodeImpl:h,SmartRouterNodeImpl:g,ContextBuilderNodeImpl:D,SemanticSearchNodeImpl:f,BufferManagerNodeImpl:v,ConversationHistoryNodeImpl:Ie,ReActPlannerNodeImpl:p,SkillExecutorNodeImpl:y,ObservationFormatterNodeImpl:j,CompletionCheckerNodeImpl:W,ResponseSynthesizerNodeImpl:U,IterationCounterNodeImpl:ee,ScratchpadCompletionCheckerNodeImpl:$,ScratchpadFormatterNodeImpl:he,PersonaLLMNodeImpl:I,OrchestratorLLMNodeImpl:k,ReflectorLLMNodeImpl:S,InnerDialogueCaptureNodeImpl:O,ChainOfThoughtStripperNodeImpl:se,SafetyValidatorNodeImpl:_e,ResponseRefinerNodeImpl:ie,ModelResolverNodeImpl:T,ModelRouterNodeImpl:le,MemoryCaptureNodeImpl:G,AuditLoggerNodeImpl:ce,StreamWriterNodeImpl:A,ChatViewNodeImpl:J,TTSNodeImpl:H,ThinkingStripperNodeImpl:Q,FsReadNodeImpl:X,FsWriteNodeImpl:ve,FsListNodeImpl:Le,TaskCreateNodeImpl:Ce,TaskListNodeImpl:ge,TaskUpdateNodeImpl:Se,SearchIndexNodeImpl:be,WebSearchNodeImpl:ze,ConversationalResponseNodeImpl:Oe,LoopControllerNodeImpl:Ue,ConditionalBranchNodeImpl:ye,ConditionalRouterNodeImpl:Ye,SwitchNodeImpl:qe,ForEachNodeImpl:je,WeightedSamplerNodeImpl:ke,AssociativeChainNodeImpl:et,MemoryFilterNodeImpl:Ne,MemoryRouterNodeImpl:we,JSONParserNodeImpl:xe,TextTemplateNodeImpl:Ee,DataTransformNodeImpl:Y,CacheNodeImpl:ne,PlanParserNodeImpl:Pe,ScratchpadManagerNodeImpl:Je,ErrorRecoveryNodeImpl:_,StuckDetectorNodeImpl:te,BigBrotherNodeImpl:pe,BigBrotherRouterNodeImpl:R,BigBrotherExecutorNodeImpl:N,ClaudeFullTaskNodeImpl:z,MemoryLoaderNodeImpl:fe,MemorySaverNodeImpl:Fe,LLMEnricherNodeImpl:Re,AgentTimerNodeImpl:Xe,CuriosityWeightedSamplerNodeImpl:Ze,CuriosityQuestionGeneratorNodeImpl:dt,CuriosityQuestionSaverNodeImpl:pt,CuriosityActivityCheckNodeImpl:ut,PersonaLoaderNodeImpl:ht,PersonaFormatterNodeImpl:mt,PersonaSaverNodeImpl:gt,TrustLevelReaderNodeImpl:ft,TrustLevelWriterNodeImpl:yt,DecisionRulesLoaderNodeImpl:vt,DecisionRulesSaverNodeImpl:_t,IdentityExtractorNodeImpl:bt,ValueManagerNodeImpl:kt,GoalManagerNodeImpl:wt,ScratchpadInitializerNodeImpl:xt,ScratchpadUpdaterNodeImpl:Et,ThoughtGeneratorNodeImpl:Dt,ThoughtEvaluatorNodeImpl:Tt,ThoughtAggregatorNodeImpl:Nt,LoopMemorySearchNodeImpl:It,AgentTriggerNodeImpl:St,UncuratedMemoryLoaderNodeImpl:Mt,PersonaSummaryLoaderNodeImpl:Ct,CuratorLLMNodeImpl:Ot,CuratedMemorySaverNodeImpl:Lt,TrainingPairGeneratorNodeImpl:jt,TrainingPairAppenderNodeImpl:Rt,MemoryMarkerNodeImpl:At,DreamerMemoryCuratorNodeImpl:zt,DreamerDreamGeneratorNodeImpl:Gt,DreamerDreamSaverNodeImpl:Pt,DreamerContinuationGeneratorNodeImpl:Vt,DreamerLearningsExtractorNodeImpl:Ft,DreamerLearningsWriterNodeImpl:Ht,DesireMemoryAnalyzerNodeImpl:Wt,DesireDetectorNodeImpl:Ut,DesireFolderCreatorNodeImpl:qt,DesireUpdaterNodeImpl:Jt,ConditionalNodeImpl:Bt,ResultAggregatorNodeImpl:Kt}}function ao(o,t){o&&(b=o,at=t),console.log("[CognitiveNodes] Registration starting...",{hasLiteGraph:!!b,hasLGraphNode:!!at,hasRegisterMethod:typeof b?.registerNodeType=="function"});const s=oo(at),e=ro(s);console.log("[CognitiveNodes] Created node implementations:",Object.keys(e).length);try{console.log("[CognitiveNodes] Testing registration with user_input node..."),console.log("[CognitiveNodes] LiteGraph object keys:",Object.keys(b).slice(0,30)),console.log("[CognitiveNodes] Before registration, registered_node_types:",b.registered_node_types),console.log("[CognitiveNodes] registerNodeType function:",b.registerNodeType),b.registerNodeType("cognitive/user_input",e.UserInputNodeImpl),console.log("[CognitiveNodes] After first registration, registered_node_types:",b.registered_node_types),console.log("[CognitiveNodes] Checking LGraphNode.registered_node_types:",at.registered_node_types),console.log("[CognitiveNodes] Checking global LiteGraph:",globalThis.LiteGraph);try{const i=b.createNode("cognitive/user_input");console.log("[CognitiveNodes] Test node creation SUCCESS:",!!i)}catch(i){console.error("[CognitiveNodes] Test node creation FAILED:",i)}b.registerNodeType("cognitive/mic_input",e.MicInputNodeImpl),b.registerNodeType("cognitive/speech_to_text",e.SpeechToTextNodeImpl),b.registerNodeType("cognitive/text_input",e.TextInputNodeImpl),b.registerNodeType("cognitive/session_context",e.SessionContextNodeImpl),b.registerNodeType("cognitive/system_settings",e.SystemSettingsNodeImpl),b.registerNodeType("cognitive/cognitive_mode_router",e.CognitiveModeRouterNodeImpl),b.registerNodeType("cognitive/auth_check",e.AuthCheckNodeImpl),b.registerNodeType("cognitive/operator_eligibility",e.OperatorEligibilityNodeImpl),b.registerNodeType("cognitive/smart_router",e.SmartRouterNodeImpl),b.registerNodeType("cognitive/context_builder",e.ContextBuilderNodeImpl),b.registerNodeType("cognitive/semantic_search",e.SemanticSearchNodeImpl),b.registerNodeType("cognitive/conversation_history",e.ConversationHistoryNodeImpl),b.registerNodeType("cognitive/buffer_manager",e.BufferManagerNodeImpl),b.registerNodeType("cognitive/react_planner",e.ReActPlannerNodeImpl),b.registerNodeType("cognitive/skill_executor",e.SkillExecutorNodeImpl),b.registerNodeType("cognitive/observation_formatter",e.ObservationFormatterNodeImpl),b.registerNodeType("cognitive/completion_checker",e.CompletionCheckerNodeImpl),b.registerNodeType("cognitive/response_synthesizer",e.ResponseSynthesizerNodeImpl),b.registerNodeType("cognitive/iteration_counter",e.IterationCounterNodeImpl),b.registerNodeType("cognitive/scratchpad_completion_checker",e.ScratchpadCompletionCheckerNodeImpl),b.registerNodeType("cognitive/scratchpad_formatter",e.ScratchpadFormatterNodeImpl),b.registerNodeType("cognitive/persona_llm",e.PersonaLLMNodeImpl),b.registerNodeType("cognitive/orchestrator_llm",e.OrchestratorLLMNodeImpl),b.registerNodeType("cognitive/reflector_llm",e.ReflectorLLMNodeImpl),b.registerNodeType("cognitive/cot_stripper",e.ChainOfThoughtStripperNodeImpl),b.registerNodeType("cognitive/safety_validator",e.SafetyValidatorNodeImpl),b.registerNodeType("cognitive/response_refiner",e.ResponseRefinerNodeImpl),b.registerNodeType("cognitive/model_resolver",e.ModelResolverNodeImpl),b.registerNodeType("cognitive/model_router",e.ModelRouterNodeImpl),b.registerNodeType("cognitive/memory_capture",e.MemoryCaptureNodeImpl),b.registerNodeType("cognitive/inner_dialogue_capture",e.InnerDialogueCaptureNodeImpl),b.registerNodeType("cognitive/audit_logger",e.AuditLoggerNodeImpl),b.registerNodeType("cognitive/stream_writer",e.StreamWriterNodeImpl),b.registerNodeType("cognitive/chat_view",e.ChatViewNodeImpl),b.registerNodeType("cognitive/tts",e.TTSNodeImpl),b.registerNodeType("cognitive/thinking_stripper",e.ThinkingStripperNodeImpl),b.registerNodeType("cognitive/skill_fs_read",e.FsReadNodeImpl),b.registerNodeType("cognitive/skill_fs_write",e.FsWriteNodeImpl),b.registerNodeType("cognitive/skill_fs_list",e.FsListNodeImpl),b.registerNodeType("cognitive/skill_task_create",e.TaskCreateNodeImpl),b.registerNodeType("cognitive/skill_task_list",e.TaskListNodeImpl),b.registerNodeType("cognitive/skill_task_update",e.TaskUpdateNodeImpl),b.registerNodeType("cognitive/skill_search_index",e.SearchIndexNodeImpl),b.registerNodeType("cognitive/skill_web_search",e.WebSearchNodeImpl),b.registerNodeType("cognitive/skill_conversational_response",e.ConversationalResponseNodeImpl),b.registerNodeType("cognitive/loop_controller",e.LoopControllerNodeImpl),b.registerNodeType("cognitive/conditional_branch",e.ConditionalBranchNodeImpl),b.registerNodeType("cognitive/conditional_router",e.ConditionalRouterNodeImpl),b.registerNodeType("cognitive/switch",e.SwitchNodeImpl),b.registerNodeType("cognitive/for_each",e.ForEachNodeImpl),b.registerNodeType("cognitive/weighted_sampler",e.WeightedSamplerNodeImpl),b.registerNodeType("cognitive/associative_chain",e.AssociativeChainNodeImpl),b.registerNodeType("cognitive/memory_filter",e.MemoryFilterNodeImpl),b.registerNodeType("cognitive/memory_router",e.MemoryRouterNodeImpl),b.registerNodeType("cognitive/json_parser",e.JSONParserNodeImpl),b.registerNodeType("cognitive/text_template",e.TextTemplateNodeImpl),b.registerNodeType("cognitive/data_transform",e.DataTransformNodeImpl),b.registerNodeType("cognitive/cache",e.CacheNodeImpl),b.registerNodeType("cognitive/plan_parser",e.PlanParserNodeImpl),b.registerNodeType("cognitive/scratchpad_manager",e.ScratchpadManagerNodeImpl),b.registerNodeType("cognitive/error_recovery",e.ErrorRecoveryNodeImpl),b.registerNodeType("cognitive/stuck_detector",e.StuckDetectorNodeImpl),b.registerNodeType("cognitive/big_brother",e.BigBrotherNodeImpl),b.registerNodeType("cognitive/big_brother_router",e.BigBrotherRouterNodeImpl),b.registerNodeType("cognitive/big_brother_executor",e.BigBrotherExecutorNodeImpl),b.registerNodeType("cognitive/claude_full_task",e.ClaudeFullTaskNodeImpl),b.registerNodeType("cognitive/memory_loader",e.MemoryLoaderNodeImpl),b.registerNodeType("cognitive/memory_saver",e.MemorySaverNodeImpl),b.registerNodeType("cognitive/llm_enricher",e.LLMEnricherNodeImpl),b.registerNodeType("cognitive/agent_timer",e.AgentTimerNodeImpl),b.registerNodeType("cognitive/curiosity_weighted_sampler",e.CuriosityWeightedSamplerNodeImpl),b.registerNodeType("cognitive/curiosity_question_generator",e.CuriosityQuestionGeneratorNodeImpl),b.registerNodeType("cognitive/curiosity_question_saver",e.CuriosityQuestionSaverNodeImpl),b.registerNodeType("cognitive/curiosity_activity_check",e.CuriosityActivityCheckNodeImpl),b.registerNodeType("cognitive/persona_loader",e.PersonaLoaderNodeImpl),b.registerNodeType("cognitive/persona_formatter",e.PersonaFormatterNodeImpl),b.registerNodeType("cognitive/persona_saver",e.PersonaSaverNodeImpl),b.registerNodeType("cognitive/trust_level_reader",e.TrustLevelReaderNodeImpl),b.registerNodeType("cognitive/trust_level_writer",e.TrustLevelWriterNodeImpl),b.registerNodeType("cognitive/decision_rules_loader",e.DecisionRulesLoaderNodeImpl),b.registerNodeType("cognitive/decision_rules_saver",e.DecisionRulesSaverNodeImpl),b.registerNodeType("cognitive/identity_extractor",e.IdentityExtractorNodeImpl),b.registerNodeType("cognitive/value_manager",e.ValueManagerNodeImpl),b.registerNodeType("cognitive/goal_manager",e.GoalManagerNodeImpl),b.registerNodeType("cognitive/scratchpad_initializer",e.ScratchpadInitializerNodeImpl),b.registerNodeType("cognitive/scratchpad_updater",e.ScratchpadUpdaterNodeImpl),b.registerNodeType("cognitive/thought_generator",e.ThoughtGeneratorNodeImpl),b.registerNodeType("cognitive/thought_evaluator",e.ThoughtEvaluatorNodeImpl),b.registerNodeType("cognitive/thought_aggregator",e.ThoughtAggregatorNodeImpl),b.registerNodeType("cognitive/loop_memory_search",e.LoopMemorySearchNodeImpl),b.registerNodeType("cognitive/agent_trigger",e.AgentTriggerNodeImpl),b.registerNodeType("cognitive/uncurated_memory_loader",e.UncuratedMemoryLoaderNodeImpl),b.registerNodeType("cognitive/persona_summary_loader",e.PersonaSummaryLoaderNodeImpl),b.registerNodeType("cognitive/curator_llm",e.CuratorLLMNodeImpl),b.registerNodeType("cognitive/curated_memory_saver",e.CuratedMemorySaverNodeImpl),b.registerNodeType("cognitive/training_pair_generator",e.TrainingPairGeneratorNodeImpl),b.registerNodeType("cognitive/training_pair_appender",e.TrainingPairAppenderNodeImpl),b.registerNodeType("cognitive/memory_marker",e.MemoryMarkerNodeImpl),b.registerNodeType("agency/desire_memory_analyzer",e.DesireMemoryAnalyzerNodeImpl),b.registerNodeType("agency/desire_detector",e.DesireDetectorNodeImpl),b.registerNodeType("agency/desire_folder_creator",e.DesireFolderCreatorNodeImpl),b.registerNodeType("agency/desire_updater",e.DesireUpdaterNodeImpl),b.registerNodeType("control/conditional",e.ConditionalNodeImpl),b.registerNodeType("output/result_aggregator",e.ResultAggregatorNodeImpl),console.log("[CognitiveNodes] Registration completed successfully")}catch(i){throw console.error("[CognitiveNodes] Registration error:",i),i}const r=b?.registered_node_types||at?.registered_node_types||globalThis.LiteGraph?.registered_node_types,n=r?Object.keys(r).filter(i=>i.startsWith("cognitive/")):[];console.log("[CognitiveNodes] Registry location:",{onLiteGraph:!!b?.registered_node_types,onLGraphNode:!!at?.registered_node_types,onGlobal:!!globalThis.LiteGraph?.registered_node_types}),console.log("[CognitiveNodes] Registered",n.length,"node types"),console.log("[CognitiveNodes] Sample registered types:",n.slice(0,10))}function io(){return C.map(o=>{let t="cognitive";return o.category==="agency"?t="agency":o.category==="control_flow"&&o.id==="conditional"?t="control":o.category==="output"&&o.id==="result_aggregator"&&(t="output"),{id:o.id,type:`${t}/${o.id}`,name:o.name,category:o.category,description:o.description,color:o.color,bgColor:o.bgColor}})}class no{graph;activeNodes=new Set;completedNodes=new Set;failedNodes=new Set;constructor(t){this.graph=t}handleEvent(t){const{type:s,nodeId:e}=t;if(!e)return;const r=this.graph.getNodeById(e);if(r)switch(s){case"node_start":this.activeNodes.add(e),this.highlightNode(r,"running");break;case"node_complete":this.activeNodes.delete(e),this.completedNodes.add(e),this.highlightNode(r,"completed");break;case"node_error":this.activeNodes.delete(e),this.failedNodes.add(e),this.highlightNode(r,"failed");break;case"graph_complete":this.reset();break}}highlightNode(t,s){switch(s){case"running":t.boxcolor="#fbbf24",t.color="#92400e";break;case"completed":t.boxcolor="#22c55e",t.color="#166534",setTimeout(()=>{this.completedNodes.has(t.id)&&(t.boxcolor=null,t.color=null)},2e3);break;case"failed":t.boxcolor="#ef4444",t.color="#991b1b";break}}reset(){this.activeNodes.clear(),this.completedNodes.clear(),this.failedNodes.clear(),this.graph._nodes.forEach(t=>{t.boxcolor=null,t.color=null})}getStats(){return{active:this.activeNodes.size,completed:this.completedNodes.size,failed:this.failedNodes.size,total:this.graph._nodes.length}}}function lo(o){let t,s;return{c(){t=x("div"),s=x("canvas"),this.h()},l(e){t=w(e,"DIV",{class:!0});var r=M(t);s=w(r,"CANVAS",{class:!0}),M(s).forEach(u),r.forEach(u),this.h()},h(){l(s,"class","svelte-129sz5j"),l(t,"class","node-editor-container svelte-129sz5j")},m(e,r){B(e,t,r),d(t,s),o[13](s)},p:He,i:He,o:He,d(e){e&&u(t),o[13](null)}}}function co(o,t,s){let e,r,n,i=null,c=!1,m="",h=null,g=!0,D,f,v,p,{graphData:y=null}=t,{onExecute:R=null}=t,{cognitiveMode:N=null}=t;async function z(){try{let j;if(N)j=N,console.log(`[NodeEditor] Using passed cognitive mode: ${j}`);else{const{apiFetch:U}=await Ve(async()=>{const{apiFetch:he}=await import("./api-config.B-uR5Kyo.js").then(se=>se.au);return{apiFetch:he}},[]),ee=await U("/api/cognitive-mode");if(!ee.ok){console.warn("[NodeEditor] Could not fetch cognitive mode, using dual-mode"),await I("dual-mode");return}j=(await ee.json()).currentMode||"dual",console.log(`[NodeEditor] Fetched cognitive mode from API: ${j}`)}const W=`${j}-mode`;await I(W)}catch(j){console.error("[NodeEditor] Error loading cognitive template:",j),O()}}async function I(j){try{const{loadTemplateAsGraph:W}=await Ve(async()=>{const{loadTemplateAsGraph:ee}=await Promise.resolve().then(()=>gs);return{loadTemplateAsGraph:ee}},void 0),U=await W(j);if(U){console.log(`[NodeEditor] Loading template: ${j}`);const ee=Array.isArray(U.links)?[...U.links]:[],$=new Map;Array.isArray(U.nodes)&&U.nodes.forEach(ie=>{$.set(ie.id,{type:ie.type,pos:ie.pos,title:ie.title})}),console.log(`[NodeEditor] Saved ${ee.length} links, ${$.size} node mappings before configure`),r.configure(U);const he=new Map,se=r._nodes||[];$.forEach((ie,le)=>{let ce=r.getNodeById(le);ce||(ce=se.find(ve=>ve.type===ie.type&&ve.pos&&ie.pos&&Math.abs(ve.pos[0]-ie.pos[0])<1&&Math.abs(ve.pos[1]-ie.pos[1])<1)),ce&&he.set(le,ce)}),console.log(`[NodeEditor] Mapped ${he.size}/${$.size} nodes`),console.log(`[NodeEditor] Manually connecting ${ee.length} links...`);let _e=0;ee.forEach(ie=>{const[le,ce,ve,Le,Ce]=ie,Se=he.get(ce),be=he.get(Le);if(Se&&be)try{Se.connect(ve,be,Ce),_e++}catch(ze){console.warn(`[NodeEditor] Failed to connect link ${le}:`,ze)}else console.warn(`[NodeEditor] Skipping link ${le} - nodes not found (origin: ${!!Se}, target: ${!!be}), originalIds: ${ce} -> ${Le}`)}),console.log(`[NodeEditor] Template loaded. Nodes: ${se.length}, Connected: ${_e}/${ee.length} links`),n&&(n.setDirty(!0,!0),r.setDirtyCanvas(!0,!0),console.log("[NodeEditor] Forced canvas redraw to show connections"))}else console.warn(`[NodeEditor] Template ${j} not found, creating default graph`),O()}catch(W){console.error(`[NodeEditor] Error loading template ${j}:`,W),O()}}Ws(async()=>{const j=await Ve(()=>import("./litegraph.module.Dbb-6bXk.js"),[]);console.log("[NodeEditor] Raw litegraph module:",{keys:Object.keys(j).slice(0,20),hasLITEGRAPH:"LITEGRAPH"in j,hasDefault:"default"in j,LITEGRAPHtype:typeof j.LITEGRAPH,defaultType:typeof j.default});const W=j?.LITEGRAPH||j?.default||j;if(console.log("[NodeEditor] Selected lgModule:",{type:typeof W,keys:Object.keys(W).slice(0,30),hasRegisterNodeType:typeof W.registerNodeType,hasRegisteredNodeTypes:"registered_node_types"in W}),p=W,D=W?.LGraph,f=W?.LGraphCanvas,v=W?.LGraphNode,console.log("[NodeEditor] LiteGraph loaded:",{hasLiteGraph:!!p,hasLGraph:!!D,hasLGraphCanvas:!!f,hasLGraphNode:!!v}),!D||!f||!v){console.error("[NodeEditor] Failed to load LiteGraph classes!",{LGraph:!!D,LGraphCanvas:!!f,LGraphNode:!!v});return}console.log("[NodeEditor] About to register nodes. LiteGraph object:",{type:typeof p,hasRegisterMethod:typeof p?.registerNodeType,registeredTypes:p?.registered_node_types?Object.keys(p.registered_node_types).length:"N/A",keys:Object.keys(p).slice(0,20)});try{ao(p,v),console.log("[NodeEditor] Registration completed. Registered types:",p?.registered_node_types?Object.keys(p.registered_node_types).length:"N/A")}catch(U){console.error("[NodeEditor] Registration failed:",U)}if(typeof p.getNodeTypesCategories!="function"||typeof globalThis.getNodeTypesCategories!="function"){const U=()=>{const ee=new Set,$=p?.registered_node_types||{};return Object.values($).forEach(he=>{const se=he?.prototype?.category||"misc";ee.add(se)}),Array.from(ee)};p.getNodeTypesCategories=U,globalThis.getNodeTypesCategories=U}r=new D,r.runningtime=0,typeof r.setSupportForUndo=="function"&&r.setSupportForUndo(!0),n=new f(e,r),n.background_image=null,n.render_shadows=!1,n.render_canvas_border=!1,n.clear_background=!0,n.clear_background_color="#0a0a0a",n.allow_searchbox=!0,n.show_info=!0,n.allow_dragcanvas=!0,n.allow_dragnodes=!0,n.allow_interaction=!0,y?(r.configure(y),n&&(n.setDirty(!0,!0),r.setDirtyCanvas(!0,!0),console.log("[NodeEditor] Forced canvas redraw after initial graph load"))):await z(),i=new no(r),g&&k(),S(),window.addEventListener("resize",S)});function k(){try{h=new EventSource("/api/template-watch"),h.addEventListener("connected",j=>{const W=JSON.parse(j.data);console.log("[NodeEditor] Template watcher connected:",W.clientId)}),h.addEventListener("template-changed",async j=>{const W=JSON.parse(j.data);console.log("[NodeEditor] Template changed:",W.templateName),g&&(console.log("[NodeEditor] Auto-reloading template..."),await Q()&&console.log("[NodeEditor] Template auto-reloaded successfully!"))}),h.onerror=j=>{console.error("[NodeEditor] Template watcher error:",j),setTimeout(()=>{h&&h.close(),g&&k()},5e3)}}catch(j){console.error("[NodeEditor] Failed to setup template watcher:",j)}}Us(()=>{r&&r.stop(),h&&(h.close(),h=null),window.removeEventListener("resize",S)});function S(){if(e&&e.parentElement){const j=e.parentElement,W=window.devicePixelRatio||1;s(0,e.style.width=j.clientWidth+"px",e),s(0,e.style.height=j.clientHeight+"px",e),s(0,e.width=j.clientWidth*W,e),s(0,e.height=j.clientHeight*W,e),n&&n.resize()}}function O(){if(!p||!r){console.error("[NodeEditor] Cannot create default graph: LiteGraph or graph not initialized");return}console.log("[NodeEditor] Creating default graph...");try{const j=p.createNode("cognitive/user_input");if(!j){console.error("[NodeEditor] Failed to create user_input node - node type not registered?");return}j.pos=[50,100],r.add(j);const W=p.createNode("cognitive/system_settings");W.pos=[50,250],r.add(W);const U=p.createNode("cognitive/cognitive_mode_router");U.pos=[350,150],r.add(U);const ee=p.createNode("cognitive/skill_conversational_response");ee.pos=[650,100],r.add(ee);const $=p.createNode("cognitive/stream_writer");$.pos=[950,100],r.add($),j.connect(0,U,1),W.connect(0,U,0),ee.connect(0,$,0),n&&n.ds&&(n.ds.offset=[-100,-50],n.ds.scale=1),console.log("[NodeEditor] Default graph created successfully")}catch(j){console.error("[NodeEditor] Error creating default graph:",j)}}function T(){return r?r.serialize():null}function G(j){if(r&&j){const W=Array.isArray(j.links)?[...j.links]:[],U=new Map;Array.isArray(j.nodes)&&j.nodes.forEach(se=>{U.set(se.id,{type:se.type,pos:se.pos,title:se.title})}),console.log(`[NodeEditor] loadGraph: Saved ${W.length} links, ${U.size} node mappings before configure`),r.configure(j);const ee=new Map,$=r._nodes||[];U.forEach((se,_e)=>{let ie=r.getNodeById(_e);ie||(ie=$.find(le=>le.type===se.type&&le.pos&&se.pos&&Math.abs(le.pos[0]-se.pos[0])<1&&Math.abs(le.pos[1]-se.pos[1])<1)),ie&&ee.set(_e,ie)}),console.log(`[NodeEditor] loadGraph: Mapped ${ee.size}/${U.size} nodes`),console.log(`[NodeEditor] loadGraph: Manually connecting ${W.length} links...`);let he=0;W.forEach((se,_e)=>{const[ie,le,ce,ve,Le]=se,Ce=ee.get(le),Se=ee.get(ve);if(Ce&&Se)try{Ce.connect(ce,Se,Le),he++}catch(be){console.warn(`[NodeEditor] loadGraph: Failed to connect link ${ie}:`,be)}else console.warn(`[NodeEditor] loadGraph: Skipping link ${ie} - nodes not found (origin: ${!!Ce}, target: ${!!Se}), originalIds: ${le} -> ${ve}`)}),console.log(`[NodeEditor] loadGraph: Connected ${he}/${W.length} links`),n&&(n.setDirty(!0,!0),r.setDirtyCanvas(!0,!0),console.log("[NodeEditor] Forced canvas redraw after loadGraph"))}}function A(){r&&r.clear()}async function J(j={}){if(!r)throw new Error("Graph not initialized");c=!0,m="";try{const{executeGraph:W}=await Ve(async()=>{const{executeGraph:$}=await import("@metahuman/core/graph-executor");return{executeGraph:$}},[]),U=r.serialize(),ee={version:"1.0",name:"Current Graph",description:"Executing current graph",nodes:U.nodes.map($=>({id:$.id,type:$.type.replace("cognitive/",""),pos:$.pos,properties:$.properties||{}})),links:U.links.map($=>({id:$.id,origin_id:$.origin_id,origin_slot:$.origin_slot,target_id:$.target_id,target_slot:$.target_slot}))};await W(ee,j,$=>{i&&i.handleEvent($),n&&n.setDirty(!0,!0)}),console.log("[NodeEditor] Graph execution completed")}catch(W){throw m=W.message,console.error("[NodeEditor] Execution error:",W),W}finally{c=!1}}function H(){return{isExecuting:c,error:m,stats:i?.getStats()||null}}async function Q(){if(!r)return console.error("[NodeEditor] Cannot reload: graph not initialized"),!1;try{const{apiFetch:j}=await Ve(async()=>{const{apiFetch:ce}=await import("./api-config.B-uR5Kyo.js").then(ve=>ve.au);return{apiFetch:ce}},[]),$=`${(await(await j("/api/cognitive-mode")).json()).currentMode||"dual"}-mode`;console.log(`[NodeEditor] Reloading template: ${$}`);const he=await j(`/api/template/${$}`);if(!he.ok)throw new Error(`Failed to fetch template: ${he.statusText}`);const se=await he.json();if(!se.success||!se.template)throw new Error("Invalid template response");const{templateToLiteGraph:_e}=await Ve(async()=>{const{templateToLiteGraph:ce}=await Promise.resolve().then(()=>gs);return{templateToLiteGraph:ce}},void 0),ie=_e(se.template);if(!ie)throw new Error("Failed to convert template");console.log("[NodeEditor] Template reloaded, clearing graph..."),r.clear();const le=Array.isArray(ie.links)?[...ie.links]:[];return r.configure(ie),le.forEach(ce=>{const[ve,Le,Ce,Se,be]=ce,ze=r.getNodeById(Le),Ue=r.getNodeById(Se);if(ze&&Ue)try{ze.connect(Ce,Ue,be)}catch(ye){console.warn(`[NodeEditor] Failed to reconnect link ${ve}:`,ye)}}),n&&(n.setDirty(!0,!0),r.setDirtyCanvas(!0,!0),console.log("[NodeEditor] Forced canvas redraw after template reload")),console.log("[NodeEditor] Template reloaded successfully!"),!0}catch(j){return console.error("[NodeEditor] Error reloading template:",j),!1}}function X(j){g=j,j&&!h?k():!j&&h&&(h.close(),h=null),console.log(`[NodeEditor] Auto-reload ${j?"enabled":"disabled"}`)}function ge(){return g}function Oe(j){if(console.log("[NodeEditor] addNode called with:",j),!r){console.error("[NodeEditor] Cannot add node: graph not initialized");return}console.log("[NodeEditor] Testing createNode with user_input...");try{const W=p.createNode("cognitive/user_input");if(console.log("[NodeEditor] Test createNode result:",!!W,W?.constructor?.name),W){console.log("[NodeEditor] Test succeeded! Now trying requested type:",j);const U=p.createNode(j);if(console.log("[NodeEditor] Requested createNode result:",!!U,U?.constructor?.name),U){const ee=Math.floor(Math.random()*50);U.pos=[100+ee,100+ee],console.log("[NodeEditor] Adding node to graph at position:",U.pos),r.add(U),console.log(`[NodeEditor] Successfully added node: ${j}`),n&&n.setDirty(!0,!0)}else console.error("[NodeEditor] createNode returned null/undefined for:",j)}else console.error("[NodeEditor] Even test node (user_input) failed to create!")}catch(W){console.error(`[NodeEditor] Failed to create node ${j}:`,W)}}function Ie(j){Qt[j?"unshift":"push"](()=>{e=j,s(0,e)})}return o.$$set=j=>{"graphData"in j&&s(1,y=j.graphData),"onExecute"in j&&s(2,R=j.onExecute),"cognitiveMode"in j&&s(3,N=j.cognitiveMode)},[e,y,R,N,T,G,A,J,H,Q,X,ge,Oe,Ie]}class po extends Yt{constructor(t){super(),Xt(this,t,co,lo,Zt,{graphData:1,onExecute:2,cognitiveMode:3,exportGraph:4,loadGraph:5,clearGraph:6,executeGraph:7,getExecutionStatus:8,reloadTemplate:9,setAutoReload:10,isAutoReloadEnabled:11,addNode:12},null,[-1,-1])}get exportGraph(){return this.$$.ctx[4]}get loadGraph(){return this.$$.ctx[5]}get clearGraph(){return this.$$.ctx[6]}get executeGraph(){return this.$$.ctx[7]}get getExecutionStatus(){return this.$$.ctx[8]}get reloadTemplate(){return this.$$.ctx[9]}get setAutoReload(){return this.$$.ctx[10]}get isAutoReloadEnabled(){return this.$$.ctx[11]}get addNode(){return this.$$.ctx[12]}}function ls(o,t,s){const e=o.slice();return e[17]=t[s].category,e[18]=t[s].nodes,e}function cs(o,t,s){const e=o.slice();return e[21]=t[s],e}function uo(o){let t,s='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg> <span class="expand-text svelte-1a10u8t">Nodes</span>',e,r;return{c(){t=x("button"),t.innerHTML=s,this.h()},l(n){t=w(n,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),de(t)!=="svelte-1if8p20"&&(t.innerHTML=s),this.h()},h(){l(t,"class","expand-button svelte-1a10u8t"),l(t,"title","Expand node palette")},m(n,i){B(n,t,i),e||(r=ae(t,"click",o[13]),e=!0)},p:He,d(n){n&&u(t),e=!1,r()}}}function ho(o){let t,s,e='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg> <span>Node Palette</span>',r,n,i='<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>',c,m,h,g,D,f,v,p,y,R,N,z,I=o[1]&&ds(o),k=Ge(o[3]),S=[];for(let T=0;T<k.length;T+=1)S[T]=hs(ls(o,k,T));let O=o[3].length===0&&ms();return{c(){t=x("div"),s=x("div"),s.innerHTML=e,r=F(),n=x("button"),n.innerHTML=i,c=F(),m=x("div"),h=Te("svg"),g=Te("path"),D=F(),f=x("input"),v=F(),I&&I.c(),p=F(),y=x("div");for(let T=0;T<S.length;T+=1)S[T].c();R=F(),O&&O.c(),this.h()},l(T){t=w(T,"DIV",{class:!0});var G=M(t);s=w(G,"DIV",{class:!0,"data-svelte-h":!0}),de(s)!=="svelte-5fnsr3"&&(s.innerHTML=e),r=V(G),n=w(G,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),de(n)!=="svelte-ztpuc6"&&(n.innerHTML=i),G.forEach(u),c=V(T),m=w(T,"DIV",{class:!0});var A=M(m);h=De(A,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var J=M(h);g=De(J,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),M(g).forEach(u),J.forEach(u),D=V(A),f=w(A,"INPUT",{type:!0,placeholder:!0,class:!0}),v=V(A),I&&I.l(A),A.forEach(u),p=V(T),y=w(T,"DIV",{class:!0});var H=M(y);for(let Q=0;Q<S.length;Q+=1)S[Q].l(H);R=V(H),O&&O.l(H),H.forEach(u),this.h()},h(){l(s,"class","palette-title svelte-1a10u8t"),l(n,"class","collapse-button svelte-1a10u8t"),l(n,"title","Collapse palette"),l(t,"class","palette-header svelte-1a10u8t"),l(g,"stroke-linecap","round"),l(g,"stroke-linejoin","round"),l(g,"stroke-width","2"),l(g,"d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"),l(h,"class","w-4 h-4"),l(h,"fill","none"),l(h,"stroke","currentColor"),l(h,"viewBox","0 0 24 24"),l(f,"type","text"),l(f,"placeholder","Search nodes..."),l(f,"class","search-input svelte-1a10u8t"),l(m,"class","search-box svelte-1a10u8t"),l(y,"class","categories-list svelte-1a10u8t")},m(T,G){B(T,t,G),d(t,s),d(t,r),d(t,n),B(T,c,G),B(T,m,G),d(m,h),d(h,g),d(m,D),d(m,f),ct(f,o[1]),d(m,v),I&&I.m(m,null),B(T,p,G),B(T,y,G);for(let A=0;A<S.length;A+=1)S[A]&&S[A].m(y,null);d(y,R),O&&O.m(y,null),N||(z=[ae(n,"click",o[8]),ae(f,"input",o[9])],N=!0)},p(T,G){if(G&2&&f.value!==T[1]&&ct(f,T[1]),T[1]?I?I.p(T,G):(I=ds(T),I.c(),I.m(m,null)):I&&(I.d(1),I=null),G&124){k=Ge(T[3]);let A;for(A=0;A<k.length;A+=1){const J=ls(T,k,A);S[A]?S[A].p(J,G):(S[A]=hs(J),S[A].c(),S[A].m(y,R))}for(;A<S.length;A+=1)S[A].d(1);S.length=k.length}T[3].length===0?O||(O=ms(),O.c(),O.m(y,null)):O&&(O.d(1),O=null)},d(T){T&&(u(t),u(c),u(m),u(p),u(y)),I&&I.d(),rt(S,T),O&&O.d(),N=!1,it(z)}}}function ds(o){let t,s='<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',e,r;return{c(){t=x("button"),t.innerHTML=s,this.h()},l(n){t=w(n,"BUTTON",{class:!0,"data-svelte-h":!0}),de(t)!=="svelte-90nofe"&&(t.innerHTML=s),this.h()},h(){l(t,"class","clear-search svelte-1a10u8t")},m(n,i){B(n,t,i),e||(r=ae(t,"click",o[10]),e=!0)},p:He,d(n){n&&u(t),e=!1,r()}}}function ps(o){let t,s=Ge(o[18]),e=[];for(let r=0;r<s.length;r+=1)e[r]=us(cs(o,s,r));return{c(){t=x("div");for(let r=0;r<e.length;r+=1)e[r].c();this.h()},l(r){t=w(r,"DIV",{class:!0});var n=M(t);for(let i=0;i<e.length;i+=1)e[i].l(n);n.forEach(u),this.h()},h(){l(t,"class","nodes-list svelte-1a10u8t")},m(r,n){B(r,t,n);for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(t,null)},p(r,n){if(n&72){s=Ge(r[18]);let i;for(i=0;i<s.length;i+=1){const c=cs(r,s,i);e[i]?e[i].p(c,n):(e[i]=us(c),e[i].c(),e[i].m(t,null))}for(;i<e.length;i+=1)e[i].d(1);e.length=s.length}},d(r){r&&u(t),rt(e,r)}}}function us(o){let t,s,e,r,n,i=o[21].name+"",c,m,h,g=o[21].description+"",D,f,v,p;function y(){return o[12](o[21])}return{c(){t=x("button"),s=x("div"),e=F(),r=x("div"),n=x("div"),c=re(i),m=F(),h=x("div"),D=re(g),this.h()},l(R){t=w(R,"BUTTON",{class:!0,title:!0,style:!0});var N=M(t);s=w(N,"DIV",{class:!0,style:!0}),M(s).forEach(u),e=V(N),r=w(N,"DIV",{class:!0});var z=M(r);n=w(z,"DIV",{class:!0});var I=M(n);c=oe(I,i),I.forEach(u),m=V(z),h=w(z,"DIV",{class:!0});var k=M(h);D=oe(k,g),k.forEach(u),z.forEach(u),N.forEach(u),this.h()},h(){l(s,"class","node-color-bar svelte-1a10u8t"),ot(s,"background",o[21].color),l(n,"class","node-name svelte-1a10u8t"),l(h,"class","node-description svelte-1a10u8t"),l(r,"class","node-info svelte-1a10u8t"),l(t,"class","node-item svelte-1a10u8t"),l(t,"title",f=o[21].description),ot(t,"--node-color",o[21].color),ot(t,"--node-bg",o[21].bgColor)},m(R,N){B(R,t,N),d(t,s),d(t,e),d(t,r),d(r,n),d(n,c),d(r,m),d(r,h),d(h,D),v||(p=ae(t,"click",y),v=!0)},p(R,N){o=R,N&8&&ot(s,"background",o[21].color),N&8&&i!==(i=o[21].name+"")&&me(c,i),N&8&&g!==(g=o[21].description+"")&&me(D,g),N&8&&f!==(f=o[21].description)&&l(t,"title",f),N&8&&ot(t,"--node-color",o[21].color),N&8&&ot(t,"--node-bg",o[21].bgColor)},d(R){R&&u(t),v=!1,p()}}}function hs(o){let t,s,e,r,n,i,c=(o[4][o[17]]?.icon||"📦")+"",m,h,g,D=(o[4][o[17]]?.name||o[17])+"",f,v,p,y=o[18].length+"",R,N,z=o[2].has(o[17]),I,k;function S(){return o[11](o[17])}let O=z&&ps(o);return{c(){t=x("div"),s=x("button"),e=Te("svg"),r=Te("path"),n=F(),i=x("span"),m=re(c),h=F(),g=x("span"),f=re(D),v=F(),p=x("span"),R=re(y),N=F(),O&&O.c(),this.h()},l(T){t=w(T,"DIV",{class:!0});var G=M(t);s=w(G,"BUTTON",{class:!0});var A=M(s);e=De(A,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var J=M(e);r=De(J,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),M(r).forEach(u),J.forEach(u),n=V(A),i=w(A,"SPAN",{class:!0});var H=M(i);m=oe(H,c),H.forEach(u),h=V(A),g=w(A,"SPAN",{class:!0});var Q=M(g);f=oe(Q,D),Q.forEach(u),v=V(A),p=w(A,"SPAN",{class:!0});var X=M(p);R=oe(X,y),X.forEach(u),A.forEach(u),N=V(G),O&&O.l(G),G.forEach(u),this.h()},h(){l(r,"stroke-linecap","round"),l(r,"stroke-linejoin","round"),l(r,"stroke-width","2"),l(r,"d","M9 5l7 7-7 7"),l(e,"class","w-4 h-4 chevron svelte-1a10u8t"),l(e,"fill","none"),l(e,"stroke","currentColor"),l(e,"viewBox","0 0 24 24"),Ke(e,"expanded",o[2].has(o[17])),l(i,"class","category-icon svelte-1a10u8t"),l(g,"class","category-name svelte-1a10u8t"),l(p,"class","category-count svelte-1a10u8t"),l(s,"class","category-header svelte-1a10u8t"),l(t,"class","category svelte-1a10u8t")},m(T,G){B(T,t,G),d(t,s),d(s,e),d(e,r),d(s,n),d(s,i),d(i,m),d(s,h),d(s,g),d(g,f),d(s,v),d(s,p),d(p,R),d(t,N),O&&O.m(t,null),I||(k=ae(s,"click",S),I=!0)},p(T,G){o=T,G&12&&Ke(e,"expanded",o[2].has(o[17])),G&8&&c!==(c=(o[4][o[17]]?.icon||"📦")+"")&&me(m,c),G&8&&D!==(D=(o[4][o[17]]?.name||o[17])+"")&&me(f,D),G&8&&y!==(y=o[18].length+"")&&me(R,y),G&12&&(z=o[2].has(o[17])),z?O?O.p(o,G):(O=ps(o),O.c(),O.m(t,null)):O&&(O.d(1),O=null)},d(T){T&&u(t),O&&O.d(),I=!1,k()}}}function ms(o){let t,s='<svg class="w-8 h-8 svelte-1a10u8t" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <p class="svelte-1a10u8t">No nodes found</p> <p class="hint svelte-1a10u8t">Try a different search term</p>';return{c(){t=x("div"),t.innerHTML=s,this.h()},l(e){t=w(e,"DIV",{class:!0,"data-svelte-h":!0}),de(t)!=="svelte-sl17u0"&&(t.innerHTML=s),this.h()},h(){l(t,"class","no-results svelte-1a10u8t")},m(e,r){B(e,t,r)},d(e){e&&u(t)}}}function mo(o){let t;function s(n,i){return n[0]?uo:ho}let e=s(o),r=e(o);return{c(){t=x("div"),r.c(),this.h()},l(n){t=w(n,"DIV",{class:!0});var i=M(t);r.l(i),i.forEach(u),this.h()},h(){l(t,"class","node-palette svelte-1a10u8t"),Ke(t,"collapsed",o[0])},m(n,i){B(n,t,i),r.m(t,null)},p(n,[i]){e===(e=s(n))&&r?r.p(n,i):(r.d(1),r=e(n),r&&(r.c(),r.m(t,null))),i&1&&Ke(t,"collapsed",n[0])},i:He,o:He,d(n){n&&u(t),r.d()}}}function go(o,t,s){let e,{onNodeSelected:r}=t,{collapsed:n=!1}=t,i="",c=new Set(["input","output"]);const h=io().reduce((k,S)=>(k[S.category]||(k[S.category]=[]),k[S.category].push(S),k),{}),g={input:{name:"Input",icon:"📥",order:1},router:{name:"Router",icon:"🔀",order:2},context:{name:"Context",icon:"📚",order:3},operator:{name:"Operator",icon:"⚙️",order:4},chat:{name:"Chat",icon:"💬",order:5},model:{name:"Model",icon:"🤖",order:6},skill:{name:"Skill",icon:"🔧",order:7},output:{name:"Output",icon:"📤",order:8}},D=Object.keys(h).sort((k,S)=>(g[k]?.order||99)-(g[S]?.order||99));function f(k){c.has(k)?c.delete(k):c.add(k),s(2,c)}function v(k){console.log("[NodePalette] Node clicked:",k);const S=`cognitive/${k}`;console.log("[NodePalette] Calling onNodeSelected with:",S),r(S)}const p=()=>s(0,n=!0);function y(){i=this.value,s(1,i)}const R=()=>s(1,i=""),N=k=>f(k),z=k=>v(k.id),I=()=>s(0,n=!1);return o.$$set=k=>{"onNodeSelected"in k&&s(7,r=k.onNodeSelected),"collapsed"in k&&s(0,n=k.collapsed)},o.$$.update=()=>{o.$$.dirty&2&&s(3,e=D.map(k=>({category:k,nodes:h[k].filter(S=>S.name.toLowerCase().includes(i.toLowerCase())||S.description.toLowerCase().includes(i.toLowerCase()))})).filter(k=>k.nodes.length>0))},[n,i,c,e,g,f,v,r,p,y,R,N,z,I]}class fo extends Yt{constructor(t){super(),Xt(this,t,go,mo,Zt,{onNodeSelected:7,collapsed:0})}}const $t=new Map;async function qs(o){if($t.has(o))return $t.get(o);try{const t=await Be(`/api/cognitive-graph?name=${encodeURIComponent(o)}`);if(!t.ok)return console.error(`Failed to fetch template ${o}: ${t.status}`),null;const e=(await t.json()).graph;return e&&$t.set(o,e),e}catch(t){return console.error(`Error fetching template ${o}:`,t),null}}async function Js(o){return await qs(o)}async function Bs(){try{const o=await Be("/api/cognitive-graphs");return o.ok?((await o.json()).graphs||[]).filter(e=>e.scope==="builtin").map(e=>({id:e.name,name:e.title||e.name,description:e.description||""})):(console.error("Failed to fetch graphs list:",o.status),[{id:"dual-mode",name:"Dual Consciousness Mode",description:"Full operator pipeline with ReAct loop"},{id:"agent-mode",name:"Agent Mode",description:"Conditional routing (chat vs operator)"},{id:"emulation-mode",name:"Emulation Mode",description:"Simple chat-only pipeline"}])}catch(o){return console.error("Error fetching templates:",o),[{id:"dual-mode",name:"Dual Consciousness Mode",description:"Full operator pipeline with ReAct loop"},{id:"agent-mode",name:"Agent Mode",description:"Conditional routing (chat vs operator)"},{id:"emulation-mode",name:"Emulation Mode",description:"Simple chat-only pipeline"}]}}function Ks(o){const t=(o.links||[]).map(i=>{if(Array.isArray(i)){const[c,m,h,g,D,f]=i;return{id:c,origin_id:m,origin_slot:h,target_id:g,target_slot:D,type:f}}return i}),s=new Map;o.nodes.forEach(i=>{const c={...i,inputs:void 0,outputs:void 0};s.set(i.id,c)});const e=t.map(i=>[i.id,i.origin_id,i.origin_slot,i.target_id,i.target_slot,i.type||null]),r=o.nodes.map(i=>s.get(i.id));r.length>0&&(console.log("[TemplateLoader] Sample node after processing:",r[0]),console.log("[TemplateLoader] Total nodes:",r.length,"Total links:",e.length));const n={last_node_id:Math.max(...o.nodes.map(i=>i.id),0),last_link_id:t.length?Math.max(...t.map(i=>i.id||0)):0,nodes:r,links:e,groups:o.groups||[],config:o.config||{},extra:o.extra||{},version:.4};return console.log("[TemplateLoader] Converted template:",{nodeCount:n.nodes.length,linkCount:n.links.length,firstNodeHasInputs:n.nodes[0]?.inputs?.length>0,firstNodeHasOutputs:n.nodes[0]?.outputs?.length>0}),n}async function $s(o){const t=await Js(o);return t?Ks(t):null}const gs=Object.freeze(Object.defineProperty({__proto__:null,fetchTemplate:qs,getTemplate:Js,listTemplates:Bs,loadTemplateAsGraph:$s,templateToLiteGraph:Ks},Symbol.toStringTag,{value:"Module"}));function fs(o,t,s){const e=o.slice();return e[62]=t[s],e}function ys(o,t,s){const e=o.slice();return e[65]=t[s],e}function vs(o,t,s){const e=o.slice();return e[65]=t[s],e}function _s(o,t,s){const e=o.slice();return e[65]=t[s],e}function bs(o,t,s){const e=o.slice();return e[72]=t[s],e}function ks(o){let t,s,e="Saved Graphs",r,n,i,c,m,h,g,D,f,v="Cognitive Modes",p,y=o[17].has("cognitive-modes"),R,N,z,I;function k(J,H){return J[4]?bo:J[5]?_o:J[3].length===0?vo:yo}let S=k(o),O=S(o),T=y&&Ds(o),G=o[20].agentWorkflows.length>0&&Ns(o),A=o[20].legacyWorkflows.length>0&&Ms(o);return{c(){t=x("div"),s=x("div"),s.textContent=e,r=F(),O.c(),n=F(),i=x("div"),c=F(),m=x("button"),h=Te("svg"),g=Te("path"),D=F(),f=x("span"),f.textContent=v,p=F(),T&&T.c(),R=F(),G&&G.c(),N=F(),A&&A.c(),this.h()},l(J){t=w(J,"DIV",{class:!0});var H=M(t);s=w(H,"DIV",{class:!0,"data-svelte-h":!0}),de(s)!=="svelte-voyfe6"&&(s.textContent=e),r=V(H),O.l(H),n=V(H),i=w(H,"DIV",{class:!0}),M(i).forEach(u),c=V(H),m=w(H,"BUTTON",{class:!0});var Q=M(m);h=De(Q,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var X=M(h);g=De(X,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),M(g).forEach(u),X.forEach(u),D=V(Q),f=w(Q,"SPAN",{"data-svelte-h":!0}),de(f)!=="svelte-gx0802"&&(f.textContent=v),Q.forEach(u),p=V(H),T&&T.l(H),R=V(H),G&&G.l(H),N=V(H),A&&A.l(H),H.forEach(u),this.h()},h(){l(s,"class","dropdown-header svelte-d1addp"),l(i,"class","dropdown-divider svelte-d1addp"),l(g,"stroke-linecap","round"),l(g,"stroke-linejoin","round"),l(g,"stroke-width","2"),l(g,"d","M9 5l7 7-7 7"),l(h,"class","group-chevron svelte-d1addp"),l(h,"fill","none"),l(h,"stroke","currentColor"),l(h,"viewBox","0 0 24 24"),Ke(h,"expanded",o[17].has("cognitive-modes")),l(m,"class","dropdown-group-header svelte-d1addp"),l(t,"class","dropdown-menu svelte-d1addp")},m(J,H){B(J,t,H),d(t,s),d(t,r),O.m(t,null),d(t,n),d(t,i),d(t,c),d(t,m),d(m,h),d(h,g),d(m,D),d(m,f),d(t,p),T&&T.m(t,null),d(t,R),G&&G.m(t,null),d(t,N),A&&A.m(t,null),z||(I=[ae(m,"click",Qe(o[41])),ae(t,"click",Qe(o[37]))],z=!0)},p(J,H){S===(S=k(J))&&O?O.p(J,H):(O.d(1),O=S(J),O&&(O.c(),O.m(t,n))),H[0]&131072&&Ke(h,"expanded",J[17].has("cognitive-modes")),H[0]&131072&&(y=J[17].has("cognitive-modes")),y?T?T.p(J,H):(T=Ds(J),T.c(),T.m(t,R)):T&&(T.d(1),T=null),J[20].agentWorkflows.length>0?G?G.p(J,H):(G=Ns(J),G.c(),G.m(t,N)):G&&(G.d(1),G=null),J[20].legacyWorkflows.length>0?A?A.p(J,H):(A=Ms(J),A.c(),A.m(t,null)):A&&(A.d(1),A=null)},d(J){J&&u(t),O.d(),T&&T.d(),G&&G.d(),A&&A.d(),z=!1,it(I)}}}function yo(o){let t,s=Ge(o[3]),e=[];for(let r=0;r<s.length;r+=1)e[r]=Es(bs(o,s,r));return{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=We()},l(r){for(let n=0;n<e.length;n+=1)e[n].l(r);t=We()},m(r,n){for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(r,n);B(r,t,n)},p(r,n){if(n[0]&67108872|n[1]&2){s=Ge(r[3]);let i;for(i=0;i<s.length;i+=1){const c=bs(r,s,i);e[i]?e[i].p(c,n):(e[i]=Es(c),e[i].c(),e[i].m(t.parentNode,t))}for(;i<e.length;i+=1)e[i].d(1);e.length=s.length}},d(r){r&&u(t),rt(e,r)}}}function vo(o){let t,s="No saved graphs yet";return{c(){t=x("div"),t.textContent=s,this.h()},l(e){t=w(e,"DIV",{class:!0,"data-svelte-h":!0}),de(t)!=="svelte-13lts55"&&(t.textContent=s),this.h()},h(){l(t,"class","dropdown-item disabled svelte-d1addp")},m(e,r){B(e,t,r)},p:He,d(e){e&&u(t)}}}function _o(o){let t,s;return{c(){t=x("div"),s=re(o[5]),this.h()},l(e){t=w(e,"DIV",{class:!0});var r=M(t);s=oe(r,o[5]),r.forEach(u),this.h()},h(){l(t,"class","dropdown-item error svelte-d1addp")},m(e,r){B(e,t,r),d(t,s)},p(e,r){r[0]&32&&me(s,e[5])},d(e){e&&u(t)}}}function bo(o){let t,s="Loading...";return{c(){t=x("div"),t.textContent=s,this.h()},l(e){t=w(e,"DIV",{class:!0,"data-svelte-h":!0}),de(t)!=="svelte-1nt61as"&&(t.textContent=s),this.h()},h(){l(t,"class","dropdown-item disabled svelte-d1addp")},m(e,r){B(e,t,r)},p:He,d(e){e&&u(t)}}}function ws(o){let t,s=o[72].cognitiveMode+"",e;return{c(){t=re("· Mode: "),e=re(s)},l(r){t=oe(r,"· Mode: "),e=oe(r,s)},m(r,n){B(r,t,n),B(r,e,n)},p(r,n){n[0]&8&&s!==(s=r[72].cognitiveMode+"")&&me(e,s)},d(r){r&&(u(t),u(e))}}}function xs(o){let t,s="✕",e,r;function n(){return o[40](o[72])}return{c(){t=x("button"),t.textContent=s,this.h()},l(i){t=w(i,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),de(t)!=="svelte-1x87lj9"&&(t.textContent=s),this.h()},h(){l(t,"class","delete-button svelte-d1addp"),l(t,"title","Delete graph")},m(i,c){B(i,t,c),e||(r=ae(t,"click",Qe(n)),e=!0)},p(i,c){o=i},d(i){i&&u(t),e=!1,r()}}}function Es(o){let t,s,e,r=o[72].title+"",n,i,c,m=(o[72].description||"Custom graph")+"",h,g,D,f,v,p,y=o[72].cognitiveMode&&ws(o);function R(){return o[39](o[72])}let N=o[72].scope==="custom"&&xs(o);return{c(){t=x("div"),s=x("button"),e=x("div"),n=re(r),i=F(),c=x("div"),h=re(m),g=F(),y&&y.c(),D=F(),N&&N.c(),f=F(),this.h()},l(z){t=w(z,"DIV",{class:!0});var I=M(t);s=w(I,"BUTTON",{class:!0});var k=M(s);e=w(k,"DIV",{class:!0});var S=M(e);n=oe(S,r),S.forEach(u),i=V(k),c=w(k,"DIV",{class:!0});var O=M(c);h=oe(O,m),g=V(O),y&&y.l(O),O.forEach(u),k.forEach(u),D=V(I),N&&N.l(I),f=V(I),I.forEach(u),this.h()},h(){l(e,"class","template-name svelte-d1addp"),l(c,"class","template-description svelte-d1addp"),l(s,"class","dropdown-item-button svelte-d1addp"),l(t,"class","dropdown-item saved-graph svelte-d1addp")},m(z,I){B(z,t,I),d(t,s),d(s,e),d(e,n),d(s,i),d(s,c),d(c,h),d(c,g),y&&y.m(c,null),d(t,D),N&&N.m(t,null),d(t,f),v||(p=ae(s,"click",R),v=!0)},p(z,I){o=z,I[0]&8&&r!==(r=o[72].title+"")&&me(n,r),I[0]&8&&m!==(m=(o[72].description||"Custom graph")+"")&&me(h,m),o[72].cognitiveMode?y?y.p(o,I):(y=ws(o),y.c(),y.m(c,null)):y&&(y.d(1),y=null),o[72].scope==="custom"?N?N.p(o,I):(N=xs(o),N.c(),N.m(t,f)):N&&(N.d(1),N=null)},d(z){z&&u(t),y&&y.d(),N&&N.d(),v=!1,p()}}}function Ds(o){let t,s=Ge(o[20].cognitiveModes),e=[];for(let r=0;r<s.length;r+=1)e[r]=Ts(_s(o,s,r));return{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=We()},l(r){for(let n=0;n<e.length;n+=1)e[n].l(r);t=We()},m(r,n){for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(r,n);B(r,t,n)},p(r,n){if(n[0]&9437184){s=Ge(r[20].cognitiveModes);let i;for(i=0;i<s.length;i+=1){const c=_s(r,s,i);e[i]?e[i].p(c,n):(e[i]=Ts(c),e[i].c(),e[i].m(t.parentNode,t))}for(;i<e.length;i+=1)e[i].d(1);e.length=s.length}},d(r){r&&u(t),rt(e,r)}}}function Ts(o){let t,s,e,r=o[65].name+"",n,i,c,m=o[65].description+"",h,g,D,f;function v(){return o[42](o[65])}return{c(){t=x("button"),s=x("div"),e=x("div"),n=re(r),i=F(),c=x("div"),h=re(m),g=F(),this.h()},l(p){t=w(p,"BUTTON",{class:!0});var y=M(t);s=w(y,"DIV",{});var R=M(s);e=w(R,"DIV",{class:!0});var N=M(e);n=oe(N,r),N.forEach(u),i=V(R),c=w(R,"DIV",{class:!0});var z=M(c);h=oe(z,m),z.forEach(u),R.forEach(u),g=V(y),y.forEach(u),this.h()},h(){l(e,"class","template-name svelte-d1addp"),l(c,"class","template-description svelte-d1addp"),l(t,"class","dropdown-item nested svelte-d1addp")},m(p,y){B(p,t,y),d(t,s),d(s,e),d(e,n),d(s,i),d(s,c),d(c,h),d(t,g),D||(f=ae(t,"click",v),D=!0)},p(p,y){o=p,y[0]&1048576&&r!==(r=o[65].name+"")&&me(n,r),y[0]&1048576&&m!==(m=o[65].description+"")&&me(h,m)},d(p){p&&u(t),D=!1,f()}}}function Ns(o){let t,s,e,r,n,i="Agent Workflows",c,m=o[17].has("agent-workflows"),h,g,D,f=m&&Is(o);return{c(){t=x("button"),s=Te("svg"),e=Te("path"),r=F(),n=x("span"),n.textContent=i,c=F(),f&&f.c(),h=We(),this.h()},l(v){t=w(v,"BUTTON",{class:!0});var p=M(t);s=De(p,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var y=M(s);e=De(y,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),M(e).forEach(u),y.forEach(u),r=V(p),n=w(p,"SPAN",{"data-svelte-h":!0}),de(n)!=="svelte-1sx8s7r"&&(n.textContent=i),p.forEach(u),c=V(v),f&&f.l(v),h=We(),this.h()},h(){l(e,"stroke-linecap","round"),l(e,"stroke-linejoin","round"),l(e,"stroke-width","2"),l(e,"d","M9 5l7 7-7 7"),l(s,"class","group-chevron svelte-d1addp"),l(s,"fill","none"),l(s,"stroke","currentColor"),l(s,"viewBox","0 0 24 24"),Ke(s,"expanded",o[17].has("agent-workflows")),l(t,"class","dropdown-group-header svelte-d1addp")},m(v,p){B(v,t,p),d(t,s),d(s,e),d(t,r),d(t,n),B(v,c,p),f&&f.m(v,p),B(v,h,p),g||(D=ae(t,"click",Qe(o[43])),g=!0)},p(v,p){p[0]&131072&&Ke(s,"expanded",v[17].has("agent-workflows")),p[0]&131072&&(m=v[17].has("agent-workflows")),m?f?f.p(v,p):(f=Is(v),f.c(),f.m(h.parentNode,h)):f&&(f.d(1),f=null)},d(v){v&&(u(t),u(c),u(h)),f&&f.d(v),g=!1,D()}}}function Is(o){let t,s=Ge(o[20].agentWorkflows),e=[];for(let r=0;r<s.length;r+=1)e[r]=Ss(vs(o,s,r));return{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=We()},l(r){for(let n=0;n<e.length;n+=1)e[n].l(r);t=We()},m(r,n){for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(r,n);B(r,t,n)},p(r,n){if(n[0]&9437184){s=Ge(r[20].agentWorkflows);let i;for(i=0;i<s.length;i+=1){const c=vs(r,s,i);e[i]?e[i].p(c,n):(e[i]=Ss(c),e[i].c(),e[i].m(t.parentNode,t))}for(;i<e.length;i+=1)e[i].d(1);e.length=s.length}},d(r){r&&u(t),rt(e,r)}}}function Ss(o){let t,s,e,r=o[65].name+"",n,i,c,m=o[65].description+"",h,g,D,f;function v(){return o[44](o[65])}return{c(){t=x("button"),s=x("div"),e=x("div"),n=re(r),i=F(),c=x("div"),h=re(m),g=F(),this.h()},l(p){t=w(p,"BUTTON",{class:!0});var y=M(t);s=w(y,"DIV",{});var R=M(s);e=w(R,"DIV",{class:!0});var N=M(e);n=oe(N,r),N.forEach(u),i=V(R),c=w(R,"DIV",{class:!0});var z=M(c);h=oe(z,m),z.forEach(u),R.forEach(u),g=V(y),y.forEach(u),this.h()},h(){l(e,"class","template-name svelte-d1addp"),l(c,"class","template-description svelte-d1addp"),l(t,"class","dropdown-item nested svelte-d1addp")},m(p,y){B(p,t,y),d(t,s),d(s,e),d(e,n),d(s,i),d(s,c),d(c,h),d(t,g),D||(f=ae(t,"click",v),D=!0)},p(p,y){o=p,y[0]&1048576&&r!==(r=o[65].name+"")&&me(n,r),y[0]&1048576&&m!==(m=o[65].description+"")&&me(h,m)},d(p){p&&u(t),D=!1,f()}}}function Ms(o){let t,s,e,r,n,i="Legacy Workflows",c,m=o[17].has("legacy-workflows"),h,g,D,f=m&&Cs(o);return{c(){t=x("button"),s=Te("svg"),e=Te("path"),r=F(),n=x("span"),n.textContent=i,c=F(),f&&f.c(),h=We(),this.h()},l(v){t=w(v,"BUTTON",{class:!0});var p=M(t);s=De(p,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var y=M(s);e=De(y,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),M(e).forEach(u),y.forEach(u),r=V(p),n=w(p,"SPAN",{"data-svelte-h":!0}),de(n)!=="svelte-1i8wgpb"&&(n.textContent=i),p.forEach(u),c=V(v),f&&f.l(v),h=We(),this.h()},h(){l(e,"stroke-linecap","round"),l(e,"stroke-linejoin","round"),l(e,"stroke-width","2"),l(e,"d","M9 5l7 7-7 7"),l(s,"class","group-chevron svelte-d1addp"),l(s,"fill","none"),l(s,"stroke","currentColor"),l(s,"viewBox","0 0 24 24"),Ke(s,"expanded",o[17].has("legacy-workflows")),l(t,"class","dropdown-group-header svelte-d1addp")},m(v,p){B(v,t,p),d(t,s),d(s,e),d(t,r),d(t,n),B(v,c,p),f&&f.m(v,p),B(v,h,p),g||(D=ae(t,"click",Qe(o[45])),g=!0)},p(v,p){p[0]&131072&&Ke(s,"expanded",v[17].has("legacy-workflows")),p[0]&131072&&(m=v[17].has("legacy-workflows")),m?f?f.p(v,p):(f=Cs(v),f.c(),f.m(h.parentNode,h)):f&&(f.d(1),f=null)},d(v){v&&(u(t),u(c),u(h)),f&&f.d(v),g=!1,D()}}}function Cs(o){let t,s=Ge(o[20].legacyWorkflows),e=[];for(let r=0;r<s.length;r+=1)e[r]=Os(ys(o,s,r));return{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=We()},l(r){for(let n=0;n<e.length;n+=1)e[n].l(r);t=We()},m(r,n){for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(r,n);B(r,t,n)},p(r,n){if(n[0]&9437184){s=Ge(r[20].legacyWorkflows);let i;for(i=0;i<s.length;i+=1){const c=ys(r,s,i);e[i]?e[i].p(c,n):(e[i]=Os(c),e[i].c(),e[i].m(t.parentNode,t))}for(;i<e.length;i+=1)e[i].d(1);e.length=s.length}},d(r){r&&u(t),rt(e,r)}}}function Os(o){let t,s,e,r=o[65].name+"",n,i,c,m=o[65].description+"",h,g,D,f;function v(){return o[46](o[65])}return{c(){t=x("button"),s=x("div"),e=x("div"),n=re(r),i=F(),c=x("div"),h=re(m),g=F(),this.h()},l(p){t=w(p,"BUTTON",{class:!0});var y=M(t);s=w(y,"DIV",{});var R=M(s);e=w(R,"DIV",{class:!0});var N=M(e);n=oe(N,r),N.forEach(u),i=V(R),c=w(R,"DIV",{class:!0});var z=M(c);h=oe(z,m),z.forEach(u),R.forEach(u),g=V(y),y.forEach(u),this.h()},h(){l(e,"class","template-name svelte-d1addp"),l(c,"class","template-description svelte-d1addp"),l(t,"class","dropdown-item nested svelte-d1addp")},m(p,y){B(p,t,y),d(t,s),d(s,e),d(e,n),d(s,i),d(s,c),d(c,h),d(t,g),D||(f=ae(t,"click",v),D=!0)},p(p,y){o=p,y[0]&1048576&&r!==(r=o[65].name+"")&&me(n,r),y[0]&1048576&&m!==(m=o[65].description+"")&&me(h,m)},d(p){p&&u(t),D=!1,f()}}}function ko(o){let t,s,e;return{c(){t=Te("svg"),s=Te("path"),e=Te("path"),this.h()},l(r){t=De(r,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var n=M(t);s=De(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),M(s).forEach(u),e=De(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),M(e).forEach(u),n.forEach(u),this.h()},h(){l(s,"stroke-linecap","round"),l(s,"stroke-linejoin","round"),l(s,"stroke-width","2"),l(s,"d","M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"),l(e,"stroke-linecap","round"),l(e,"stroke-linejoin","round"),l(e,"stroke-width","2"),l(e,"d","M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),l(t,"class","w-5 h-5"),l(t,"fill","none"),l(t,"stroke","currentColor"),l(t,"viewBox","0 0 24 24")},m(r,n){B(r,t,n),d(t,s),d(t,e)},d(r){r&&u(t)}}}function wo(o){let t,s,e;return{c(){t=Te("svg"),s=Te("circle"),e=Te("path"),this.h()},l(r){t=De(r,"svg",{class:!0,fill:!0,viewBox:!0});var n=M(t);s=De(n,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),M(s).forEach(u),e=De(n,"path",{class:!0,fill:!0,d:!0}),M(e).forEach(u),n.forEach(u),this.h()},h(){l(s,"class","opacity-25"),l(s,"cx","12"),l(s,"cy","12"),l(s,"r","10"),l(s,"stroke","currentColor"),l(s,"stroke-width","4"),l(e,"class","opacity-75"),l(e,"fill","currentColor"),l(e,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),l(t,"class","w-5 h-5 animate-spin svelte-d1addp"),l(t,"fill","none"),l(t,"viewBox","0 0 24 24")},m(r,n){B(r,t,n),d(t,s),d(t,e)},d(r){r&&u(t)}}}function Ls(o){let t,s,e,r,n,i,c,m,h,g='<svg class="w-4 h-4 svelte-d1addp" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',D,f;return{c(){t=x("div"),s=Te("svg"),e=Te("path"),r=F(),n=x("span"),i=re("Execution failed: "),c=re(o[10]),m=F(),h=x("button"),h.innerHTML=g,this.h()},l(v){t=w(v,"DIV",{class:!0});var p=M(t);s=De(p,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var y=M(s);e=De(y,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),M(e).forEach(u),y.forEach(u),r=V(p),n=w(p,"SPAN",{class:!0});var R=M(n);i=oe(R,"Execution failed: "),c=oe(R,o[10]),R.forEach(u),m=V(p),h=w(p,"BUTTON",{class:!0,"data-svelte-h":!0}),de(h)!=="svelte-1ioc5dh"&&(h.innerHTML=g),p.forEach(u),this.h()},h(){l(e,"stroke-linecap","round"),l(e,"stroke-linejoin","round"),l(e,"stroke-width","2"),l(e,"d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),l(s,"class","w-5 h-5 svelte-d1addp"),l(s,"fill","none"),l(s,"stroke","currentColor"),l(s,"viewBox","0 0 24 24"),l(n,"class","svelte-d1addp"),l(h,"class","close-error svelte-d1addp"),l(t,"class","execution-error-banner svelte-d1addp")},m(v,p){B(v,t,p),d(t,s),d(s,e),d(t,r),d(t,n),d(n,i),d(n,c),d(t,m),d(t,h),D||(f=ae(h,"click",o[49]),D=!0)},p(v,p){p[0]&1024&&me(c,v[10])},d(v){v&&u(t),D=!1,f()}}}function js(o){let t,s='<div class="execution-status svelte-d1addp"><svg class="w-8 h-8 animate-spin svelte-d1addp" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <div class="execution-text svelte-d1addp"><div class="execution-title svelte-d1addp">Executing Graph...</div> <div class="execution-subtitle svelte-d1addp">Watch nodes highlight as they process</div></div></div>';return{c(){t=x("div"),t.innerHTML=s,this.h()},l(e){t=w(e,"DIV",{class:!0,"data-svelte-h":!0}),de(t)!=="svelte-b7fhsc"&&(t.innerHTML=s),this.h()},h(){l(t,"class","execution-overlay svelte-d1addp")},m(e,r){B(e,t,r)},d(e){e&&u(t)}}}function Rs(o){let t,s,e,r="Save Cognitive Graph",n,i,c,m,h,g,D,f="Cancel",v,p,y=o[19]?"Saved!":"Save",R,N,z,I=o[18]&&As(o),k=o[19]&&zs();return{c(){t=x("div"),s=x("div"),e=x("h3"),e.textContent=r,n=F(),i=x("input"),c=F(),I&&I.c(),m=F(),k&&k.c(),h=F(),g=x("div"),D=x("button"),D.textContent=f,v=F(),p=x("button"),R=re(y),this.h()},l(S){t=w(S,"DIV",{class:!0});var O=M(t);s=w(O,"DIV",{class:!0});var T=M(s);e=w(T,"H3",{class:!0,"data-svelte-h":!0}),de(e)!=="svelte-i405m1"&&(e.textContent=r),n=V(T),i=w(T,"INPUT",{type:!0,placeholder:!0,class:!0}),c=V(T),I&&I.l(T),m=V(T),k&&k.l(T),h=V(T),g=w(T,"DIV",{class:!0});var G=M(g);D=w(G,"BUTTON",{class:!0,"data-svelte-h":!0}),de(D)!=="svelte-1i56ufe"&&(D.textContent=f),v=V(G),p=w(G,"BUTTON",{class:!0});var A=M(p);R=oe(A,y),A.forEach(u),G.forEach(u),T.forEach(u),O.forEach(u),this.h()},h(){l(e,"class","svelte-d1addp"),l(i,"type","text"),l(i,"placeholder","Enter graph name"),l(i,"class","graph-name-input svelte-d1addp"),l(D,"class","cancel-button svelte-d1addp"),l(p,"class","save-button svelte-d1addp"),p.disabled=o[19],l(g,"class","modal-actions svelte-d1addp"),l(s,"class","modal svelte-d1addp"),l(t,"class","modal-overlay svelte-d1addp")},m(S,O){B(S,t,O),d(t,s),d(s,e),d(s,n),d(s,i),ct(i,o[8]),d(s,c),I&&I.m(s,null),d(s,m),k&&k.m(s,null),d(s,h),d(s,g),d(g,D),d(g,v),d(g,p),d(p,R),N||(z=[ae(i,"input",o[51]),ae(i,"keydown",o[52]),ae(D,"click",o[53]),ae(p,"click",o[29]),ae(s,"click",Qe(o[36])),ae(t,"click",o[54])],N=!0)},p(S,O){O[0]&256&&i.value!==S[8]&&ct(i,S[8]),S[18]?I?I.p(S,O):(I=As(S),I.c(),I.m(s,m)):I&&(I.d(1),I=null),S[19]?k||(k=zs(),k.c(),k.m(s,h)):k&&(k.d(1),k=null),O[0]&524288&&y!==(y=S[19]?"Saved!":"Save")&&me(R,y),O[0]&524288&&(p.disabled=S[19])},d(S){S&&u(t),I&&I.d(),k&&k.d(),N=!1,it(z)}}}function As(o){let t,s,e,r,n;return{c(){t=x("div"),s=Te("svg"),e=Te("path"),r=F(),n=re(o[18]),this.h()},l(i){t=w(i,"DIV",{class:!0});var c=M(t);s=De(c,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var m=M(s);e=De(m,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),M(e).forEach(u),m.forEach(u),r=V(c),n=oe(c,o[18]),c.forEach(u),this.h()},h(){l(e,"stroke-linecap","round"),l(e,"stroke-linejoin","round"),l(e,"stroke-width","2"),l(e,"d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),l(s,"class","w-4 h-4"),l(s,"fill","none"),l(s,"stroke","currentColor"),l(s,"viewBox","0 0 24 24"),l(t,"class","save-error svelte-d1addp")},m(i,c){B(i,t,c),d(t,s),d(s,e),d(t,r),d(t,n)},p(i,c){c[0]&262144&&me(n,i[18])},d(i){i&&u(t)}}}function zs(o){let t,s=`<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
            Graph saved successfully!`;return{c(){t=x("div"),t.innerHTML=s,this.h()},l(e){t=w(e,"DIV",{class:!0,"data-svelte-h":!0}),de(t)!=="svelte-1d2a0mu"&&(t.innerHTML=s),this.h()},h(){l(t,"class","save-success svelte-d1addp")},m(e,r){B(e,t,r)},d(e){e&&u(t)}}}function Gs(o){let t,s,e,r,n="Keyboard Shortcuts",i,c,m='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',h,g,D='<div class="shortcut-section svelte-d1addp"><h4 class="svelte-d1addp">Graph Operations</h4> <div class="shortcut-item svelte-d1addp"><kbd class="svelte-d1addp">Ctrl</kbd> + <kbd class="svelte-d1addp">S</kbd> <span class="svelte-d1addp">Save graph</span></div> <div class="shortcut-item svelte-d1addp"><kbd class="svelte-d1addp">Ctrl</kbd> + <kbd class="svelte-d1addp">E</kbd> <span class="svelte-d1addp">Execute graph</span></div></div> <div class="shortcut-section svelte-d1addp"><h4 class="svelte-d1addp">Editing</h4> <div class="shortcut-item svelte-d1addp"><kbd class="svelte-d1addp">Ctrl</kbd> + <kbd class="svelte-d1addp">Z</kbd> <span class="svelte-d1addp">Undo</span></div> <div class="shortcut-item svelte-d1addp"><kbd class="svelte-d1addp">Ctrl</kbd> + <kbd class="svelte-d1addp">Y</kbd> <span class="svelte-d1addp">Redo</span></div> <div class="shortcut-item svelte-d1addp"><kbd class="svelte-d1addp">Delete</kbd> <span class="svelte-d1addp">Delete selected nodes</span></div></div> <div class="shortcut-section svelte-d1addp"><h4 class="svelte-d1addp">Selection</h4> <div class="shortcut-item svelte-d1addp"><kbd class="svelte-d1addp">Ctrl</kbd> + <kbd class="svelte-d1addp">A</kbd> <span class="svelte-d1addp">Select all</span></div> <div class="shortcut-item svelte-d1addp"><kbd class="svelte-d1addp">Esc</kbd> <span class="svelte-d1addp">Deselect all</span></div></div> <div class="shortcut-section svelte-d1addp"><h4 class="svelte-d1addp">Navigation</h4> <div class="shortcut-item svelte-d1addp"><kbd class="svelte-d1addp">Space</kbd> + <span class="text-small svelte-d1addp">drag</span> <span class="svelte-d1addp">Pan canvas</span></div> <div class="shortcut-item svelte-d1addp"><kbd class="svelte-d1addp">Scroll</kbd> <span class="svelte-d1addp">Zoom in/out</span></div> <div class="shortcut-item svelte-d1addp"><kbd class="svelte-d1addp">Right-click</kbd> <span class="svelte-d1addp">Add node menu</span></div></div> <div class="shortcut-section svelte-d1addp"><h4 class="svelte-d1addp">Help</h4> <div class="shortcut-item svelte-d1addp"><kbd class="svelte-d1addp">?</kbd> <span class="svelte-d1addp">Toggle this help</span></div></div>',f,v,p='<p class="help-hint svelte-d1addp"><svg class="w-4 h-4 svelte-d1addp" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>Right-click on canvas to see all available nodes</span></p>',y,R;return{c(){t=x("div"),s=x("div"),e=x("div"),r=x("h3"),r.textContent=n,i=F(),c=x("button"),c.innerHTML=m,h=F(),g=x("div"),g.innerHTML=D,f=F(),v=x("div"),v.innerHTML=p,this.h()},l(N){t=w(N,"DIV",{class:!0});var z=M(t);s=w(z,"DIV",{class:!0});var I=M(s);e=w(I,"DIV",{class:!0});var k=M(e);r=w(k,"H3",{class:!0,"data-svelte-h":!0}),de(r)!=="svelte-lq29mm"&&(r.textContent=n),i=V(k),c=w(k,"BUTTON",{class:!0,"data-svelte-h":!0}),de(c)!=="svelte-dyba62"&&(c.innerHTML=m),k.forEach(u),h=V(I),g=w(I,"DIV",{class:!0,"data-svelte-h":!0}),de(g)!=="svelte-1hqzlac"&&(g.innerHTML=D),f=V(I),v=w(I,"DIV",{class:!0,"data-svelte-h":!0}),de(v)!=="svelte-wpfoym"&&(v.innerHTML=p),I.forEach(u),z.forEach(u),this.h()},h(){l(r,"class","svelte-d1addp"),l(c,"class","close-help svelte-d1addp"),l(e,"class","help-header svelte-d1addp"),l(g,"class","shortcuts-grid svelte-d1addp"),l(v,"class","help-footer svelte-d1addp"),l(s,"class","modal help-modal svelte-d1addp"),l(t,"class","modal-overlay svelte-d1addp")},m(N,z){B(N,t,z),d(t,s),d(s,e),d(e,r),d(e,i),d(e,c),d(s,h),d(s,g),d(s,f),d(s,v),y||(R=[ae(c,"click",o[55]),ae(s,"click",Qe(o[35])),ae(t,"click",o[56])],y=!0)},p:He,d(N){N&&u(t),y=!1,it(R)}}}function Ps(o){let t,s,e,r,n="Recent Graph Traces",i,c,m,h,g,D='<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',f,v,p;function y(S,O){return S[14]?Eo:xo}let R=y(o),N=R(o);function z(S,O){return S[15]?Io:S[14]?No:S[13].length===0?To:Do}let I=z(o),k=I(o);return{c(){t=x("div"),s=x("div"),e=x("div"),r=x("h3"),r.textContent=n,i=F(),c=x("div"),m=x("button"),N.c(),h=F(),g=x("button"),g.innerHTML=D,f=F(),k.c(),this.h()},l(S){t=w(S,"DIV",{class:!0});var O=M(t);s=w(O,"DIV",{class:!0});var T=M(s);e=w(T,"DIV",{class:!0});var G=M(e);r=w(G,"H3",{class:!0,"data-svelte-h":!0}),de(r)!=="svelte-8yi40f"&&(r.textContent=n),i=V(G),c=w(G,"DIV",{class:!0});var A=M(c);m=w(A,"BUTTON",{class:!0});var J=M(m);N.l(J),J.forEach(u),h=V(A),g=w(A,"BUTTON",{class:!0,"data-svelte-h":!0}),de(g)!=="svelte-1ohfrk0"&&(g.innerHTML=D),A.forEach(u),G.forEach(u),f=V(T),k.l(T),T.forEach(u),O.forEach(u),this.h()},h(){l(r,"class","svelte-d1addp"),l(m,"class","action-button svelte-d1addp"),m.disabled=o[14],l(g,"class","close-help svelte-d1addp"),l(c,"class","telemetry-actions svelte-d1addp"),l(e,"class","telemetry-header svelte-d1addp"),l(s,"class","modal telemetry-modal svelte-d1addp"),l(t,"class","modal-overlay svelte-d1addp")},m(S,O){B(S,t,O),d(t,s),d(s,e),d(e,r),d(e,i),d(e,c),d(c,m),N.m(m,null),d(c,h),d(c,g),d(s,f),k.m(s,null),v||(p=[ae(m,"click",o[24]),ae(g,"click",o[57]),ae(s,"click",Qe(o[34])),ae(t,"click",o[58])],v=!0)},p(S,O){R!==(R=y(S))&&(N.d(1),N=R(S),N&&(N.c(),N.m(m,null))),O[0]&16384&&(m.disabled=S[14]),I===(I=z(S))&&k?k.p(S,O):(k.d(1),k=I(S),k&&(k.c(),k.m(s,null)))},d(S){S&&u(t),N.d(),k.d(),v=!1,it(p)}}}function xo(o){let t;return{c(){t=re("Refresh")},l(s){t=oe(s,"Refresh")},m(s,e){B(s,t,e)},d(s){s&&u(t)}}}function Eo(o){let t;return{c(){t=re("Loading…")},l(s){t=oe(s,"Loading…")},m(s,e){B(s,t,e)},d(s){s&&u(t)}}}function Do(o){let t,s=Ge(o[13]),e=[];for(let r=0;r<s.length;r+=1)e[r]=Hs(fs(o,s,r));return{c(){t=x("div");for(let r=0;r<e.length;r+=1)e[r].c();this.h()},l(r){t=w(r,"DIV",{class:!0});var n=M(t);for(let i=0;i<e.length;i+=1)e[i].l(n);n.forEach(u),this.h()},h(){l(t,"class","trace-list svelte-d1addp")},m(r,n){B(r,t,n);for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(t,null)},p(r,n){if(n[0]&8192){s=Ge(r[13]);let i;for(i=0;i<s.length;i+=1){const c=fs(r,s,i);e[i]?e[i].p(c,n):(e[i]=Hs(c),e[i].c(),e[i].m(t,null))}for(;i<e.length;i+=1)e[i].d(1);e.length=s.length}},d(r){r&&u(t),rt(e,r)}}}function To(o){let t,s="No trace entries yet. Run a graph and check back.";return{c(){t=x("div"),t.textContent=s,this.h()},l(e){t=w(e,"DIV",{class:!0,"data-svelte-h":!0}),de(t)!=="svelte-mscwey"&&(t.textContent=s),this.h()},h(){l(t,"class","trace-empty svelte-d1addp")},m(e,r){B(e,t,r)},p:He,d(e){e&&u(t)}}}function No(o){let t,s="Loading trace data…";return{c(){t=x("div"),t.textContent=s,this.h()},l(e){t=w(e,"DIV",{class:!0,"data-svelte-h":!0}),de(t)!=="svelte-epy7an"&&(t.textContent=s),this.h()},h(){l(t,"class","trace-empty svelte-d1addp")},m(e,r){B(e,t,r)},p:He,d(e){e&&u(t)}}}function Io(o){let t,s;return{c(){t=x("div"),s=re(o[15]),this.h()},l(e){t=w(e,"DIV",{class:!0});var r=M(t);s=oe(r,o[15]),r.forEach(u),this.h()},h(){l(t,"class","trace-error svelte-d1addp")},m(e,r){B(e,t,r),d(t,s)},p(e,r){r[0]&32768&&me(s,e[15])},d(e){e&&u(t)}}}function Vs(o){let t,s,e=o[62].durationMs+"",r,n,i=(o[62].eventCount||0)+"",c,m;return{c(){t=x("div"),s=re("Duration: "),r=re(e),n=re("ms ("),c=re(i),m=re(" events)")},l(h){t=w(h,"DIV",{});var g=M(t);s=oe(g,"Duration: "),r=oe(g,e),n=oe(g,"ms ("),c=oe(g,i),m=oe(g," events)"),g.forEach(u)},m(h,g){B(h,t,g),d(t,s),d(t,r),d(t,n),d(t,c),d(t,m)},p(h,g){g[0]&8192&&e!==(e=h[62].durationMs+"")&&me(r,e),g[0]&8192&&i!==(i=(h[62].eventCount||0)+"")&&me(c,i)},d(h){h&&u(t)}}}function Fs(o){let t,s,e=o[62].error+"",r;return{c(){t=x("div"),s=re("Error: "),r=re(e),this.h()},l(n){t=w(n,"DIV",{class:!0});var i=M(t);s=oe(i,"Error: "),r=oe(i,e),i.forEach(u),this.h()},h(){l(t,"class","trace-error-text svelte-d1addp")},m(n,i){B(n,t,i),d(t,s),d(t,r)},p(n,i){i[0]&8192&&e!==(e=n[62].error+"")&&me(r,e)},d(n){n&&u(t)}}}function Hs(o){let t,s,e,r=new Date(o[62].timestamp).toLocaleString()+"",n,i,c,m=(o[62].status??"unknown")+"",h,g,D,f,v,p,y,R=(o[62].mode||"n/a")+"",N,z,I,k,S,O=(o[62].graph||"custom")+"",T,G,A,J,H=o[62].durationMs&&Vs(o),Q=o[62].error&&Fs(o);return{c(){t=x("div"),s=x("div"),e=x("span"),n=re(r),i=F(),c=x("span"),h=re(m),D=F(),f=x("div"),v=x("div"),p=re("Mode: "),y=x("strong"),N=re(R),z=F(),I=x("div"),k=re("Graph: "),S=x("code"),T=re(O),G=F(),H&&H.c(),A=F(),Q&&Q.c(),J=F(),this.h()},l(X){t=w(X,"DIV",{class:!0});var ge=M(t);s=w(ge,"DIV",{class:!0});var Oe=M(s);e=w(Oe,"SPAN",{class:!0});var Ie=M(e);n=oe(Ie,r),Ie.forEach(u),i=V(Oe),c=w(Oe,"SPAN",{class:!0});var j=M(c);h=oe(j,m),j.forEach(u),Oe.forEach(u),D=V(ge),f=w(ge,"DIV",{class:!0});var W=M(f);v=w(W,"DIV",{});var U=M(v);p=oe(U,"Mode: "),y=w(U,"STRONG",{});var ee=M(y);N=oe(ee,R),ee.forEach(u),U.forEach(u),z=V(W),I=w(W,"DIV",{});var $=M(I);k=oe($,"Graph: "),S=w($,"CODE",{});var he=M(S);T=oe(he,O),he.forEach(u),$.forEach(u),G=V(W),H&&H.l(W),A=V(W),Q&&Q.l(W),W.forEach(u),J=V(ge),ge.forEach(u),this.h()},h(){l(e,"class","trace-timestamp svelte-d1addp"),l(c,"class",g=is(`trace-status ${o[62].status??"unknown"}`)+" svelte-d1addp"),l(s,"class","trace-line svelte-d1addp"),l(f,"class","trace-details svelte-d1addp"),l(t,"class","trace-entry svelte-d1addp")},m(X,ge){B(X,t,ge),d(t,s),d(s,e),d(e,n),d(s,i),d(s,c),d(c,h),d(t,D),d(t,f),d(f,v),d(v,p),d(v,y),d(y,N),d(f,z),d(f,I),d(I,k),d(I,S),d(S,T),d(f,G),H&&H.m(f,null),d(f,A),Q&&Q.m(f,null),d(t,J)},p(X,ge){ge[0]&8192&&r!==(r=new Date(X[62].timestamp).toLocaleString()+"")&&me(n,r),ge[0]&8192&&m!==(m=(X[62].status??"unknown")+"")&&me(h,m),ge[0]&8192&&g!==(g=is(`trace-status ${X[62].status??"unknown"}`)+" svelte-d1addp")&&l(c,"class",g),ge[0]&8192&&R!==(R=(X[62].mode||"n/a")+"")&&me(N,R),ge[0]&8192&&O!==(O=(X[62].graph||"custom")+"")&&me(T,O),X[62].durationMs?H?H.p(X,ge):(H=Vs(X),H.c(),H.m(f,A)):H&&(H.d(1),H=null),X[62].error?Q?Q.p(X,ge):(Q=Fs(X),Q.c(),Q.m(f,null)):Q&&(Q.d(1),Q=null)},d(X){X&&u(t),H&&H.d(),Q&&Q.d()}}}function So(o){let t,s,e,r,n='<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg> <span>Exit Node Editor</span>',i,c,m,h,g,D,f,v,p,y,R=`<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
        New`,N,z,I,k=`<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg>
          Load Graph`,S,O,T,G,A=o[9]?"Executing...":"Execute",J,H,Q,X,ge=`<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path></svg>
        Save`,Oe,Ie,j='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12h4l3 8 4-16 3 8h4"></path></svg>',W,U,ee='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>',$,he,se,_e,ie,le,ce,ve,Le,Ce,Se,be,ze,Ue,ye=o[7]&&ks(o);function Ye(Y,ne){return Y[9]?wo:ko}let qe=Ye(o),je=qe(o),ke=o[10]&&Ls(o);_e=new fo({props:{onNodeSelected:o[31]}});let et={cognitiveMode:o[0]};ce=new po({props:et}),o[50](ce);let Ne=o[9]&&js(),we=o[6]&&Rs(o),xe=o[11]&&Gs(o),Ee=o[12]&&Ps(o);return{c(){t=x("div"),s=x("header"),e=x("div"),r=x("button"),r.innerHTML=n,i=F(),c=x("div"),m=Te("svg"),h=Te("path"),g=F(),D=x("span"),f=re(o[1]),v=F(),p=x("div"),y=x("button"),y.innerHTML=R,N=F(),z=x("div"),I=x("button"),I.innerHTML=k,S=F(),ye&&ye.c(),O=F(),T=x("button"),je.c(),G=F(),J=re(A),Q=F(),X=x("button"),X.innerHTML=ge,Oe=F(),Ie=x("button"),Ie.innerHTML=j,W=F(),U=x("button"),U.innerHTML=ee,$=F(),ke&&ke.c(),he=F(),se=x("div"),as(_e.$$.fragment),ie=F(),le=x("div"),as(ce.$$.fragment),ve=F(),Ne&&Ne.c(),Le=F(),we&&we.c(),Ce=F(),xe&&xe.c(),Se=F(),Ee&&Ee.c(),this.h()},l(Y){t=w(Y,"DIV",{class:!0});var ne=M(t);s=w(ne,"HEADER",{class:!0});var Pe=M(s);e=w(Pe,"DIV",{class:!0});var Je=M(e);r=w(Je,"BUTTON",{class:!0,"aria-label":!0,title:!0,"data-svelte-h":!0}),de(r)!=="svelte-9y3idl"&&(r.innerHTML=n),i=V(Je),c=w(Je,"DIV",{class:!0});var _=M(c);m=De(_,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var te=M(m);h=De(te,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),M(h).forEach(u),te.forEach(u),g=V(_),D=w(_,"SPAN",{});var pe=M(D);f=oe(pe,o[1]),pe.forEach(u),_.forEach(u),Je.forEach(u),v=V(Pe),p=w(Pe,"DIV",{class:!0});var fe=M(p);y=w(fe,"BUTTON",{class:!0,"data-svelte-h":!0}),de(y)!=="svelte-19fn6vx"&&(y.innerHTML=R),N=V(fe),z=w(fe,"DIV",{class:!0,style:!0});var Fe=M(z);I=w(Fe,"BUTTON",{class:!0,"data-svelte-h":!0}),de(I)!=="svelte-1p982ew"&&(I.innerHTML=k),S=V(Fe),ye&&ye.l(Fe),Fe.forEach(u),O=V(fe),T=w(fe,"BUTTON",{class:!0,title:!0});var Re=M(T);je.l(Re),G=V(Re),J=oe(Re,A),Re.forEach(u),Q=V(fe),X=w(fe,"BUTTON",{class:!0,"data-svelte-h":!0}),de(X)!=="svelte-11b8zcg"&&(X.innerHTML=ge),Oe=V(fe),Ie=w(fe,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),de(Ie)!=="svelte-1dijbdg"&&(Ie.innerHTML=j),W=V(fe),U=w(fe,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),de(U)!=="svelte-bkdz5e"&&(U.innerHTML=ee),fe.forEach(u),Pe.forEach(u),$=V(ne),ke&&ke.l(ne),he=V(ne),se=w(ne,"DIV",{class:!0});var Xe=M(se);rs(_e.$$.fragment,Xe),ie=V(Xe),le=w(Xe,"DIV",{class:!0});var Ze=M(le);rs(ce.$$.fragment,Ze),ve=V(Ze),Ne&&Ne.l(Ze),Ze.forEach(u),Xe.forEach(u),Le=V(ne),we&&we.l(ne),Ce=V(ne),xe&&xe.l(ne),Se=V(ne),Ee&&Ee.l(ne),ne.forEach(u),this.h()},h(){l(r,"class","exit-button svelte-d1addp"),l(r,"aria-label","Exit node editor"),l(r,"title","Back to traditional view"),l(h,"stroke-linecap","round"),l(h,"stroke-linejoin","round"),l(h,"stroke-width","2"),l(h,"d","M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"),l(m,"class","w-5 h-5"),l(m,"fill","none"),l(m,"stroke","currentColor"),l(m,"viewBox","0 0 24 24"),l(c,"class","graph-name svelte-d1addp"),l(e,"class","header-left svelte-d1addp"),l(y,"class","action-button svelte-d1addp"),l(I,"class","action-button svelte-d1addp"),l(z,"class","dropdown"),ot(z,"position","relative"),l(T,"class","action-button execute svelte-d1addp"),T.disabled=o[9],l(T,"title",H=o[9]?"Executing...":"Execute graph"),l(X,"class","action-button primary svelte-d1addp"),l(Ie,"class","action-button svelte-d1addp"),l(Ie,"title","Graph telemetry"),l(U,"class","action-button svelte-d1addp"),l(U,"title","Keyboard shortcuts (?)"),l(p,"class","header-actions svelte-d1addp"),l(s,"class","node-editor-header svelte-d1addp"),l(le,"class","editor-area svelte-d1addp"),l(se,"class","main-content svelte-d1addp"),l(t,"class","node-editor-layout svelte-d1addp")},m(Y,ne){B(Y,t,ne),d(t,s),d(s,e),d(e,r),d(e,i),d(e,c),d(c,m),d(m,h),d(c,g),d(c,D),d(D,f),d(s,v),d(s,p),d(p,y),d(p,N),d(p,z),d(z,I),d(z,S),ye&&ye.m(z,null),o[47](z),d(p,O),d(p,T),je.m(T,null),d(T,G),d(T,J),d(p,Q),d(p,X),d(p,Oe),d(p,Ie),d(p,W),d(p,U),d(t,$),ke&&ke.m(t,null),d(t,he),d(t,se),os(_e,se,null),d(se,ie),d(se,le),os(ce,le,null),d(le,ve),Ne&&Ne.m(le,null),d(t,Le),we&&we.m(t,null),d(t,Ce),xe&&xe.m(t,null),d(t,Se),Ee&&Ee.m(t,null),be=!0,ze||(Ue=[ae(r,"click",o[30]),ae(y,"click",o[27]),ae(I,"click",Qe(o[38])),ae(T,"click",o[22]),ae(X,"click",o[28]),ae(Ie,"click",o[25]),ae(U,"click",o[48])],ze=!0)},p(Y,ne){(!be||ne[0]&2)&&me(f,Y[1]),Y[7]?ye?ye.p(Y,ne):(ye=ks(Y),ye.c(),ye.m(z,null)):ye&&(ye.d(1),ye=null),qe!==(qe=Ye(Y))&&(je.d(1),je=qe(Y),je&&(je.c(),je.m(T,G))),(!be||ne[0]&512)&&A!==(A=Y[9]?"Executing...":"Execute")&&me(J,A),(!be||ne[0]&512)&&(T.disabled=Y[9]),(!be||ne[0]&512&&H!==(H=Y[9]?"Executing...":"Execute graph"))&&l(T,"title",H),Y[10]?ke?ke.p(Y,ne):(ke=Ls(Y),ke.c(),ke.m(t,he)):ke&&(ke.d(1),ke=null);const Pe={};ne[0]&1&&(Pe.cognitiveMode=Y[0]),ce.$set(Pe),Y[9]?Ne||(Ne=js(),Ne.c(),Ne.m(le,null)):Ne&&(Ne.d(1),Ne=null),Y[6]?we?we.p(Y,ne):(we=Rs(Y),we.c(),we.m(t,Ce)):we&&(we.d(1),we=null),Y[11]?xe?xe.p(Y,ne):(xe=Gs(Y),xe.c(),xe.m(t,Se)):xe&&(xe.d(1),xe=null),Y[12]?Ee?Ee.p(Y,ne):(Ee=Ps(Y),Ee.c(),Ee.m(t,null)):Ee&&(Ee.d(1),Ee=null)},i(Y){be||(ss(_e.$$.fragment,Y),ss(ce.$$.fragment,Y),be=!0)},o(Y){ts(_e.$$.fragment,Y),ts(ce.$$.fragment,Y),be=!1},d(Y){Y&&u(t),ye&&ye.d(),o[47](null),je.d(),ke&&ke.d(),es(_e),o[50](null),es(ce),Ne&&Ne.d(),we&&we.d(),xe&&xe.d(),Ee&&Ee.d(),ze=!1,it(Ue)}}}function Mo(o,t,s){let e,{cognitiveMode:r=null}=t,n,i="Untitled Graph",c=[],m=[],h=!1,g="",D=!1,f=!1,v="",p=!1,y="",R=!1,N=!1,z=[],I=!1,k="",S,O=new Set(["cognitive-modes","agent-workflows"]);function T(_){O.has(_)?O.delete(_):O.add(_),s(17,O)}Ws(async()=>(s(33,c=await Bs()),Q(),window.addEventListener("keydown",A),window.addEventListener("click",G),()=>{window.removeEventListener("keydown",A),window.removeEventListener("click",G)})),Us(()=>{window.removeEventListener("keydown",A),window.removeEventListener("click",G)});function G(_){f&&S&&!S.contains(_.target)&&s(7,f=!1)}function A(_){if(!(_.target instanceof HTMLInputElement||_.target instanceof HTMLTextAreaElement)){if((_.ctrlKey||_.metaKey)&&_.key==="s"){_.preventDefault(),j();return}if((_.ctrlKey||_.metaKey)&&!_.shiftKey&&_.key==="z"){_.preventDefault(),n?.graph&&(n.graph.undo?.(),console.log("[NodeEditor] Undo"));return}if((_.ctrlKey||_.metaKey)&&(_.key==="y"||_.shiftKey&&_.key==="z")){_.preventDefault(),n?.graph&&(n.graph.redo?.(),console.log("[NodeEditor] Redo"));return}if(_.key==="Delete"||_.key==="Backspace"){if(_.preventDefault(),n?.graph){const te=n.graph.getSelectedNodes();te&&te.length>0&&(te.forEach(pe=>{n.graph.remove(pe)}),console.log(`[NodeEditor] Deleted ${te.length} node(s)`))}return}if((_.ctrlKey||_.metaKey)&&_.key==="a"){_.preventDefault(),n?.graph&&(n.graph.selectNodes(),console.log("[NodeEditor] Selected all nodes"));return}if(_.key==="Escape"){_.preventDefault(),n?.graph&&(n.graph.deselectAllNodes?.()||n.graph.clearSelection?.(),console.log("[NodeEditor] Deselected all nodes"));return}if((_.ctrlKey||_.metaKey)&&_.key==="e"){_.preventDefault(),p||J();return}if(_.key==="?"){_.preventDefault(),s(11,R=!R);return}}}async function J(){if(!(!n||!n.graph)){s(9,p=!0),s(10,y="");try{const _=n.graph.serialize();console.log("[NodeEditorLayout] Sending graph to backend for REAL execution...",{nodes:_.nodes?.length||0,links:_.links?.length||0});const te=await Be("/api/execute-graph",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({graph:_,sessionId:`editor-${Date.now()}`,userMessage:"Test message from node editor"})});if(!te.ok){const fe=await te.json();throw new Error(fe.error||`Server error: ${te.status}`)}const pe=await te.json();console.log("[NodeEditorLayout] ✅ REAL execution completed!",{durationMs:pe.durationMs,executedNodes:pe.result?.executedNodes?.length||0})}catch(_){console.error("[NodeEditorLayout] Execution error:",_),s(10,y=_.message||"Execution failed"),setTimeout(()=>{s(10,y="")},3e3)}finally{s(9,p=!1)}}}async function H(_){try{console.log(`[NodeEditor] Loading template: ${_}`);const te=await $s(_);if(!te){console.error(`[NodeEditor] Failed to load template data for ${_}`);return}if(!n){console.error("[NodeEditor] Node editor ref not ready yet");return}console.log("[NodeEditor] Loading graph into editor..."),n.loadGraph(te);const pe=c.find(fe=>fe.id===_);s(1,i=pe?.name||_),console.log(`[NodeEditor] Graph loaded successfully: ${i}`),s(7,f=!1)}catch(te){console.error("[NodeEditor] Failed to load template:",te)}}async function Q(){s(4,h=!0),s(5,g="");try{const _=await Be("/api/cognitive-graphs");if(!_.ok)throw new Error(`Server responded with ${_.status}`);const te=await _.json();s(3,m=Array.isArray(te.graphs)?te.graphs.filter(pe=>pe.scope==="custom"):[])}catch(_){console.error("[NodeEditor] Failed to fetch graphs:",_),s(5,g=_?.message||"Failed to load graphs")}finally{s(4,h=!1)}}async function X(){s(14,I=!0),s(15,k="");try{const _=await Be("/api/graph-traces?limit=25");if(!_.ok)throw new Error(`Server responded with ${_.status}`);const te=await _.json();s(13,z=Array.isArray(te.traces)?te.traces:[])}catch(_){console.error("[NodeEditor] Failed to load traces:",_),s(15,k=_?.message||"Failed to load graph traces")}finally{s(14,I=!1)}}async function ge(){s(12,N=!0),await X()}async function Oe(_){try{const te=await Be(`/api/cognitive-graph?name=${encodeURIComponent(_)}`);if(te.ok){const pe=await te.json();n&&(n.loadGraph(pe.graph),s(1,i=pe.graph?.name||_),s(7,f=!1))}}catch(te){console.error("Failed to load graph:",te)}}function Ie(){n&&(n.clearGraph(),s(1,i="Untitled Graph"))}function j(){s(8,v=i),s(6,D=!0)}let W="",U=!1;async function ee(){if(!(!n||!v.trim())){s(18,W=""),s(19,U=!1);try{const _=n.exportGraph(),te={..._,name:v,description:`Custom cognitive graph: ${v}`,version:"1.0",created:_.created||new Date().toISOString(),last_modified:new Date().toISOString()},pe=await Be("/api/cognitive-graph",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:v,graph:te})});if(!pe.ok){const Fe=await pe.json();throw new Error(Fe.error||"Failed to save graph")}const fe=await pe.json();console.log("[NodeEditor] Graph saved:",fe),s(1,i=v),s(19,U=!0),Q(),setTimeout(()=>{s(6,D=!1),s(19,U=!1)},1e3)}catch(_){console.error("Failed to save graph:",_),s(18,W=_.message||"Failed to save graph")}}}function $(){Xs.set(!1)}function he(_){if(console.log("[NodeEditorLayout] handleNodeSelected called with:",_),console.log("[NodeEditorLayout] nodeEditorRef exists:",!!n),!n){console.warn("[NodeEditorLayout] Node editor not initialized");return}console.log("[NodeEditorLayout] Calling nodeEditorRef.addNode"),n.addNode(_)}async function se(_){if(!(!_||!confirm(`Delete graph "${_}"? This cannot be undone.`)))try{const pe=await Be(`/api/cognitive-graph?name=${encodeURIComponent(_)}`,{method:"DELETE"});if(!pe.ok){const fe=await pe.json().catch(()=>({}));throw new Error(fe.error||"Failed to delete graph")}console.log("[NodeEditor] Graph deleted:",_),i===_&&s(1,i="Untitled Graph"),Q()}catch(pe){console.error("Failed to delete graph:",pe),alert(pe.message||"Failed to delete graph")}}function _e(_){lt.call(this,o,_)}function ie(_){lt.call(this,o,_)}function le(_){lt.call(this,o,_)}function ce(_){lt.call(this,o,_)}const ve=()=>s(7,f=!f),Le=_=>Oe(_.name),Ce=_=>se(_.name),Se=()=>T("cognitive-modes"),be=_=>H(_.id),ze=()=>T("agent-workflows"),Ue=_=>H(_.id),ye=()=>T("legacy-workflows"),Ye=_=>H(_.id);function qe(_){Qt[_?"unshift":"push"](()=>{S=_,s(16,S)})}const je=()=>s(11,R=!0),ke=()=>s(10,y="");function et(_){Qt[_?"unshift":"push"](()=>{n=_,s(2,n)})}function Ne(){v=this.value,s(8,v)}const we=_=>_.key==="Enter"&&ee(),xe=()=>s(6,D=!1),Ee=()=>s(6,D=!1),Y=()=>s(11,R=!1),ne=()=>s(11,R=!1),Pe=()=>s(12,N=!1),Je=()=>s(12,N=!1);return o.$$set=_=>{"cognitiveMode"in _&&s(0,r=_.cognitiveMode)},o.$$.update=()=>{if(o.$$.dirty[1]&4&&s(20,e=(()=>{const _=new Set(["dual-mode","agent-mode","emulation-mode"]),te=new Set(["dual-mode-v1.1-backup","dual-mode-v1.2-backup"]),pe=c.filter(Re=>_.has(Re.id)),fe=c.filter(Re=>te.has(Re.id)),Fe=c.filter(Re=>!_.has(Re.id)&&!te.has(Re.id));return{cognitiveModes:pe,agentWorkflows:Fe,legacyWorkflows:fe}})()),o.$$.dirty[0]&3|o.$$.dirty[1]&4)if(console.log("[NodeEditorLayout] Cognitive mode prop changed:",r),r){const _=c.find(te=>te.id===`${r}-mode`);s(1,i=_?.name||`${r.charAt(0).toUpperCase()+r.slice(1)} Mode`),console.log("[NodeEditorLayout] Updated graph name to:",i)}else console.log("[NodeEditorLayout] Cognitive mode is null/undefined, keeping default name")},[r,i,n,m,h,g,D,f,v,p,y,R,N,z,I,k,S,O,W,U,e,T,J,H,X,ge,Oe,Ie,j,ee,$,he,se,c,_e,ie,le,ce,ve,Le,Ce,Se,be,ze,Ue,ye,Ye,qe,je,ke,et,Ne,we,xe,Ee,Y,ne,Pe,Je]}class Ro extends Yt{constructor(t){super(),Xt(this,t,Mo,So,Zt,{cognitiveMode:0},null,[-1,-1,-1])}}export{Ro as default};
