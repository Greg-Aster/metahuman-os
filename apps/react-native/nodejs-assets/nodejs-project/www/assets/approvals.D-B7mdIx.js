import{d as t,w as l}from"./index.PToQ82vo.js";import{i}from"./security-policy.Bh98pxWs.js";import{D as c,l as o}from"./api-config.B-uR5Kyo.js";const p={items:[],loading:!1,error:null,lastLoaded:null},r=l(p),w=t(r,e=>e.items.length);t(r,e=>e.loading);t(r,e=>e.error);async function n(){if(!c(i)){r.set({items:[],loading:!1,error:null,lastLoaded:Date.now()});return}r.update(e=>({...e,loading:!0,error:null}));try{const e=await o("/api/approvals");if(!e.ok)throw new Error("Failed to load approval queue");const a=await e.json();r.set({items:a.approvals||[],loading:!1,error:null,lastLoaded:Date.now()})}catch(e){r.update(a=>({...a,loading:!1,error:e.message}))}}async function m(e){try{const a=await o("/api/approvals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,action:"approve"})});if(!a.ok)throw new Error("Failed to approve skill execution");const s=await a.json();return s.success?(await n(),{success:!0}):{success:!1,error:s.result?.error||"Approval failed"}}catch(a){return{success:!1,error:a.message}}}async function g(e){try{if(!(await o("/api/approvals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,action:"reject"})})).ok)throw new Error("Failed to reject skill execution");return await n(),{success:!0}}catch(a){return{success:!1,error:a.message}}}function v(){r.update(e=>({...e,error:null}))}export{m as a,r as b,v as c,n as l,w as p,g as r};
