import{S as Ae,i as Se,s as Ce,n as K,d as f,a as R,M as he,K as me,o as Ne,c as p,e as m,g as Q,j as v,p as L,b as i,x as ie,f as y,h as V,q as A,k as S,t as C,r as le,u as Ie,v as Me,P as ve}from"./api-config.B-uR5Kyo.js";import{i as _e}from"./security-policy.Bh98pxWs.js";import{l as te,a as Oe,c as be,r as Le,b as Re}from"./approvals.D-B7mdIx.js";import"./index.PToQ82vo.js";function ge(l,e,s){const t=l.slice();return t[12]=e[s],t}function ke(l,e,s){const t=l.slice();return t[15]=e[s][0],t[16]=e[s][1],t}function He(l){let e,s,t,r,a="Approval Queue",n,o,u,d=l[3].length+"",c,h,_,b,N="Refresh",g,D,q,J,k=l[1]&&ye(l);function B(x,w){return x[2]?Ue:x[3].length===0?Be:qe}let H=B(l),I=H(l);return{c(){e=v("div"),s=v("div"),t=v("div"),r=v("h2"),r.textContent=a,n=S(),o=v("span"),u=C("("),c=C(d),h=C(" pending)"),_=S(),b=v("button"),b.textContent=N,g=S(),k&&k.c(),D=S(),I.c(),this.h()},l(x){e=m(x,"DIV",{class:!0});var w=y(e);s=m(w,"DIV",{class:!0});var M=y(s);t=m(M,"DIV",{class:!0});var T=y(t);r=m(T,"H2",{class:!0,"data-svelte-h":!0}),Q(r)!=="svelte-18azjvy"&&(r.textContent=a),n=V(T),o=m(T,"SPAN",{class:!0});var O=y(o);u=A(O,"("),c=A(O,d),h=A(O," pending)"),O.forEach(f),T.forEach(f),_=V(M),b=m(M,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),Q(b)!=="svelte-ffbx7t"&&(b.textContent=N),M.forEach(f),g=V(w),k&&k.l(w),D=V(w),I.l(w),w.forEach(f),this.h()},h(){p(r,"class","text-xl font-semibold"),p(o,"class","text-sm muted svelte-1omuxmr"),p(t,"class","flex items-center gap-2"),p(b,"class","btn-secondary svelte-1omuxmr"),p(b,"title","Refresh approval queue"),p(s,"class","flex items-center justify-between"),p(e,"class","space-y-4")},m(x,w){R(x,e,w),i(e,s),i(s,t),i(t,r),i(t,n),i(t,o),i(o,u),i(o,c),i(o,h),i(s,_),i(s,b),i(e,g),k&&k.m(e,null),i(e,D),I.m(e,null),q||(J=ie(b,"click",te),q=!0)},p(x,w){w&8&&d!==(d=x[3].length+"")&&L(c,d),x[1]?k?k.p(x,w):(k=ye(x),k.c(),k.m(e,D)):k&&(k.d(1),k=null),H===(H=B(x))&&I?I.p(x,w):(I.d(1),I=H(x),I&&(I.c(),I.m(e,null)))},d(x){x&&f(e),k&&k.d(),I.d(),q=!1,J()}}}function Pe(l){let e,s='<h2 class="text-lg font-semibold">Approvals Restricted</h2> <p class="muted text-sm svelte-1omuxmr">Log in as the owner to review and approve skill executions.</p>';return{c(){e=v("div"),e.innerHTML=s,this.h()},l(t){e=m(t,"DIV",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-8jt69s"&&(e.innerHTML=s),this.h()},h(){p(e,"class","card p-6 text-center space-y-2 svelte-1omuxmr")},m(t,r){R(t,e,r)},p:K,d(t){t&&f(e)}}}function ye(l){let e,s;return{c(){e=v("div"),s=C(l[1]),this.h()},l(t){e=m(t,"DIV",{class:!0});var r=y(e);s=A(r,l[1]),r.forEach(f),this.h()},h(){p(e,"class","bg-red-100 border border-red-400 text-red-700 dark:bg-red-900 dark:border-red-700 dark:text-red-200 px-4 py-3 rounded")},m(t,r){R(t,e,r),i(e,s)},p(t,r){r&2&&L(s,t[1])},d(t){t&&f(e)}}}function qe(l){let e,s=le(l[3]),t=[];for(let r=0;r<s.length;r+=1)t[r]=we(ge(l,s,r));return{c(){e=v("div");for(let r=0;r<t.length;r+=1)t[r].c();this.h()},l(r){e=m(r,"DIV",{class:!0});var a=y(e);for(let n=0;n<t.length;n+=1)t[n].l(a);a.forEach(f),this.h()},h(){p(e,"class","space-y-3")},m(r,a){R(r,e,a);for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(e,null)},p(r,a){if(a&105){s=le(r[3]);let n;for(n=0;n<s.length;n+=1){const o=ge(r,s,n);t[n]?t[n].p(o,a):(t[n]=we(o),t[n].c(),t[n].m(e,null))}for(;n<t.length;n+=1)t[n].d(1);t.length=s.length}},d(r){r&&f(e),Ie(t,r)}}}function Be(l){let e,s='<p class="muted svelte-1omuxmr">No pending approvals</p> <p class="text-sm muted mt-2 svelte-1omuxmr">Skills requiring approval will appear here</p>';return{c(){e=v("div"),e.innerHTML=s,this.h()},l(t){e=m(t,"DIV",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-bsmk3y"&&(e.innerHTML=s),this.h()},h(){p(e,"class","text-center py-8")},m(t,r){R(t,e,r)},p:K,d(t){t&&f(e)}}}function Ue(l){let e,s='<div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div> <p class="mt-2 muted svelte-1omuxmr">Loading approvals...</p>';return{c(){e=v("div"),e.innerHTML=s,this.h()},l(t){e=m(t,"DIV",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-152y2kd"&&(e.innerHTML=s),this.h()},h(){p(e,"class","text-center py-8")},m(t,r){R(t,e,r)},p:K,d(t){t&&f(e)}}}function Ee(l){let e,s,t="Parameters:",r,a,n=le(Object.entries(l[12].inputs)),o=[];for(let u=0;u<n.length;u+=1)o[u]=xe(ke(l,n,u));return{c(){e=v("div"),s=v("p"),s.textContent=t,r=S(),a=v("div");for(let u=0;u<o.length;u+=1)o[u].c();this.h()},l(u){e=m(u,"DIV",{class:!0});var d=y(e);s=m(d,"P",{class:!0,"data-svelte-h":!0}),Q(s)!=="svelte-1umvqr2"&&(s.textContent=t),r=V(d),a=m(d,"DIV",{class:!0});var c=y(a);for(let h=0;h<o.length;h+=1)o[h].l(c);c.forEach(f),d.forEach(f),this.h()},h(){p(s,"class","text-xs font-medium muted mb-2 svelte-1omuxmr"),p(a,"class","space-y-1"),p(e,"class","bg-gray-50 dark:bg-gray-800 rounded p-3")},m(u,d){R(u,e,d),i(e,s),i(e,r),i(e,a);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(a,null)},p(u,d){if(d&8){n=le(Object.entries(u[12].inputs));let c;for(c=0;c<n.length;c+=1){const h=ke(u,n,c);o[c]?o[c].p(h,d):(o[c]=xe(h),o[c].c(),o[c].m(a,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=n.length}},d(u){u&&f(e),Ie(o,u)}}}function xe(l){let e,s,t=l[15]+"",r,a,n,o,u=(typeof l[16]=="object"?JSON.stringify(l[16],null,2):String(l[16]))+"",d,c;return{c(){e=v("div"),s=v("span"),r=C(t),a=C(":"),n=S(),o=v("span"),d=C(u),c=S(),this.h()},l(h){e=m(h,"DIV",{class:!0});var _=y(e);s=m(_,"SPAN",{class:!0});var b=y(s);r=A(b,t),a=A(b,":"),b.forEach(f),n=V(_),o=m(_,"SPAN",{class:!0});var N=y(o);d=A(N,u),N.forEach(f),c=V(_),_.forEach(f),this.h()},h(){p(s,"class","font-medium"),p(o,"class","ml-2 font-mono text-xs"),p(e,"class","text-sm")},m(h,_){R(h,e,_),i(e,s),i(s,r),i(s,a),i(e,n),i(e,o),i(o,d),i(e,c)},p(h,_){_&8&&t!==(t=h[15]+"")&&L(r,t),_&8&&u!==(u=(typeof h[16]=="object"?JSON.stringify(h[16],null,2):String(h[16]))+"")&&L(d,u)},d(h){h&&f(e)}}}function we(l){let e,s,t,r,a=l[12].skillName+"",n,o,u,d=l[12].skillDescription+"",c,h,_,b,N=l[12].risk+"",g,D,q,J,k,B=je(l[12].timestamp)+"",H,I,x=Object.keys(l[12].inputs).length>0,w,M,T,O=l[0]===l[12].id?"Approving...":"Approve & Execute",F,G,se,P,z=l[0]===l[12].id?"Rejecting...":"Reject",W,X,re,ne,oe,j=x&&Ee(l);function Te(){return l[10](l[12])}function Ve(){return l[11](l[12])}return{c(){e=v("div"),s=v("div"),t=v("div"),r=v("h3"),n=C(a),o=S(),u=v("p"),c=C(d),h=S(),_=v("div"),b=v("span"),g=C(N),D=C(" risk"),J=S(),k=v("span"),H=C(B),I=S(),j&&j.c(),w=S(),M=v("div"),T=v("button"),F=C(O),se=S(),P=v("button"),W=C(z),re=S(),this.h()},l(U){e=m(U,"DIV",{class:!0});var E=y(e);s=m(E,"DIV",{class:!0});var Y=y(s);t=m(Y,"DIV",{class:!0});var Z=y(t);r=m(Z,"H3",{class:!0});var ce=y(r);n=A(ce,a),ce.forEach(f),o=V(Z),u=m(Z,"P",{class:!0});var ue=y(u);c=A(ue,d),ue.forEach(f),Z.forEach(f),h=V(Y),_=m(Y,"DIV",{class:!0});var $=y(_);b=m($,"SPAN",{class:!0});var ae=y(b);g=A(ae,N),D=A(ae," risk"),ae.forEach(f),J=V($),k=m($,"SPAN",{class:!0});var de=y(k);H=A(de,B),de.forEach(f),$.forEach(f),Y.forEach(f),I=V(E),j&&j.l(E),w=V(E),M=m(E,"DIV",{class:!0});var ee=y(M);T=m(ee,"BUTTON",{class:!0});var fe=y(T);F=A(fe,O),fe.forEach(f),se=V(ee),P=m(ee,"BUTTON",{class:!0});var pe=y(P);W=A(pe,z),pe.forEach(f),ee.forEach(f),re=V(E),E.forEach(f),this.h()},h(){p(r,"class","font-semibold"),p(u,"class","text-sm muted svelte-1omuxmr"),p(t,"class","flex-1"),p(b,"class",q=ve(`px-2 py-1 rounded text-xs font-medium ${De(l[12].risk)}`)+" svelte-1omuxmr"),p(k,"class","text-xs muted svelte-1omuxmr"),p(_,"class","flex items-center gap-2"),p(s,"class","flex items-start justify-between"),T.disabled=G=l[0]===l[12].id,p(T,"class","btn-primary flex-1 svelte-1omuxmr"),P.disabled=X=l[0]===l[12].id,p(P,"class","btn-secondary flex-1 svelte-1omuxmr"),p(M,"class","flex items-center gap-2 pt-2 border-t dark:border-gray-700"),p(e,"class","card p-4 space-y-3 svelte-1omuxmr")},m(U,E){R(U,e,E),i(e,s),i(s,t),i(t,r),i(r,n),i(t,o),i(t,u),i(u,c),i(s,h),i(s,_),i(_,b),i(b,g),i(b,D),i(_,J),i(_,k),i(k,H),i(e,I),j&&j.m(e,null),i(e,w),i(e,M),i(M,T),i(T,F),i(M,se),i(M,P),i(P,W),i(e,re),ne||(oe=[ie(T,"click",Te),ie(P,"click",Ve)],ne=!0)},p(U,E){l=U,E&8&&a!==(a=l[12].skillName+"")&&L(n,a),E&8&&d!==(d=l[12].skillDescription+"")&&L(c,d),E&8&&N!==(N=l[12].risk+"")&&L(g,N),E&8&&q!==(q=ve(`px-2 py-1 rounded text-xs font-medium ${De(l[12].risk)}`)+" svelte-1omuxmr")&&p(b,"class",q),E&8&&B!==(B=je(l[12].timestamp)+"")&&L(H,B),E&8&&(x=Object.keys(l[12].inputs).length>0),x?j?j.p(l,E):(j=Ee(l),j.c(),j.m(e,w)):j&&(j.d(1),j=null),E&9&&O!==(O=l[0]===l[12].id?"Approving...":"Approve & Execute")&&L(F,O),E&9&&G!==(G=l[0]===l[12].id)&&(T.disabled=G),E&9&&z!==(z=l[0]===l[12].id?"Rejecting...":"Reject")&&L(W,z),E&9&&X!==(X=l[0]===l[12].id)&&(P.disabled=X)},d(U){U&&f(e),j&&j.d(),ne=!1,Me(oe)}}}function Je(l){let e;function s(a,n){return a[4]?He:Pe}let t=s(l),r=t(l);return{c(){r.c(),e=he()},l(a){r.l(a),e=he()},m(a,n){r.m(a,n),R(a,e,n)},p(a,[n]){t===(t=s(a))&&r?r.p(a,n):(r.d(1),r=t(a),r&&(r.c(),r.m(e.parentNode,e)))},i:K,o:K,d(a){a&&f(e),r.d(a)}}}function De(l){switch(l){case"low":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"high":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}}function je(l){const e=new Date(l),t=new Date().getTime()-e.getTime(),r=Math.floor(t/6e4);if(r<1)return"just now";if(r<60)return`${r}m ago`;const a=Math.floor(r/60);return a<24?`${a}h ago`:`${Math.floor(a/24)}d ago`}function Qe(l,e,s){let t,r,a,n,o,u;me(l,Re,g=>s(9,o=g)),me(l,_e,g=>s(4,u=g));let d=null,c="";async function h(g){s(0,d=g);const D=await Oe(g);D.success||(s(7,c=D.error||"Approval failed"),setTimeout(()=>{s(7,c=""),be()},5e3)),s(0,d=null)}async function _(g){s(0,d=g);const D=await Le(g);D.success||(s(7,c=D.error||"Rejection failed"),setTimeout(()=>{s(7,c=""),be()},5e3)),s(0,d=null)}Ne(()=>{te();const g=_e.subscribe(()=>te()),D=()=>{document.hidden||te()};return document.addEventListener("visibilitychange",D),()=>{g(),document.removeEventListener("visibilitychange",D)}});const b=g=>h(g.id),N=g=>_(g.id);return l.$$.update=()=>{l.$$.dirty&512&&s(3,t=o.items),l.$$.dirty&512&&s(2,r=o.loading),l.$$.dirty&512&&s(8,a=o.error),l.$$.dirty&384&&s(1,n=c||a||"")},[d,n,r,t,u,h,_,c,a,o,b,N]}class We extends Ae{constructor(e){super(),Se(this,e,Qe,Je,Ce,{})}}export{We as default};
