import{d as r,w as a}from"./index.enr_Xien.js";import{l}from"./api-config.BAZ_dc_Y.js";const t=a(null),s=a(!0),c=a(null);r(t,e=>e?!e.canWriteMemory:!0);r(t,e=>e?.canUseOperator??!1);const f=r(t,e=>e?.canWriteMemory??!1),u=r(t,e=>e?.role==="owner"),p=r(t,e=>e?.mode??"dual");async function n(){s.set(!0),c.set(null);try{const e=await l("/api/security/policy",{cache:"no-store"});if(!e.ok)throw new Error(`Failed to fetch policy (status ${e.status})`);const o=await e.json();if(o.success&&o.policy)t.set(o.policy);else throw new Error("Invalid policy response")}catch(e){console.error("[security-policy] Failed to fetch policy:",e),c.set(e.message),t.set({canWriteMemory:!1,canUseOperator:!1,canChangeMode:!1,canChangeTrust:!1,canAccessTraining:!1,canFactoryReset:!1,role:"anonymous",mode:"emulation"})}finally{s.set(!1)}}function d(e=3e4){n();const o=setInterval(()=>{n()},e);return()=>clearInterval(o)}export{f as a,p as c,n as f,u as i,d as s};
